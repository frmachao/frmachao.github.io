<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>ä½¿ç”¨ web components æŠ€æœ¯å°è£…æ‚¬æµ®æŒ‰é’®ç»„ä»¶</title>
    <link href="/posts/9010be96/"/>
    <url>/posts/9010be96/</url>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯-Web-Components"><a href="#ä»€ä¹ˆæ˜¯-Web-Components" class="headerlink" title="ä»€ä¹ˆæ˜¯ Web Components"></a>ä»€ä¹ˆæ˜¯ Web Components</h2><blockquote><p>Web Components æ˜¯ä¸€ç»„ Web å¹³å° APIï¼Œå…è®¸æ‚¨åˆ›å»ºæ–°çš„è‡ªå®šä¹‰ã€å¯é‡ç”¨ã€å°è£…çš„ HTML æ ‡ç­¾ä»¥åœ¨ç½‘é¡µå’Œ Web åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ã€‚è‡ªå®šä¹‰ç»„ä»¶å’Œå°éƒ¨ä»¶åŸºäºweb Components æ ‡å‡†æ„å»ºï¼Œå¯ä»¥è·¨ç°ä»£æµè§ˆå™¨å·¥ä½œï¼Œå¹¶ä¸”å¯ä»¥ä¸ä»»ä½•æ”¯æŒ HTML çš„ JavaScript åº“æˆ–æ¡†æ¶ä¸€èµ·ä½¿ç”¨ã€‚Web components åŸºäºç°æœ‰çš„ Web æ ‡å‡†ã€‚æ”¯æŒ Web components çš„ç‰¹æ€§ç›®å‰æ­£è¢«æ·»åŠ åˆ° HTML å’Œ DOM è§„èŒƒä¸­ã€‚</p></blockquote><blockquote><p><a href="https://www.webcomponents.org/introduction">https://www.webcomponents.org/introduction</a></p></blockquote><p>ä¹Ÿå°±æ˜¯è¯´å¦‚æœä½ æ‹¥æœ‰ä¸€ä¸ª Web Components ç»„ä»¶å¯ä»¥åœ¨ä»»ä½• web æ¡†æ¶ä¸­ä½¿ç”¨å®ƒï¼Œæ¯”å¦‚åœ¨ Reactã€Vueã€Angular ä¸­ã€‚</p><h2 id="ä½¿ç”¨åŸç”Ÿ-Web-Components-æŠ€æœ¯å°è£…ä¸€ä¸ªæ‚¬æµ®æŒ‰é’®ç»„ä»¶"><a href="#ä½¿ç”¨åŸç”Ÿ-Web-Components-æŠ€æœ¯å°è£…ä¸€ä¸ªæ‚¬æµ®æŒ‰é’®ç»„ä»¶" class="headerlink" title="ä½¿ç”¨åŸç”Ÿ Web Components æŠ€æœ¯å°è£…ä¸€ä¸ªæ‚¬æµ®æŒ‰é’®ç»„ä»¶"></a>ä½¿ç”¨åŸç”Ÿ Web Components æŠ€æœ¯å°è£…ä¸€ä¸ªæ‚¬æµ®æŒ‰é’®ç»„ä»¶</h2><p>æ‚¬æµ®æŒ‰é’®ç»„ä»¶çš„åŠŸèƒ½å¦‚ä¸‹ï¼š</p><ol><li>ç‚¹å‡»æ‚¬æµ®æŒ‰é’®æ—¶ï¼Œä¸Šé¢å‡ºç°ä¸€ä¸ªå¡ç‰‡ï¼Œå¡ç‰‡å‡ºç°æ—¶å¸¦æœ‰æ¸å…¥åŠ¨ç”»æ•ˆæœï¼›</li><li>ç‚¹å‡»æ‚¬æµ®æŒ‰é’®æ—¶ï¼ŒæŒ‰é’®ä¸Šå›¾æ ‡å‘ç”Ÿæ”¹å˜ï¼Œä» info å˜æˆ closeï¼›</li><li>ç‚¹å‡» close å›¾æ ‡ï¼Œä¸Šæ–¹çš„å¡ç‰‡æ¶ˆå¤±ï¼Œæ¶ˆå¤±æ—¶å¸¦æœ‰æ¸å‡ºçš„åŠ¨ç”»æ•ˆæœï¼›</li></ol><h3 id="é¦–å…ˆæˆ‘å…ˆä½¿ç”¨æœ€åŸå§‹çš„-Html-CSS-JavaScript-Dom-æ“ä½œæ¥å®ç°ï¼Œç„¶åå†ä½¿ç”¨-web-components-æŠ€æœ¯å°è£…æˆç»„ä»¶ã€‚"><a href="#é¦–å…ˆæˆ‘å…ˆä½¿ç”¨æœ€åŸå§‹çš„-Html-CSS-JavaScript-Dom-æ“ä½œæ¥å®ç°ï¼Œç„¶åå†ä½¿ç”¨-web-components-æŠ€æœ¯å°è£…æˆç»„ä»¶ã€‚" class="headerlink" title="é¦–å…ˆæˆ‘å…ˆä½¿ç”¨æœ€åŸå§‹çš„ Html+CSS+JavaScript Dom æ“ä½œæ¥å®ç°ï¼Œç„¶åå†ä½¿ç”¨ web components æŠ€æœ¯å°è£…æˆç»„ä»¶ã€‚"></a>é¦–å…ˆæˆ‘å…ˆä½¿ç”¨æœ€åŸå§‹çš„ Html+CSS+JavaScript Dom æ“ä½œæ¥å®ç°ï¼Œç„¶åå†ä½¿ç”¨ web components æŠ€æœ¯å°è£…æˆç»„ä»¶ã€‚</h3><p>æ ·å¼éƒ¨åˆ†</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs css">&lt;style&gt;<br>    <span class="hljs-selector-id">#floating-button</span> &#123;<br>        <span class="hljs-attribute">position</span>: fixed;<br>        <span class="hljs-attribute">bottom</span>: <span class="hljs-number">20px</span>;<br>        <span class="hljs-attribute">right</span>: <span class="hljs-number">20px</span>;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;<br>        <span class="hljs-attribute">height</span>: <span class="hljs-number">50px</span>;<br>        <span class="hljs-attribute">background-color</span>: silver;<br>        <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;<br>        <span class="hljs-attribute">display</span>: flex;<br>        <span class="hljs-attribute">justify-content</span>: center;<br>        <span class="hljs-attribute">align-items</span>: center;<br>        <span class="hljs-attribute">color</span>: white;<br>        <span class="hljs-attribute">cursor</span>: pointer;<br>        <span class="hljs-attribute">transition</span>: background-color <span class="hljs-number">0.3s</span> ease-in-out;<br>        <span class="hljs-attribute">z-index</span>: <span class="hljs-number">999</span>;<br>    &#125;<br><br>    <span class="hljs-selector-id">#floating-card</span> &#123;<br>        <span class="hljs-attribute">position</span>: fixed;<br>        <span class="hljs-attribute">bottom</span>: <span class="hljs-number">80px</span>;<br>        <span class="hljs-attribute">right</span>: <span class="hljs-number">20px</span>;<br>        <span class="hljs-attribute">padding</span>: <span class="hljs-number">1rem</span>;<br>        <span class="hljs-attribute">background-color</span>: lightgray;<br>        <span class="hljs-attribute">text-align</span>: center;<br>        <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;<br>        <span class="hljs-comment">/* å°†å…ƒç´ åœ¨æ°´å¹³æ–¹å‘ä¸Šè¿›è¡Œä½ç§»ï¼ˆå¹³ç§»ï¼‰ï¼Œä½¿å…¶å‘å³ç§»è‡ªèº«å®½åº¦çš„ç™¾åˆ†ä¹‹ç™¾ã€‚ */</span><br>        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">110%</span>);<br>        <span class="hljs-attribute">transition</span>: opacity <span class="hljs-number">0.3s</span> ease-in-out, transform <span class="hljs-number">0.3s</span> ease-in-out;<br>    &#125;<br><br>    <span class="hljs-selector-id">#floating-card</span> <span class="hljs-selector-tag">img</span> &#123;<br>        <span class="hljs-attribute">width</span>: <span class="hljs-number">268px</span>;<br>        <span class="hljs-attribute">height</span>: <span class="hljs-number">255px</span>;<br>        <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-built_in">rgb</span>(<span class="hljs-number">181</span>, <span class="hljs-number">177</span>, <span class="hljs-number">187</span>);<br>    &#125;<br><br>    <span class="hljs-comment">/* é€‰æ‹©å…·æœ‰ id ä¸º &quot;floating-card&quot; å¹¶ä¸”å…·æœ‰ opened ç±»çš„å…ƒç´ ã€‚*/</span><br>    <span class="hljs-selector-id">#floating-card</span><span class="hljs-selector-class">.opened</span> &#123;<br>        <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;<br>        <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">translateX</span>(<span class="hljs-number">0</span>);<br>    &#125;<br><br>    <span class="hljs-selector-class">.hidden</span> &#123;<br>        <span class="hljs-attribute">display</span>: none;<br>    &#125;<br>&lt;/style&gt;<br></code></pre></td></tr></table></figure><p>html ç»“æ„éƒ¨åˆ†</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;floating-button&quot;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;toggleCard()&quot;</span>&gt;</span><br>    &lt;svg<br>      id=&quot;floating-icon-info&quot;<br>      xmlns=&quot;http://www.w3.org/2000/svg&quot;<br>      width=&quot;16&quot;<br>      height=&quot;16&quot;<br>      fill=&quot;currentColor&quot;<br>      class=&quot;bi bi-info-circle-fill&quot;<br>      viewBox=&quot;0 0 16 16&quot;<br>    &gt;<br>      &lt;path<br>        d=&quot;M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z&quot;<br>      /&gt;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br>    &lt;svg<br>      class=&quot;hidden&quot;<br>      id=&quot;floating-icon-close&quot;<br>      xmlns=&quot;http://www.w3.org/2000/svg&quot;<br>      width=&quot;16&quot;<br>      height=&quot;16&quot;<br>      fill=&quot;currentColor&quot;<br>      class=&quot;bi bi-x-circle-fill&quot;<br>      viewBox=&quot;0 0 16 16&quot;<br>    &gt;<br>      &lt;path<br>        d=&quot;M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z&quot;<br>      /&gt;<br>    <span class="hljs-tag">&lt;/<span class="hljs-name">svg</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;floating-card&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Card Title<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>    &lt;img<br>      src=&quot;https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2021-11-09-WmerG5.jpg&quot;<br>      alt=&quot;&quot;<br>    /&gt;<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure><p>javascript dom æ“ä½œéƒ¨åˆ†</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs javascript">&lt;script&gt;<br>    <span class="hljs-keyword">const</span> floatingButton = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&#x27;floating-button&#x27;</span>);<br>    <span class="hljs-keyword">const</span> floatingCard = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&#x27;floating-card&#x27;</span>);<br>    <span class="hljs-keyword">const</span> floatingInfo = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&#x27;floating-icon-info&#x27;</span>);<br>    <span class="hljs-keyword">const</span> floatingClose = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&#x27;floating-icon-close&#x27;</span>);<br><br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggleCard</span>(<span class="hljs-params"></span>) </span>&#123;<br>        floatingCard.classList.toggle(<span class="hljs-string">&#x27;opened&#x27;</span>);<br>        <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>            <span class="hljs-keyword">if</span> (floatingCard.classList.contains(<span class="hljs-string">&#x27;opened&#x27;</span>)) &#123;<br>                floatingInfo.classList.add(<span class="hljs-string">&#x27;hidden&#x27;</span>);<br>                floatingClose.classList.remove(<span class="hljs-string">&#x27;hidden&#x27;</span>);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                floatingClose.classList.add(<span class="hljs-string">&#x27;hidden&#x27;</span>);<br>                floatingInfo.classList.remove(<span class="hljs-string">&#x27;hidden&#x27;</span>);<br>            &#125;<br>        &#125;)<br>    &#125;<br><br>&lt;/script&gt;<br></code></pre></td></tr></table></figure><p>æ•ˆæœå±•ç¤ºï¼š<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2023-10-11-Dw4ohQ.gif"></p><h3 id="æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨-Web-Components-æŠ€æœ¯è¿›è¡Œå°è£…"><a href="#æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨-Web-Components-æŠ€æœ¯è¿›è¡Œå°è£…" class="headerlink" title="æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ Web Components æŠ€æœ¯è¿›è¡Œå°è£…:"></a>æ¥ä¸‹æ¥æˆ‘ä»¬ä½¿ç”¨ Web Components æŠ€æœ¯è¿›è¡Œå°è£…:</h3><p>é¦–å…ˆç¼–å†™ Web Components ç»„ä»¶ä¸­çš„ templateï¼Œæˆ‘ä»¬å°†ä¹‹å‰ç¼–å†™çš„ css å’Œ html å…¨éƒ¨æ”¾å…¥ template ä¸­<br><code>component-demo.html</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;floating-template&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><br>    #floating-button &#123;<br><span class="css">      <span class="hljs-attribute">position</span>: fixed;</span><br>    &#125;<br>    ....æ ·å¼éƒ¨åˆ†;<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;floating-button&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;floating-card&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    ....html éƒ¨åˆ†<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></td></tr></table></figure><p>ç„¶åç¼–å†™ javaScript éƒ¨åˆ†ï¼Œè·å–åˆ°æ¨¡æ¿å¹¶æ³¨å†Œè‡ªå®šä¹‰å…ƒç´ ï¼Œä½¿ç”¨ Shadow DOM å°†è‡ªå®šä¹‰å…ƒç´ çš„ HTML å’Œ CSS å°è£…åœ¨ç»„ä»¶å†…ã€‚</p><p>ä»€ä¹ˆæ˜¯ Shadow DOM?</p><blockquote><p>Web components çš„ä¸€ä¸ªé‡è¦å±æ€§æ˜¯å°è£…â€”â€”å¯ä»¥å°†æ ‡è®°ç»“æ„ã€æ ·å¼å’Œè¡Œä¸ºéšè—èµ·æ¥ï¼Œå¹¶ä¸é¡µé¢ä¸Šçš„å…¶ä»–ä»£ç ç›¸éš”ç¦»ï¼Œä¿è¯ä¸åŒçš„éƒ¨åˆ†ä¸ä¼šæ··åœ¨ä¸€èµ·ï¼Œå¯ä½¿ä»£ç æ›´åŠ å¹²å‡€ã€æ•´æ´ã€‚å…¶ä¸­ï¼ŒShadow DOM æ¥å£æ˜¯å…³é”®æ‰€åœ¨ï¼Œå®ƒå¯ä»¥å°†ä¸€ä¸ªéšè—çš„ã€ç‹¬ç«‹çš„ DOM é™„åŠ åˆ°ä¸€ä¸ªå…ƒç´ ä¸Šã€‚</p></blockquote><p><code>component.js</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FloatingButton</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">HTMLElement</span> </span>&#123;<br>  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-built_in">super</span>();<br>  &#125;<br><br>  <span class="hljs-comment">// ç”Ÿå‘½å‘¨æœŸå‡½æ•° dom é¦–æ¬¡æŒ‚è½½</span><br>  <span class="hljs-function"><span class="hljs-title">connectedCallback</span>(<span class="hljs-params"></span>)</span> &#123;<br>    <span class="hljs-keyword">const</span> shadowRoot = <span class="hljs-built_in">this</span>.attachShadow(&#123; <span class="hljs-attr">mode</span>: <span class="hljs-string">&quot;open&quot;</span> &#125;);<br>    <span class="hljs-comment">// è·å–åˆ°ç»„ä»¶æ¨¡æ¿</span><br>    <span class="hljs-keyword">const</span> template = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;floating-template&quot;</span>);<br>    <span class="hljs-keyword">const</span> instance = template.content.cloneNode(<span class="hljs-literal">true</span>);<br>    <span class="hljs-comment">// å†™å…¥ä¼ å…¥çš„å‚æ•°</span><br>    instance<br>      .querySelector(<span class="hljs-string">&quot;img&quot;</span>)<br>      .setAttribute(<span class="hljs-string">&quot;src&quot;</span>, <span class="hljs-built_in">this</span>.getAttribute(<span class="hljs-string">&quot;tip-code&quot;</span>));<br>    instance.querySelector(<span class="hljs-string">&quot;#floating-card h2&quot;</span>).innerText =<br>      <span class="hljs-built_in">this</span>.getAttribute(<span class="hljs-string">&quot;title&quot;</span>);<br>    <span class="hljs-comment">// å°†æ¨¡æ¿æ·»åŠ è¿› shadowRoot</span><br>    shadowRoot.appendChild(instance);<br><br>    <span class="hljs-comment">// æ‚¬æµ® button ä¸­çš„äº¤äº’é€»è¾‘</span><br>    <span class="hljs-keyword">const</span> floatingButton = shadowRoot.getElementById(<span class="hljs-string">&quot;floating-button&quot;</span>);<br>    <span class="hljs-keyword">const</span> floatingCard = shadowRoot.getElementById(<span class="hljs-string">&quot;floating-card&quot;</span>);<br>    <span class="hljs-keyword">const</span> floatingInfo = shadowRoot.getElementById(<span class="hljs-string">&quot;floating-icon-info&quot;</span>);<br>    <span class="hljs-keyword">const</span> floatingClose = shadowRoot.getElementById(<span class="hljs-string">&quot;floating-icon-close&quot;</span>);<br><br>    floatingButton.addEventListener(<span class="hljs-string">&quot;click&quot;</span>, toggleCard);<br>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">toggleCard</span>(<span class="hljs-params"></span>) </span>&#123;<br>      floatingCard.classList.toggle(<span class="hljs-string">&quot;opened&quot;</span>);<br>      <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">if</span> (floatingCard.classList.contains(<span class="hljs-string">&quot;opened&quot;</span>)) &#123;<br>          floatingInfo.classList.add(<span class="hljs-string">&quot;hidden&quot;</span>);<br>          floatingClose.classList.remove(<span class="hljs-string">&quot;hidden&quot;</span>);<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>          floatingClose.classList.add(<span class="hljs-string">&quot;hidden&quot;</span>);<br>          floatingInfo.classList.remove(<span class="hljs-string">&quot;hidden&quot;</span>);<br>        &#125;<br>      &#125;);<br>    &#125;<br>  &#125;<br>&#125;<br><span class="hljs-comment">// æ³¨å†Œè‡ªå®šä¹‰å…ƒç´ </span><br>customElements.define(<span class="hljs-string">&quot;floating-button&quot;</span>, FloatingButton);<br></code></pre></td></tr></table></figure><p>åœ¨ <code>component-demo.html</code> ä¸­å¼•å…¥ <code>component.js</code>,å¹¶ä½¿ç”¨ <floating-button> ç»„ä»¶</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>component-demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;floating-template&quot;</span>&gt;</span><br>      <span class="hljs-comment">&lt;!-- HTML+CSS ... --&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- å¼•å…¥ js æ–‡ä»¶ --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./component.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- ä½¿ç”¨ç»„ä»¶ --&gt;</span><br>    &lt;floating-button<br>      title=&quot;Custom Title&quot;<br>      tip-code=&quot;https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2021-11-09-WmerG5.jpg&quot;<br>    &gt;<span class="hljs-tag">&lt;/<span class="hljs-name">floating-button</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><p>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ <code>component-demo.html</code>ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å®šä¹‰çš„ floating-button å·²ç»è¢«æ­£ç¡®çš„æ¸²æŸ“å‡ºæ¥ï¼Œå®¡æŸ¥å…ƒç´ å¯ä»¥çœ‹åˆ°ç»„ä»¶æ˜¯ä¸€ä¸ª Shadow DOM ä¸­ã€‚<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2023-10-11-L74mI6.png"><br>å› ä¸º Shadow DOM æ˜¯ä¸€ä¸ªæ²™ç®±ç¯å¢ƒï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒç»„ä»¶ä¸­çš„ css å’Œ js ä¼šå½±å“åˆ°é¡µé¢ä¸Šå…¶ä»–ç»„ä»¶ï¼ŒåŒæ ·çš„ Shadow DOM å¤–çš„ä»£ç ä¹Ÿä¸ä¼šå¯¹ç»„ä»¶äº§ç”Ÿå½±å“ã€‚<br>æ¯”å¦‚ï¼Œæˆ‘åœ¨å…¨å±€ä¸­ç¼–å†™ä¸€æ®µ css æ¥æ”¹å˜ `floating-card`` çš„èƒŒæ™¯è‰²,æ˜¯ä¸ä¼šå¯¹ç»„ä»¶ç”Ÿæ•ˆçš„ã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-id">#floating-card</span> &#123;<br>  <span class="hljs-attribute">background-color</span>: skyblue;<br>&#125;<br></code></pre></td></tr></table></figure><p>è‡³æ­¤æˆ‘ä»¬çš„ <code>floating-button</code> å°±åˆæ­¥å°è£…å®Œæˆäº†ï¼Œä½†æ˜¯æˆ‘ä»¬å‘ç°å½“å‰çš„ç»„ä»¶æ— è®ºåœ¨ç¼–å†™è¿‡ç¨‹ä¸­è¿˜æ˜¯åœ¨ä½¿ç”¨ä¸Šéƒ½æœ‰è¯¸å¤šä¸ä¾¿ä¹‹å¤„ï¼Œæ¯”å¦‚æ˜¯å¦å¯ä»¥åƒ <code>react</code> ä¸­å°è£…ç»„ä»¶é‚£æ ·ï¼Œå°†ç»„ä»¶å•ç‹¬å°è£…åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä½¿ç”¨æ—¶åªè¦ import è¿™ä¸ªç»„ä»¶åˆ°ç›®æ ‡é¡µé¢ä¸­å³å¯ã€‚é‚£ä¹ˆå½“ç„¶æ˜¯æœ‰çš„ï¼Œç¤¾åŒºä¸­å·²ç»å‡ºç°äº†å¾ˆå¤šåŸºäº <code>web components</code> çš„æ¡†æ¶ï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿå°è£…ç»„ä»¶ï¼Œä¸‹é¢ç»™å¤§å®¶ä»‹ç»ä¸€ä¸ªåä¸º <a href="ofa.js">https://ofajs.com</a> çš„æ¡†æ¶ã€‚</p><h2 id="ä½¿ç”¨-ofa-js-å°è£…-web-components-ç»„ä»¶"><a href="#ä½¿ç”¨-ofa-js-å°è£…-web-components-ç»„ä»¶" class="headerlink" title="ä½¿ç”¨ ofa.js å°è£… web components ç»„ä»¶"></a>ä½¿ç”¨ ofa.js å°è£… web components ç»„ä»¶</h2><p>éœ€è¦å‡†å¤‡çš„æ–‡ä»¶å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># ç¼–å†™ç»„ä»¶éœ€è¦çš„æ–‡ä»¶</span><br>- ofa-component.html<br><span class="hljs-comment"># ä½¿ç”¨åˆ°ç»„ä»¶çš„é¡µé¢</span><br>- index.html<br></code></pre></td></tr></table></figure><h3 id="å®‰è£…å¹¶ä½¿ç”¨-ofa-js"><a href="#å®‰è£…å¹¶ä½¿ç”¨-ofa-js" class="headerlink" title="å®‰è£…å¹¶ä½¿ç”¨ ofa.js"></a>å®‰è£…å¹¶ä½¿ç”¨ ofa.js</h3><p>ä½¿ç”¨ ofa.js åªéœ€é€šè¿‡å¼•å…¥ CDN åœ°å€å°†é¡¹ç›® ofa.js å¼•å…¥åˆ° index.html ä¸­ï¼Œç„¶åä½¿ç”¨ <l-m> æ ‡ç­¾å¼•å…¥ç¼–å†™å¥½çš„ <code>ofa-component.html</code> æ–‡ä»¶å³å¯ä½¿ç”¨ ofa-component ç»„ä»¶ã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>ofa-demo<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;https://cdn.jsdelivr.net/gh/kirakiray/ofa.js@4.3.23/dist/ofa.js&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">l-m</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;./ofa-component.html&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">l-m</span>&gt;</span><br>    &lt;ofa-component<br>      title=&quot;Custom Title&quot;<br>      tip-code=&quot;https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2021-11-09-WmerG5.jpg&quot;<br>    &gt;<span class="hljs-tag">&lt;/<span class="hljs-name">ofa-component</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></table></figure><h3 id="ä½¿ç”¨-ofa-js-ç¼–å†™-web-components-ç»„ä»¶"><a href="#ä½¿ç”¨-ofa-js-ç¼–å†™-web-components-ç»„ä»¶" class="headerlink" title="ä½¿ç”¨ ofa.js ç¼–å†™ web components ç»„ä»¶"></a>ä½¿ç”¨ ofa.js ç¼–å†™ web components ç»„ä»¶</h3><p>ä¸‹é¢æˆ‘ä»¬é‡ç‚¹æ¥çœ‹ <code>ofa-component.html</code> æ˜¯å¦‚ä½•ç¼–å†™ web components ç»„ä»¶çš„ã€‚</p><p>åœ¨ç»„ä»¶æ–‡ä»¶ä¸­ï¼Œé¦–å…ˆæ·»åŠ ä¸€ä¸ª template å…ƒç´ ï¼Œå¹¶æ·»åŠ  component å±æ€§ã€‚å°†ç»„ä»¶éœ€è¦æ¸²æŸ“çš„å†…å®¹æ”¾ç½®åœ¨è¿™ä¸ª template å…ƒç´ å†…ã€‚æœ€ç»ˆï¼Œè¿™äº›å†…å®¹å°†è¢«æ¸²æŸ“åˆ°ç»„ä»¶çš„ Shadow DOM å†…ï¼ŒShadow DOM ä¸å¤–éƒ¨ç¯å¢ƒéš”ç¦»ï¼Œä»¥é˜²æ­¢æ±¡æŸ“å¤–éƒ¨ç¯å¢ƒã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">component</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><br>    #floating-button &#123;<br><span class="css">      <span class="hljs-attribute">position</span>: fixed;</span><br>    &#125;<br>    ....æ ·å¼éƒ¨åˆ†;<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;floating-button&gt;&lt;/div&gt;</span></span><br><span class="hljs-tag"><span class="hljs-string">    &lt;div id=&quot;</span><span class="hljs-attr">floating-card</span>&quot;&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    ....html éƒ¨åˆ†<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></td></tr></table></figure><p>æ¥ç€ï¼Œåœ¨æ¨¡æ¿å†…å®¹ä¸‹æ–¹ï¼Œæ·»åŠ ä¸€ä¸ª <code>&lt;script&gt;</code>æ ‡ç­¾ï¼Œå°†ç»„ä»¶çš„ JavaScript ä»£ç æ”¾å…¥å…¶ä¸­ã€‚</p><ul><li>åœ¨ <code>ofa.js</code> ä¸­ä½¿ç”¨ <code>on:click=&quot;yyy&quot;</code> çš„å½¢å¼ï¼Œå¯ä»¥å°†ç›®æ ‡å…ƒç´ çš„æŒ‡å®šäº‹ä»¶ï¼ˆä¾‹å¦‚ clickï¼‰ç»‘å®šåˆ°å®¿ä¸»ç»„ä»¶çš„å±æ€§ yyy ä¸Šã€‚é€šè¿‡è¿™ç§æ–¹å¼æˆ‘ä»¬ç»™ floating-button ç»‘å®šä¸Š click äº‹ä»¶ã€‚</li><li>ä½¿ç”¨ <code>x-if</code> æ¨¡æ¿ç»„ä»¶å¯¹å±•ç¤ºæ‚¬æµ®å›¾æ ‡çš„é€»è¾‘åšåˆ¤æ–­</li><li>ä½¿ç”¨ <code>&#123;&#123;title&#125;&#125;</code>çš„æ¸²æŸ“æ–‡æœ¬è¯­æ³•,æ¸²æŸ“ç”¨æˆ·ä¼ å…¥çš„ <code>title</code> å‚æ•°</li><li>ä½¿ç”¨ <code>attr:src=&quot;tipCode&quot; </code>å¯¹å…ƒç´ çš„ <code>attributes</code> è¿›è¡Œç»‘å®šï¼Œè®¾ç½®ä¸ºç”¨æˆ·ä¼ å…¥çš„ <code>tip-code</code> å‚æ•°<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">template</span> <span class="hljs-attr">component</span>&gt;</span><br>  <span class="hljs-comment">&lt;!--æ ·å¼éƒ¨åˆ†--&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">style</span>&gt;</span><br>    #floating-button &#123;<br><span class="css">      <span class="hljs-attribute">position</span>: fixed;</span><br>    &#125;<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- ....html éƒ¨åˆ† --&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;floating-button&quot;</span> <span class="hljs-attr">on:click</span>=<span class="hljs-string">&quot;handleClick&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">x-if</span> <span class="hljs-attr">:value</span>=<span class="hljs-string">&quot;isOpen&quot;</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- å±•ç¤º close å›¾æ ‡ --&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">x-if</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">x-else</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- å±•ç¤º info å›¾æ ‡ --&gt;</span><br>      <span class="hljs-tag">&lt;/<span class="hljs-name">x-else</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;floating-card&quot;</span> <span class="hljs-attr">attr:class</span>=<span class="hljs-string">&quot;isOpen?&#x27;opened&#x27;:&#x27;closed&#x27;&quot;</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>&#123;&#123;title&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>      <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">attr:src</span>=<span class="hljs-string">&quot;tipCode&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;tip-code&quot;</span> /&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><br><span class="javascript">    <span class="hljs-comment">// éœ€è¦æ³¨å†Œçš„ç»„ä»¶åï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰ tag å±æ€§ï¼Œæ³¨å†Œçš„ç»„ä»¶åä¸æ–‡ä»¶åä¿æŒä¸€è‡´</span></span><br><span class="javascript">    <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> tag = <span class="hljs-string">&quot;ofa-component&quot;</span>;</span><br><span class="javascript">    <span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;</span><br><span class="javascript">      <span class="hljs-keyword">return</span> &#123;</span><br>        data: &#123;<br><span class="javascript">          isOpen: <span class="hljs-literal">false</span>,</span><br>        &#125;,<br><span class="javascript">        <span class="hljs-comment">// è®¾ç½®åœ¨ attrs ä¸­çš„æ•°æ®ä¼šåˆå¹¶åˆ° data ä¸­ï¼Œä½†æ˜¯ attrs ä¸Šçš„æ•°æ®ä¼šä½“ç°åœ¨ç»„ä»¶è‡ªèº«çš„ attributes ä¸Šã€‚</span></span><br>        attrs: &#123;<br><span class="javascript">          title: <span class="hljs-string">&quot;Card Title&quot;</span>,</span><br><span class="javascript">          tipCode: <span class="hljs-string">&quot;&quot;</span>,</span><br>        &#125;,<br><span class="javascript">        <span class="hljs-comment">// åœ¨ proto å¯¹è±¡ä¸­æ³¨å†Œå¯¹åº”çš„å¤„ç†å‡½æ•°ï¼Œåˆ›å»ºç»„ä»¶çš„å®ä¾‹æ—¶ï¼Œè¿™äº›å±æ€§å’Œæ–¹æ³•å°±ä¼šè¢«æ·»åŠ åˆ°å®ä¾‹çš„åŸå‹ä¸Šï¼Œä»è€Œæ‰€æœ‰å®ä¾‹éƒ½å¯ä»¥è®¿é—®å’Œå…±äº«è¿™äº›æ–¹æ³•ã€‚</span></span><br>        proto: &#123;<br><span class="javascript">          <span class="hljs-function"><span class="hljs-title">handleClick</span>(<span class="hljs-params"></span>)</span> &#123;</span><br><span class="javascript">            <span class="hljs-built_in">this</span>.isOpen = !<span class="hljs-built_in">this</span>.isOpen;</span><br>          &#125;,<br>        &#125;,<br>      &#125;;<br>    &#125;<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span><br></code></pre></td></tr></table></figure></li></ul><p>æ¥ä¸‹æ¥ä½¿ç”¨ä¸€ä¸ªé™æ€èµ„æºæœåŠ¡å™¨æ‰“å¼€ <code>index.html</code> ï¼ŒæŸ¥çœ‹ç»„ä»¶æ˜¯å¦æ­£å¸¸å·¥ä½œã€‚<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2023-10-11-9hNihJ.png"><br>è‡³æ­¤ä½¿ç”¨ <code>ofa.js</code> å°è£…çš„ç»„ä»¶å°±å®Œæˆäº†ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ä½¿ç”¨ <code>ofa.js</code> å»ç¼–å†™ <code>web components</code> ç»„ä»¶çš„è¿‡ç¨‹ç›¸æ¯”åŸç”Ÿçš„ web-component çš„å†™æ³•ï¼Œå¯ä»¥å‡å°‘å¾ˆå¤šæ ·æ¿ä»£ç ï¼Œç»“åˆ <code>ofa.js</code> æä¾›çš„æ–‡ä»¶åŠ è½½å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿çš„åœ¨ç½‘é¡µä¸­å¼•å…¥ç»„ä»¶ã€‚å¦å¤– <code>ofa.js</code> å¯¹æ•°æ®å’Œ <code>dom</code> åšäº†æ•°æ®ç»‘å®šï¼Œæˆ‘ä»¬å¯ä»¥å‘Šåˆ«ç¹çå¯¹ <code>dom</code> æ“ä½œï¼Œè€Œå»åªå…³å¿ƒæ•°æ®çš„å˜åŠ¨ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://ofajs.com/">ofa.js æ˜¯ä¸€ä¸ªæ¸è¿›å¼å‰ç«¯æ¡†æ¶ï¼Œæ—¨åœ¨è®©å¼€å‘äººå‘˜ä»¥æœ€å°çš„æˆæœ¬è¿›å…¥å‰ç«¯å¼€å‘å’Œå·¥ä½œæµç¨‹ã€‚</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://juejin.cn/post/7044055764532461605">å“ˆå•°å‰ç«¯ Web Components æœ€ä½³å®è·µ</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>é˜…è¯»ç¬”è®°ã€ŠåŒºå—é“¾æŠ€æœ¯ä¸åº”ç”¨ã€‹</title>
    <link href="/posts/b1a85f07/"/>
    <url>/posts/b1a85f07/</url>
    
    <content type="html"><![CDATA[<p>[toc]</p><h2 id="å¯†ç å­¦åŸç†"><a href="#å¯†ç å­¦åŸç†" class="headerlink" title="å¯†ç å­¦åŸç†"></a>å¯†ç å­¦åŸç†</h2><h3 id="æ¯”ç‰¹å¸ä¸­-Hash-ç®—æ³•çš„ç‰¹æ€§"><a href="#æ¯”ç‰¹å¸ä¸­-Hash-ç®—æ³•çš„ç‰¹æ€§" class="headerlink" title="æ¯”ç‰¹å¸ä¸­ Hash ç®—æ³•çš„ç‰¹æ€§"></a>æ¯”ç‰¹å¸ä¸­ Hash ç®—æ³•çš„ç‰¹æ€§</h3><ul><li>hash collision resistance å“ˆå¸Œç¢°æ’ğŸ’¥  xâ‰ y ,H(x)=H(y) åƒè¿™æ · ä¸¤ä¸ªä¸åŒçš„è¾“å…¥ç®—å‡ºçš„hash å€¼æ˜¯ç›¸ç­‰çš„ï¼Œè¿™å°±æ˜¯hash ç¢°æ’</li><li>hiding  xâ€”&gt;H(x) è¾“å…¥åˆ°è¾“å‡ºæ˜¯ä¸å¯é€†çš„</li></ul><p>digital commitment  sealed envelope</p><p>ç°å®ä¸­çš„ä¾‹å­ï¼šé¢„æµ‹ç»“æœæå‰å…¬å¸ƒäº†ï¼Œä¼šå½±å“ç»“æœï¼Œsealed envelope å°±æ˜¯æ‰¾ä¸€ä¸ªå¯ä¿¡çš„åœ°æ–¹å­˜èµ·æ¥é¢„æµ‹ç»“æœï¼Œç­‰æ¬¡æ—¥ç»“æœå‡ºæ¥åï¼Œå¯¹æ¯”æ˜¯ä¸æ˜¯é¢„æµ‹å¯¹äº†ã€‚</p><p>æ•°å­—ä¸­çš„ä¾‹å­å°±æ˜¯ hash å‡½æ•°åŠ å¯†ï¼Œå› ä¸ºä¸å¯é€†æ€§ å’Œ ä¸å¯äººä¸ºå“ˆå¸Œç¢°æ’æ€§ã€‚   </p><ul><li>puzzle friendly  hash å€¼çš„è®¡ç®—æ˜¯ä¸å¯é¢„æµ‹çš„ï¼Œæ¯”å¦‚äº§ç”Ÿ 000â€¦xx..x è¿™æ ·çš„hash å€¼ï¼Œå®ç°å¹¶ä¸çŸ¥é“ä»€ä¹ˆæ ·çš„è¾“å…¥æ›´æœ‰å¯èƒ½ç®—å‡ºè¿™æ ·çš„hash å€¼</li></ul><p>H(block header) â‰¤ target (ç¬¦åˆè¦æ±‚çš„hash) æŒ–çŸ¿å°±æ˜¯ç®—å‡ºè¿™ä¸ª nonceï¼ŒæŒ–çŸ¿å¾ˆéš¾å…¶ä»–äººéªŒè¯è¿™ä¸ª nonce æ˜¯ä¸æ˜¯ç¬¦åˆè¦æ±‚å´å¾ˆå®¹æ˜“ã€‚</p><p>SHA-256 æ¯”ç‰¹å¸ä¸­ç”¨çš„ Hash ç®—æ³•</p><h3 id="ç­¾å"><a href="#ç­¾å" class="headerlink" title="ç­¾å"></a>ç­¾å</h3><ul><li>éå¯¹ç§°åŠ å¯†  å¯¹ç§°åŠ å¯† é€šè¿‡ ä¸€ä¸ªencyption æ¥éªŒè¯ï¼Œä½†æ˜¯éœ€è¦å®‰å…¨çš„ç¯å¢ƒï¼Œä¸ç„¶ å¯†é’¥æ³„éœ²å°±èƒ½è§£æå‡ºä¿¡æ¯ã€‚  äºæ˜¯ å°±æœ‰äº† public key, private key  å…¬é’¥å’Œç§é’¥ è¿™ç§<code>éå¯¹ç§°åŠ å¯†è®¾è®¡</code>å‡ºç°ã€‚  éå¯¹ç§°åŠ å¯†å°±æ˜¯åŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„ä¸æ˜¯ç›¸åŒçš„å¯†é’¥ï¼šåªæœ‰åŒä¸€ä¸ªå…¬é’¥-ç§é’¥å¯¹æ‰èƒ½æ­£å¸¸åŠ è§£å¯†ã€‚  å› æ­¤ï¼Œå¦‚æœå°æ˜è¦åŠ å¯†ä¸€ä¸ªæ–‡ä»¶å‘é€ç»™å°çº¢ï¼Œä»–åº”è¯¥é¦–å…ˆå‘å°çº¢ç´¢å–å¥¹çš„å…¬é’¥ï¼Œç„¶åï¼Œä»–ç”¨å°çº¢çš„å…¬é’¥åŠ å¯†ï¼ŒæŠŠåŠ å¯†æ–‡ä»¶å‘é€ç»™å°çº¢ï¼Œæ­¤æ–‡ä»¶åªèƒ½ç”±å°çº¢çš„ç§é’¥è§£å¼€ï¼Œå› ä¸ºå°çº¢çš„ç§é’¥åœ¨å¥¹è‡ªå·±æ‰‹é‡Œï¼Œæ‰€ä»¥ï¼Œé™¤äº†å°çº¢ï¼Œæ²¡æœ‰ä»»ä½•äººèƒ½è§£å¼€æ­¤æ–‡ä»¶ã€‚  ç”µå­é’±åŒ…é‡Œå°±æ˜¯æœ¬åœ°äº§ç”Ÿä¸€ä¸ªç§é’¥</li></ul><h2 id="æ•°æ®ç»“æ„"><a href="#æ•°æ®ç»“æ„" class="headerlink" title="æ•°æ®ç»“æ„"></a>æ•°æ®ç»“æ„</h2><h3 id="å“ˆå¸ŒæŒ‡é’ˆ-has-pointers"><a href="#å“ˆå¸ŒæŒ‡é’ˆ-has-pointers" class="headerlink" title="å“ˆå¸ŒæŒ‡é’ˆ has pointers"></a>å“ˆå¸ŒæŒ‡é’ˆ has pointers</h3><p>ä»£æ›¿äº†æ™®é€šçš„æŒ‡é’ˆï¼ŒåŒºå—é“¾å°±æ˜¯ä½¿ç”¨äº†å“ˆå¸ŒæŒ‡é’ˆçš„é“¾è¡¨</p><p>tamper-evident log è®°å½•</p><h3 id="merkle-tree"><a href="#merkle-tree" class="headerlink" title="merkle tree"></a>merkle tree</h3><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2023-04-09-kXSIKX.jpg" alt="merkle tree"><br>merkle proof æµç¨‹ï¼š<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2023-04-09-zvOg2X.jpg" alt="zvOg2X"></p>]]></content>
    
    
    <categories>
      
      <category>ç¬”è®°æœ¬</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¯»ä¹¦ç¬”è®°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é˜…è¯»ç¬”è®°ã€ŠjavaScript DOM ç¼–ç¨‹è‰ºæœ¯ã€‹</title>
    <link href="/posts/210b5058/"/>
    <url>/posts/210b5058/</url>
    
    <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2021-11-09-WmerG5.jpg" alt="2021-11-09-WmerG5"></p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è¿™æ˜¯ä¸€æœ¬å‡ºç‰ˆäº<code>2011</code>å¹´çš„æŠ€æœ¯ä¹¦ç±ï¼Œä¹¦ä¸­çš„å¾ˆå¤š<code>API</code> å¯èƒ½å·²ç»è¿‡æ—¶ï¼Œç°åœ¨æœ‰æ›´å¥½æ›´ä¾¿æ·çš„ APIã€‚<code>W3C</code>çš„<code>DOMæ ‡å‡†</code>æ˜¯å¼€å‘<code>Web</code>åº”ç”¨çš„åŸºçŸ³ï¼Œè™½ç„¶æˆ‘å…¥è¡Œä»¥æ¥ä¸€ç›´åœ¨ç”¨<code>react/vue/angular</code> ä¹‹ç±»çš„å‰ç«¯æ¡†æ¶ç¼–å†™<code>web</code>åº”ç”¨ï¼Œå·²ç»ä¸ç”¨ç›´æ¥æ“ä½œ DOMï¼Œä½†æµè§ˆå™¨é¡µé¢è¿˜æ˜¯ DOM é‚£å¥—ä¸œè¥¿ï¼ŒåŠ ä¸Šä¹¦ä¸­ç¼–ç¨‹è‰ºæœ¯çš„æ€æƒ³ï¼Œè¿™äº›éƒ½æ˜¯å€¼å¾—ä¸€è¯»çš„ã€‚</p><blockquote><p>å†™äº 2021/10/21</p></blockquote><h2 id="ä»€ä¹ˆæ˜¯-DOM-Document-Object-Model"><a href="#ä»€ä¹ˆæ˜¯-DOM-Document-Object-Model" class="headerlink" title="ä»€ä¹ˆæ˜¯ DOM (Document Object Model)"></a>ä»€ä¹ˆæ˜¯ DOM (Document Object Model)</h2><p>DOM æœ¬è´¨æ—¶ä¸€ç§ API(åº”ç”¨ç¼–ç¨‹æ¥å£)ã€‚ç®€å•åœ°æ¥è¯´ï¼ŒAPI å°±æ˜¯ä¸€ç»„å·²ç»å¾—åˆ°æœ‰å…³å„æ–¹å…±åŒè®¤å¯çš„åŸºæœ¬çº¦å®šã€‚ç°å®ä¸–ç•Œä¸­ï¼Œç›¸å½“äº API çš„ä¾‹å­åŒ…æ‹¬æ‘©å°”æ–¯ç ã€å›½é™…æ—¶åŒºï¼›</p><p>åœ¨è½¯ä»¶ç¼–ç¨‹é¢†åŸŸï¼Œè™½ç„¶å­˜åœ¨ç€å¤šç§ä¸åŒçš„è¯­è¨€ï¼Œä½†å¾ˆå¤šä»»åŠ¡å´æ˜¯ç›¸åŒæˆ–ç›¸ä¼¼çš„ã€‚è¿™ä¹Ÿæ­£æ˜¯äººä»¬éœ€è¦ API çš„åŸå› ã€‚ä¸€æ—¦æŒæ¡äº†æŸä¸ªæ ‡å‡†ï¼Œå°±å¯ä»¥æŠŠå®ƒåº”ç”¨åœ¨è®¸å¤šä¸åŒçš„ç¯å¢ƒä¸­ã€‚è™½ç„¶è¯­æ³•ä¼šå› ä¸ºä½¿ç”¨çš„ç¨‹åºè®¾è®¡è¯­è¨€è€Œæœ‰æ‰€å˜åŒ–ï¼Œä½†è¿™äº›çº¦å®šå´æ€»æ˜¯ä¿æŒä¸å˜çš„ã€‚</p><p>DOM æ˜¯ä¸€ç§é€‚ç”¨äºå¤šç§ç¯å¢ƒå’Œå¤šç§ï¼Œç¨‹åºè®¾è®¡è¯­è¨€çš„é€šç”¨å‹ API</p><blockquote><p>tips: åœ¨æ ‡å‡†åŒ– DOM å‡ºç°å‰ç»™ 20 ä¸–çºª 90 å¹´ä»£åæœŸçš„ç¨‹åºå‘˜ä»¬é€ æˆç—›è‹¦å›å¿†çš„ â€œDHTMLâ€.<br>â€œDHTML æ˜¯â€œDynamic HTMLâ€ï¼ˆåŠ¨æ€ HTMLï¼‰çš„ç®€ç§°ã€‚DHTML å¹¶ä¸æ˜¯ä¸€é¡¹æ–°æŠ€æœ¯ï¼Œè€Œæ˜¯æè¿° HTMLã€CSS å’Œ JavaScript æŠ€æœ¯ç»„åˆçš„æœ¯è¯­ã€‚â€</p></blockquote><p>DOM æŠŠæ–‡æ¡£è¡¨ç¤ºä¸ºä¸€æ£µæ ‘</p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/wejP2v.png" alt="wejP2v"></p><p>æ ¹å…ƒç´ å°±æ˜¯<code>html</code>ã€‚</p><p>ç¬¬äºŒå±‚æ˜¯ <code>head</code> å’Œ <code>body</code> ï¼Œä»–ä»¬æ˜¯å¹³çº§å…ƒç´ ã€‚<code>head</code>æœ‰ä¸¤ä¸ªå­å…ƒç´  ï¼š<code>meta</code> å’Œ <code>title</code>ã€‚<code>body</code>ä¸‹é¢å°±æ˜¯æˆ‘ä»¬æ—¥å¸¸ç¼–å†™çš„ html å…ƒç´ äº†</p><p>DOM æ˜¯ç”±èŠ‚ç‚¹æ„æˆçš„é›†åˆï¼Œå…ƒç´ èŠ‚ç‚¹ã€æ–‡æœ¬èŠ‚ç‚¹ã€å±æ€§èŠ‚ç‚¹ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;balbal..&quot;</span>&gt;</span>æ–‡æœ¬å†…å®¹...<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br></code></pre></td></tr></table></figure><p>p æ ‡ç­¾å°±æ˜¯å…ƒç´ èŠ‚ç‚¹ï¼Œ<code>&lt;p&gt;xxxx&lt;/p&gt;</code> å…ƒç´ ä¸­çš„æ–‡æœ¬å°±æ˜¯æ–‡æœ¬èŠ‚ç‚¹ï¼Œ<code>title</code>å°±æ˜¯å±æ€§èŠ‚ç‚¹</p><h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><blockquote><p>cssï¼ˆå±‚å æ ·å¼è¡¨ï¼‰,å‘Šè¯‰æµè§ˆå™¨å¦‚ä½•æ˜¾ç¤ºä¸€ä»½æ–‡æ¡£çš„å†…å®¹ã€‚</p></blockquote><h3 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="headerlink" title="ç»§æ‰¿"></a>ç»§æ‰¿</h3><p>ç»§æ‰¿ ï¼ˆinheritanceï¼‰æ˜¯ CSS æŠ€æœ¯ä¸­çš„ä¸€é¡¹å¼ºå¤§åŠŸèƒ½ã€‚ç±»ä¼¼äº DOMï¼ŒCSS ä¹ŸæŠŠæ–‡æ¡£çš„å†…å®¹è§†ä¸ºä¸€æ£µèŠ‚ç‚¹æ ‘ã€‚èŠ‚ç‚¹æ ‘ä¸Šçš„å„ä¸ªå…ƒç´ å°†ç»§æ‰¿å…¶çˆ¶å…ƒç´ çš„æ ·å¼å±æ€§ã€‚</p><p>ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬ä¸º body å…ƒç´ å®šä¹‰äº†ä¸€äº›é¢œè‰²æˆ–å­—ä½“ï¼ŒåŒ…å«åœ¨ body å…ƒç´ é‡Œçš„æ‰€æœ‰å…ƒç´ éƒ½å°†è‡ªåŠ¨è·å¾—é‚£äº›æ ·å¼ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-tag">body</span> &#123;<br>  <span class="hljs-attribute">color</span>: white;<br>  <span class="hljs-attribute">background-color</span>: black;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™äº›é¢œè‰²å°†ä¸ä»…ä½œç”¨äºé‚£äº›ç›´æ¥åŒ…å«åœ¨<body>æ ‡ç­¾é‡Œçš„å†…å®¹ï¼Œè¿˜å°†ä½œç”¨äºåµŒå¥—åœ¨ body å…ƒç´ å†…éƒ¨çš„æ‰€æœ‰å…ƒç´ </p><h2 id="è·å–å…ƒç´ "><a href="#è·å–å…ƒç´ " class="headerlink" title="è·å–å…ƒç´ "></a>è·å–å…ƒç´ </h2><p>è¿™æœ¬ä¹¦å‡ºç‰ˆäº 2011 å¹´ï¼Œé‚£æ—¶çš„ dom æ“ä½œ è·å–å…ƒç´ çš„æ–¹å¼åªæœ‰ä¸‰ç§</p><ul><li>document.getElementById é€šè¿‡å…ƒç´  ID è·å–ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡</li><li>document.getElementsByTagName é€šè¿‡æ ‡ç­¾åè·å–ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡æ•°ç»„</li><li>document.getElementsByClassName é€šè¿‡ç±»åè·å–ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡æ•°ç»„</li></ul><h2 id="è·å–å’Œè®¾ç½®å±æ€§"><a href="#è·å–å’Œè®¾ç½®å±æ€§" class="headerlink" title="è·å–å’Œè®¾ç½®å±æ€§"></a>è·å–å’Œè®¾ç½®å±æ€§</h2><ul><li>getAttribute è·å–æ–‡æ¡£å±æ€§</li><li>setAttribute è®¾ç½®æ–‡æ¡£å±æ€§ element.setAttribute(attributename,attributevalue)</li></ul><p>è¿™ä¿©æ–¹æ³•ä¸å±äº document å¯¹è±¡ï¼Œåªèƒ½é€šè¿‡å…ƒç´ èŠ‚ç‚¹å¯¹è±¡è°ƒç”¨</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-keyword">var</span> paras = <span class="hljs-built_in">document</span>.getElementsByTagName(<span class="hljs-string">&quot;p&quot;</span>);<br><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>; i&lt; paras.length; i++) &#123;<br>  <span class="hljs-keyword">var</span> title_text = paras[i].getAttribute(<span class="hljs-string">&quot;title&quot;</span>);<br>  <span class="hljs-keyword">if</span> (title_text) &#123;<br>    paras[i].setAttribute(<span class="hljs-string">&quot;title&quot;</span>,<span class="hljs-string">&quot;brand new title text&quot;</span>);<br>    alert(paras[i].getAttribute(<span class="hljs-string">&quot;title&quot;</span>));<br>  &#125;<br>&#125;<br>æ‘˜å½•æ¥è‡ª: Jeremy Keith. â€œJavaScript DOMç¼–ç¨‹è‰ºæœ¯(ç¬¬<span class="hljs-number">2</span>ç‰ˆ)ï¼ˆå›¾çµå›¾ä¹¦)<br></code></pre></td></tr></table></figure><h2 id="ä¸€ä¸ªæ¡ˆä¾‹ï¼šweb-å›¾ç‰‡åº“"><a href="#ä¸€ä¸ªæ¡ˆä¾‹ï¼šweb-å›¾ç‰‡åº“" class="headerlink" title="ä¸€ä¸ªæ¡ˆä¾‹ï¼šweb å›¾ç‰‡åº“"></a>ä¸€ä¸ªæ¡ˆä¾‹ï¼šweb å›¾ç‰‡åº“</h2><ol><li>å­¦ä¹ å¦‚ä½•åˆ©ç”¨<code>DOM</code>æä¾›çš„æ–¹æ³•å»ç¼–å†™è„šæœ¬</li><li>å­¦ä¹ å¦‚ä½•åˆ©ç”¨äº‹ä»¶å¤„ç†å‡½æ•°æŠŠ<code>JavaScript</code>ä»£ç ä¸ç½‘é¡µé›†æˆåœ¨ä¸€èµ·</li></ol><p>ä»‹ç»äº† <code>DOM</code> æä¾›çš„å‡ ä¸ªæ–°å±æ€§:</p><ul><li>childNodes</li><li>nodeType è·å–æˆ–è®¾ç½®å…ƒç´ æ–‡æœ¬å€¼</li><li>nodeValue è·å–èŠ‚ç‚¹ç±»å‹</li><li>firstChild childNodes ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ </li><li>lastChild childNodes ä¸­æœ€åä¸€ä¸ªå…ƒç´ </li></ul><p>å…¶ä¸­ nodeType å±æ€§å¯ä»¥è·å–èŠ‚ç‚¹ç±»å‹ã€‚nodetype å±æ€§æ€»å…±æœ‰ 12 ç§å¯å–å€¼ï¼Œä½†å…¶ä¸­ä»…æœ‰ 3 ç§å…·æœ‰å®ç”¨ä»·å€¼ã€‚</p><ul><li>å…ƒç´ èŠ‚ç‚¹çš„ nodeType å±æ€§å€¼æ˜¯ 1</li><li>å±æ€§èŠ‚ç‚¹çš„ nodeType å±æ€§å€¼æ˜¯ 2</li><li>æ–‡æœ¬èŠ‚ç‚¹çš„ nodeType å±æ€§å€¼æ˜¯ 3</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">showPic</span>(<span class="hljs-params">whichpic</span>) </span>&#123;<br>  <span class="hljs-comment">// è·å–ä¼ å…¥å…ƒç´ çš„å±æ€§</span><br>  <span class="hljs-keyword">var</span> source = whichpic.getAttribute(<span class="hljs-string">&quot;href&quot;</span>);<br>  <span class="hljs-comment">// è·å–å ä½å›¾</span><br>  <span class="hljs-keyword">var</span> placeholder = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;placeholder&quot;</span>);<br>  <span class="hljs-comment">// æ›´æ”¹imgå…ƒç´ çš„srcå±æ€§ æ¥åˆ°è¾¾åˆ‡æ¢å›¾ç‰‡æ˜¾ç¤º</span><br>  placeholder.setAttribute(<span class="hljs-string">&quot;src&quot;</span>, source);<br>  <span class="hljs-keyword">var</span> text = whichpic.getAttribute(<span class="hljs-string">&quot;title&quot;</span>);<br>  <span class="hljs-keyword">var</span> description = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;description&quot;</span>);<br>  <span class="hljs-comment">// æ›´æ”¹æ–‡æœ¬èŠ‚ç‚¹çš„å€¼</span><br>  description.firstChild.nodeValue = text;<br>&#125;<br></code></pre></td></tr></table></figure><p>äº‹ä»¶å¤„ç†å‡½æ•°çš„å·¥ä½œæœºåˆ¶ã€‚åœ¨ç»™æŸä¸ªå…ƒç´ æ·»åŠ äº†äº‹ä»¶å¤„ç†å‡½æ•°åï¼Œä¸€æ—¦äº‹ä»¶å‘ç”Ÿï¼Œç›¸åº”çš„ JavaScript ä»£ç å°±ä¼šå¾—åˆ°æ‰§è¡Œã€‚</p><p>è¢«è°ƒç”¨çš„ JavaScript ä»£ç å¯ä»¥è¿”å›ä¸€ä¸ªå€¼ï¼Œè¿™ä¸ªå€¼å°†è¢«ä¼ é€’ç»™é‚£ä¸ªäº‹ä»¶å¤„ç†å‡½æ•°ã€‚<br>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ç»™æŸä¸ªé“¾æ¥æ·»åŠ ä¸€ä¸ª onclick äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œå¹¶è®©è¿™ä¸ªå¤„ç†å‡½æ•°æ‰€è§¦å‘çš„ JavaScript ä»£ç è¿”å›å¸ƒå°”å€¼ true æˆ– false ã€‚</p><p>è¿™æ ·ä¸€æ¥ï¼Œå½“è¿™ä¸ªé“¾æ¥è¢«ç‚¹å‡»æ—¶ï¼Œå¦‚æœé‚£æ®µ JavaScript ä»£ç è¿”å›çš„å€¼æ˜¯ true ï¼Œonclick äº‹ä»¶å¤„ç†å‡½æ•°å°±è®¤ä¸ºâ€œè¿™ä¸ªé“¾æ¥è¢«ç‚¹å‡»äº†â€ï¼›</p><p>åä¹‹ï¼Œå¦‚æœè¿”å›çš„å€¼æ˜¯ false ï¼Œonclick äº‹ä»¶å¤„ç†å‡½æ•°å°±è®¤ä¸ºâ€œè¿™ä¸ªé“¾æ¥æ²¡æœ‰è¢«ç‚¹å‡»â€ã€‚</p><p>ç»™<code>a</code>æ ‡ç­¾çš„ onclick äº‹ä»¶æ·»åŠ <code>return false</code> å°±å¯ä»¥é˜»æ­¢<code>a</code>æ ‡ç­¾ç‚¹å‡»è·³è½¬é“¾æ¥çš„é»˜è®¤è¡Œä¸º</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><br>  <span class="hljs-comment">&lt;!-- â€œä½¿ç”¨this å…³é”®å­—ã€‚è¿™ä¸ªå…³é”®å­—åœ¨è¿™å„¿çš„å«ä¹‰æ˜¯â€œè¿™ä¸ªå¯¹è±¡â€ã€‚å…·ä½“åˆ°å½“å‰çš„ä¾‹å­ï¼Œthis è¡¨ç¤ºâ€œè¿™ä¸ª&lt;a&gt; å…ƒç´ èŠ‚ç‚¹â€â€ --&gt;</span><br>  &lt;a<br>    onclick=&quot;showPic(this);return false;&quot;<br>    href=&quot;https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/4nnHSd.jpg&quot;<br>    title=&quot;A fireworks display&quot;<br>  &gt;<br>    Fireworks<br>  <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span><br></code></pre></td></tr></table></figure><h2 id="æœ€ä½³å®è·µ"><a href="#æœ€ä½³å®è·µ" class="headerlink" title="æœ€ä½³å®è·µ"></a>æœ€ä½³å®è·µ</h2><ul><li>å¹³ç¨³é€€åŒ–ï¼Œç¦ç”¨ javascript? 2021 å¹´ç°åœ¨è°è¿˜å…³å¿ƒè¿™ä¸ªï¼Œç¦ç”¨ js æ˜¯å§ç½‘ç«™ç›´æ¥ä¸è®©ä½¿ç”¨</li></ul><h3 id="â€œjavascript-â€ä¼ªåè®®"><a href="#â€œjavascript-â€ä¼ªåè®®" class="headerlink" title="â€œjavascript:â€ä¼ªåè®®"></a>â€œjavascript:â€ä¼ªåè®®</h3><blockquote><p>â€œçœŸâ€åè®®ç”¨æ¥åœ¨å› ç‰¹ç½‘ä¸Šçš„è®¡ç®—æœºä¹‹é—´ä¼ è¾“æ•°æ®åŒ…ï¼Œå¦‚ HTTP åè®®ï¼ˆhttp://ï¼‰ã€FTP åè®®ï¼ˆftp://ï¼‰ç­‰ï¼Œä¼ªåè®®åˆ™æ˜¯ä¸€ç§éæ ‡å‡†åŒ–çš„åè®®ã€‚â€œjavascript:â€ä¼ªåè®®è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªé“¾æ¥æ¥è°ƒç”¨ JavaScript å‡½æ•°ã€‚</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">popUp</span>(<span class="hljs-params">winURL</span>) </span>&#123;<br>  <span class="hljs-built_in">window</span>.open(winURL,<span class="hljs-string">&quot;popup&quot;</span>,<span class="hljs-string">&quot;width=320,height=480&quot;</span>);<br>&#125;<br>&lt;a href=<span class="hljs-string">&quot;javascript:popUp(&#x27;http://www.example.com/&#x27;);&quot;</span>&gt;Example&lt;/a&gt;<br><span class="hljs-comment">// å†…åµŒå¤„ç†å‡½æ•°çš„æ–¹å¼è°ƒç”¨</span><br>&lt;a href=<span class="hljs-string">&quot;#&quot;</span> onclick=<span class="hljs-string">&quot;popUp(&#x27;http://www.example.com/&#x27;); return false;&quot;</span>&gt;Example&lt;/a&gt;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç¬”è®°æœ¬</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¯»ä¹¦ç¬”è®°</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è§‚åæ„Ÿ çºªå½•ç‰‡ã€Šäººæ ¼çš„çœŸç›¸ã€‹</title>
    <link href="/posts/1f723736/"/>
    <url>/posts/1f723736/</url>
    
    <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2021-11-07-6xFP3P.jpg" alt="2021-11-07-6xFP3P"></p><h2 id="ä¸€é¡¹-1975-å¹´çš„è°ƒæŸ¥é—®å·å†…å®¹ï¼š"><a href="#ä¸€é¡¹-1975-å¹´çš„è°ƒæŸ¥é—®å·å†…å®¹ï¼š" class="headerlink" title="ä¸€é¡¹ 1975 å¹´çš„è°ƒæŸ¥é—®å·å†…å®¹ï¼š"></a>ä¸€é¡¹ 1975 å¹´çš„è°ƒæŸ¥é—®å·å†…å®¹ï¼š</h2><ol><li> éšç€å¹´é¾„çš„å¢é•¿ ä½ ä¼šå˜å¾—è¶Šæ¥è¶Šæ²¡ç”¨ï¼Ÿ</li><li> éšç€ä½ å˜è€ï¼Œæƒ…å†µæ˜¯å˜å¥½äº†è¿˜æ˜¯å’Œä¹‹å‰ä¸€æ ·ï¼Ÿ</li></ol><p>ä¸Šé¢é—®é¢˜çš„ç»“æœå¯èƒ½ä¼šå½±å“ä½ çš„å¯¿å‘½ï¼Œé€šè¿‡å¯¹æ¯”å‚ä¸å®éªŒçš„äººç¾¤çš„æ­»äº¡æ•°æ®å¾—å‡ºä¹è§‚çš„äººè¦æ¯”æ‚²è§‚çš„äººå¯¿å‘½é•¿ 7 å¹´å¤š</p><h2 id="å¿ƒç†å­¦æ˜¯é—¨ç§‘å­¦ï¼Œä¸æ˜¯ç„å­¦"><a href="#å¿ƒç†å­¦æ˜¯é—¨ç§‘å­¦ï¼Œä¸æ˜¯ç„å­¦" class="headerlink" title="å¿ƒç†å­¦æ˜¯é—¨ç§‘å­¦ï¼Œä¸æ˜¯ç„å­¦"></a>å¿ƒç†å­¦æ˜¯é—¨ç§‘å­¦ï¼Œä¸æ˜¯ç„å­¦</h2><p>å®éªŒä¸­ç”¨åˆ°äº†å¾ˆå¤šç§‘å­¦ä»ªå™¨ï¼šæ£€æµ‹è„‘ç”µæ´»åŠ¨</p><p>ç§‘å­¦è¯å®å·¦å³è„‘åŠŸèƒ½æ˜¯ä¸åŒçš„ï¼šåœ¨ä¸åŒçš„æ´»åŠ¨ä¸‹ï¼Œå·¦å³è„‘æ£€æµ‹åˆ°çš„è„‘ç”µæ´»åŠ¨ä¸åŒ</p><p>æ„è¯†ä¼šä»¥ç‰©è´¨çš„å½¢å¼å­˜åœ¨å—ï¼Ÿæˆ‘ä»¬å¸¸è¯´åˆ»åœ¨ DNA é‡Œçš„è®°å¿† æ˜¯æ€æ ·ä¿ç•™ä¸‹æ¥çš„å‘¢ï¼Ÿ</p><h2 id="part2-è°ƒæŸ¥é—®å·çš„é—®é¢˜ï¼š"><a href="#part2-è°ƒæŸ¥é—®å·çš„é—®é¢˜ï¼š" class="headerlink" title="part2 è°ƒæŸ¥é—®å·çš„é—®é¢˜ï¼š"></a>part2 è°ƒæŸ¥é—®å·çš„é—®é¢˜ï¼š</h2><ol><li>äººä»¬è®¤ä¸ºè‡ªå·±å¿«ä¹ï¼Œä½†æ˜¯å½“å¡«å†™äº†é•¿é•¿çš„é—®å·åäººä»¬ä¼šè§‰å¾—è‡ªå·±ä¸å¿«ä¹<br> è®²è¯‰è€…ä½©æˆ´äº†ä¸€ç§æ‰‹ç¯å¤§è‡´æ˜¯èƒ½åšæŒäººçš„å‹åŠ›çŠ¶æ€ï¼Œæµ‹è¯•ç»“æœè·Ÿå®é™…æƒ…å†µç±»ä¼¼ï¼Œè®²è¿°è€…æœ‰è½»å¾®çš„ç¤¾äº¤ææƒ§ï¼Œè€Œä¸”é•¿æœŸå¿ƒç†ç´§å¼ ï¼Œç¡çœ è´¨é‡ä¸å¥½ã€‚</li></ol><blockquote><p>è®²è¯‰è€…è‡ªå·±ç„¦è™‘çš„åŸå› ï¼š</p></blockquote><p>å¤ªå®¹æ˜“è¢«è‡ªå·±çš„æ€æƒ³å·¦å³ï¼Œä¸æ‡‚å¾—äº«å—å½“ä¸‹</p><h2 id="part3-è®¤çŸ¥åè§ä¿®æ­£"><a href="#part3-è®¤çŸ¥åè§ä¿®æ­£" class="headerlink" title="part3 è®¤çŸ¥åè§ä¿®æ­£"></a>part3 è®¤çŸ¥åè§ä¿®æ­£</h2><ul><li>å¯¹ç€ä¸åŒæƒ…ç»ªè¡¨æƒ…çš„å›¾ç‰‡ è¿›è¡Œè®­ç»ƒï¼Œæ„Ÿè§‰ä¸é è°±ï¼Œè¿˜ä¸å¦‚æ¯å¤©çœ‹æ–°é—»è”æ’­ï¼›</li><li>å†¥æƒ³</li><li>æ¯å¤©æ‹¿å‡º 10 åˆ†é’Ÿè¿›è¡Œå†¥æƒ³</li><li>ç§‘å­¦ä»ªå™¨ç ”ç©¶è¡¨æ˜ï¼Œé•¿æœŸå†¥æƒ³çš„äººï¼ˆ8 å‘¨ä»¥ä¸Šï¼‰ä»–ä»¬çš„å¤§è„‘å·¦å‰é¢å¶çš®è´¨æ´»è·ƒåº¦å¢åŠ äº†ã€å¤§è„‘ç°è´¨ä¹Ÿå¢åŠ äº†</li><li>å†¥æƒ³å¹¶ä¸ä¼šå¾ˆç®€å•ï¼Œåªæ˜¯æ–¹å¼å¾ˆç®€å•ï¼Œéœ€è¦å¤©å¤©åšæŒæ‰èƒ½çœ‹åˆ°ç»“æœ</li><li>å¦‚ä½•å†¥æƒ³ï¼Ÿ</li><li>ä»ä¸Šåˆ°ä¸‹æ„Ÿå—è‡ªå·±çš„èº«ä½“ï¼Œæ„Ÿè§‰ä¸€ä¸‹èº«ä½“çš„å“ªä¸ªéƒ¨åˆ†æ„Ÿåˆ°æ”¾æ¾ï¼Œå“ªä¸ªéƒ¨åˆ†æ„Ÿåˆ°ç´§å¼ ï¼Œå¦‚æœæœ‰æ‚å¿µå¾ˆæ­£å¸¸ï¼Œè®©è¿™äº›æƒ³æ³•è‡ªç”±çš„çš„æ¥å»</li><li>ç›®çš„æ˜¯ä¸ºäº†è®­ç»ƒå¤§è„‘ï¼Œè®©ä»–æ€æƒ³æ›´é›†ä¸­ï¼Œå‹åŠ›ä¹Ÿä¼šå‡å°‘</li></ul><h2 id="part4-è¿½æº¯æ ¹æº"><a href="#part4-è¿½æº¯æ ¹æº" class="headerlink" title="part4 è¿½æº¯æ ¹æº"></a>part4 è¿½æº¯æ ¹æº</h2><ul><li>è®²è¯‰è€…å¼€å§‹å›å¿†å°æ—¶å€™ï¼Œè‡ªå·±å•çº¯ å¿«ä¹çš„ç«¥å¹´ï¼Œæ— å¿§æ— è™‘ï¼Œçˆ¶äº²å¾ˆå°‘é™ªä¼´è‡ªå·±</li><li>å…ˆå¤©åŸºå› ä¸åå¤©ç»å†å…±åŒä½œç”¨çš„ç»“æœ</li><li>é€šè¿‡å¯¹åŒèƒèƒçš„ç ”ç©¶æ¥ç ”ç©¶åŸºå› å’Œåå¤©ç»å†å¯¹æ€§æ ¼çš„å½±å“</li><li>é—ä¼ å› ç´ å  40%â€”50%</li><li>åŸºå› ä¸æ˜¯ä¸€å±‚ä¸å˜çš„ï¼ŒåŸºå› ç‰‡æ®µä¸­çš„ä¸œè¥¿ä¼šéšç€åå¤©ç»å†æ”¹å˜</li></ul><h2 id="END"><a href="#END" class="headerlink" title="END"></a>END</h2><blockquote><p>è®²è¯‰è€…ç»è¿‡ 7 å‘¨çš„å†¥æƒ³åï¼š</p></blockquote><ul><li>ä»–çš„å¦»å­æ„Ÿè§‰ä»–æœ‰æ”¹å˜ï¼Œå‹åŠ›å˜å°äº†ï¼Œç¡çœ ä¹Ÿæœ‰æ”¹å–„ã€‚</li><li>ä»ªå™¨æ£€æµ‹åå‘ç° å¤§è„‘å³å‰é¢å¶çš®è´¨æ´»è·ƒåº¦é™ä½äº†å¾ˆå¤šã€‚</li><li>æ ·æœ¬é‡å¾ˆå° æ— æ³•ä»£è¡¨æ‰€æœ‰äººï¼Œä½†æ˜¯æ¯å¤© 10 åˆ†é’Ÿä¸ºä»€ä¹ˆä¸è¯•è¯•å‘¢ï¼Ÿ</li><li>æƒ³æ”¹å˜æ€§æ ¼ï¼Œæ°¸è¿œéƒ½ä¸æ™šï¼Œä¹è§‚ä¸€äº›å§ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>ç¬”è®°æœ¬</category>
      
    </categories>
    
    
    <tags>
      
      <tag>çºªå½•ç‰‡</tag>
      
      <tag>è§‚ç‚¹æ„Ÿæƒ³</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é˜…è¯»ç¬”è®°ã€Šæœ€å¥½çš„å‘Šåˆ«ã€‹</title>
    <link href="/posts/f2c957b0/"/>
    <url>/posts/f2c957b0/</url>
    
    <content type="html"><![CDATA[<p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2021-11-07-dez79U.jpg" alt="2021-11-07-dez79U"></p><h2 id="ä»€ä¹ˆæ—¶å€™åº”è¯¥æ”¾å¼ƒæ²»ç–—"><a href="#ä»€ä¹ˆæ—¶å€™åº”è¯¥æ”¾å¼ƒæ²»ç–—" class="headerlink" title="ä»€ä¹ˆæ—¶å€™åº”è¯¥æ”¾å¼ƒæ²»ç–—"></a>ä»€ä¹ˆæ—¶å€™åº”è¯¥æ”¾å¼ƒæ²»ç–—</h2><p>å§‘æ¯æ²»ç–—ï¼Œåº”è¯¥å‡å°‘åŒ»å­¦æ²»ç–— ï¼Œå¢åŠ åŒ»å­¦æŠ¤ç†ï¼Œå°è¯•æ–°çš„å®‰å®ç¼“å’ŒåŒ»ç–—æ¨¡å¼ï¼ˆé€šè¿‡å…³æ€€ä¸æŠšæ…°çš„æ‰‹æ®µï¼‰ï¼Œå–„ç»ˆæœåŠ¡å°±æ˜¯å§‘æ¯æ²»ç–—ï¼Œå°±æ˜¯é€šè¿‡ç»™äºˆç›¸åº”çš„ç…§æ–™å¸®åŠ©ç—…äººå¤„ç†è¿™äº›å›°éš¾ã€‚</p><p>ä¸€ä¸ªå›½å®¶åŒ»ç–—å‘å±•çš„é˜¶æ®µï¼š</p><ol><li>å›½å®¶æåº¦è´«å›°ï¼Œæ²¡æœ‰åŒ»ç–—æ¡ä»¶ï¼Œåªèƒ½åœ¨å®¶ç­‰æ­»</li><li>ç»æµå‘å±• å…¬å…±å«ç”ŸåŒ»ç–—æ¡ä»¶æå‡ï¼Œåœ¨åŒ»é™¢å»ä¸–</li><li>ç»æµç‰©è´¨é«˜åº¦å‘è¾¾ï¼Œå¼€å§‹æ³¨é‡ç”Ÿå‘½çš„è´¨é‡ï¼Œå±…å®¶ç¦»ä¸–å˜å¤šã€‚å‚è€ƒç¾å›½</li></ol><h2 id="ä¸‰ç§åŒ»æ‚£å…³ç³»ï¼š"><a href="#ä¸‰ç§åŒ»æ‚£å…³ç³»ï¼š" class="headerlink" title="ä¸‰ç§åŒ»æ‚£å…³ç³»ï¼š"></a>ä¸‰ç§åŒ»æ‚£å…³ç³»ï¼š</h2><ul><li>å®¶é•¿å‹ï¼š<br>æˆ‘ä»¬æ˜¯åŒ»å­¦æƒå¨ï¼Œç›®çš„æ˜¯ç¡®ä¿ç—…äººæ¥å—æˆ‘ä»¬è®¤ä¸ºå¯¹ä»–æœ€å¥½çš„æ²»ç–—ã€‚æˆ‘ä»¬æœ‰çŸ¥è¯†å’Œç»éªŒï¼Œè´Ÿè´£ä½œå‡ºå…³é”®çš„æŠ‰æ‹©ã€‚å¦‚æœæœ‰ä¸€ç²’çº¢è‰²è¯ç‰‡å’Œä¸€ç²’è“è‰²è¯ç‰‡ï¼Œæˆ‘ä»¬ä¼šå‘Šè¯‰ä½ ï¼šâ€œåƒçº¢è‰²è¯ç‰‡ï¼Œè¿™å¯¹ä½ å¥½ã€‚â€æˆ‘ä»¬å¯èƒ½ä¼šç»™ä½ è®²è®²è“è‰²è¯ç‰‡ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬ä¹Ÿå¯èƒ½ä¸è®²ã€‚æˆ‘ä»¬å‘Šè¯‰ä½ æˆ‘ä»¬è®¤ä¸ºä½ éœ€è¦çŸ¥é“çš„ä¸œè¥¿ã€‚è¿™æ˜¯ä¸€ç§ç¥­å¸å‹çš„ã€â€œåŒ»ç”Ÿæœ€æ˜ç™½â€çš„æ¨¡å¼ï¼Œè™½ç„¶ç»å¸¸é­åˆ°è°´è´£ï¼Œä½†ç›®å‰ä»ç„¶æ˜¯æ™®éçš„åŒ»æ‚£äº¤å¾€æ¨¡å¼ï¼Œå°¤å…¶å¯¹äºæ˜“å—ä¼¤å®³çš„ç—…äººâ€”â€”è™šå¼±çš„ã€è´«ç©·çš„ã€è€å¹´çš„ï¼Œä»¥åŠæ‰€æœ‰å®¹æ˜“å¬ä»æŒ‡ä»¤çš„äººã€‚</li><li>èµ„è®¯å‹ï¼š<br>åŒå®¶é•¿å‹å…³ç³»æ­£å¥½ç›¸åã€‚æˆ‘ä»¬å‘Šè¯‰æ‚£è€…äº‹å®å’Œæ•°æ®ï¼Œå…¶ä»–ä¸€åˆ‡éšæ‚£è€…æ¥è£å†³ã€‚</li><li>è§£é‡Šå‹ï¼š<br>ä¸Šé¢ä¸¤ç§ç±»å‹çš„å…³ç³»éƒ½ä¸æ˜¯äººä»¬æƒ³è¦çš„ã€‚æˆ‘ä»¬æ—¢æƒ³äº†è§£ä¿¡æ¯ï¼Œåˆéœ€è¦æŒæ§å’Œè£å†³æƒï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿéœ€è¦æŒ‡å¯¼ã€‚ä¼Šæ›¼çº½å°”å¤«å¦‡æŠŠç¬¬ä¸‰ç§åŒ»æ‚£å…³ç³»ç§°ä¸ºâ€œè§£é‡Šå‹â€å…³ç³»ã€‚åœ¨è¿™ç§å…³ç³»ä¸­ï¼ŒåŒ»ç”Ÿçš„è§’è‰²æ˜¯å¸®åŠ©ç—…äººç¡®å®šä»–ä»¬æƒ³è¦ä»€ä¹ˆã€‚<br>ä¸“å®¶æŠŠè¿™ç§æ–¹å¼ç§°ä¸ºå…±åŒå†³ç­–æ¨¡å¼</li></ul><h2 id="ODTAA-ç»¼åˆå¾ï¼ˆOne-Damn-Thing-After-AnotherSyndromeï¼Œç›´è¯‘ä¸ºâ€œè¯¥æ­»çš„äº‹ä¸€ä»¶æ¥ç€ä¸€ä»¶ç»¼åˆå¾â€ï¼‰"><a href="#ODTAA-ç»¼åˆå¾ï¼ˆOne-Damn-Thing-After-AnotherSyndromeï¼Œç›´è¯‘ä¸ºâ€œè¯¥æ­»çš„äº‹ä¸€ä»¶æ¥ç€ä¸€ä»¶ç»¼åˆå¾â€ï¼‰" class="headerlink" title="ODTAA ç»¼åˆå¾ï¼ˆOne Damn Thing After AnotherSyndromeï¼Œç›´è¯‘ä¸ºâ€œè¯¥æ­»çš„äº‹ä¸€ä»¶æ¥ç€ä¸€ä»¶ç»¼åˆå¾â€ï¼‰"></a>ODTAA ç»¼åˆå¾ï¼ˆOne Damn Thing After AnotherSyndromeï¼Œç›´è¯‘ä¸ºâ€œè¯¥æ­»çš„äº‹ä¸€ä»¶æ¥ç€ä¸€ä»¶ç»¼åˆå¾â€ï¼‰</h2><h2 id="ç†è§£ä¸ªäººç”Ÿå‘½çš„æœ‰é™æ€§"><a href="#ç†è§£ä¸ªäººç”Ÿå‘½çš„æœ‰é™æ€§" class="headerlink" title="ç†è§£ä¸ªäººç”Ÿå‘½çš„æœ‰é™æ€§"></a>ç†è§£ä¸ªäººç”Ÿå‘½çš„æœ‰é™æ€§</h2><h3 id="å‹‡æ°”"><a href="#å‹‡æ°”" class="headerlink" title="å‹‡æ°”"></a>å‹‡æ°”</h3><p>å¥¹çš„å›°éš¾ä¸æ˜¯é¢å¯¹é£é™©ç¼ºå°‘é‡‡å–è¡ŒåŠ¨çš„å‹‡æ°”ï¼Œè€Œæ˜¯å¸Œæœ›èƒ½ææ¸…æ¥šå¦‚ä½•çœ‹å¾…è¿™äº›é£é™©ã€‚å¥¹è¯´è‡ªå·±æœ€å¤§çš„ææƒ§æ˜¯å—è‹¦ã€‚è™½ç„¶åšæ‰‹æœ¯æ˜¯ä¸ºäº†å‡å°‘å¥¹çš„ç—›è‹¦ï¼Œä½†æ˜¯ï¼Œæ‰‹æœ¯ä¼šä¸ä¼šä½¿æƒ…å†µæ›´ç³Ÿè€Œä¸æ˜¯æ›´å¥½å‘¢</p><h2 id="å³°å€¼å®šå¾‹ï¼š"><a href="#å³°å€¼å®šå¾‹ï¼š" class="headerlink" title="å³°å€¼å®šå¾‹ï¼š"></a>å³°å€¼å®šå¾‹ï¼š</h2><p>â€œå³°ç»ˆå®šå¾‹â€ï¼ˆPeak-End ruleï¼‰å¯ä»¥å¾—åˆ°æœ€å¥½çš„é¢„æµ‹ï¼šåªè®¡ç®—åœ¨ä¸¤ä¸ªæ—¶åˆ»ä½“éªŒåˆ°çš„å¹³å‡ç–¼ç—›ï¼Œå³è¿‡ç¨‹ä¸­æœ€ç³Ÿç³•çš„ä¸€ä¸ªæ—¶åˆ»å’Œæœ€åæ—¶åˆ»ã€‚æ ¹æ®å¼ºåº¦æœ€å¤§çš„ç–¼ç—›æ°´å¹³å’Œæ£€æŸ¥ç»“æŸæ—¶çš„æ°´å¹³ï¼Œè€Œä¸æ˜¯æ ¹æ®ç–¼ç—›æ€»é‡ï¼Œèƒƒè‚ ç—…åŒ»ç”Ÿå¯¹äºä»–ä»¬ç»™ç—…äººé€ æˆçš„ç–¼ç—›çš„ä¼°è®¡ä¸ç—…äººè‡ªå·±çš„ä¼°è®¡éå¸¸ç›¸ä¼¼ã€‚<br>äººå¥½åƒæœ‰ä¸¤ä¸ªä¸åŒçš„è‡ªæˆ‘ï¼šä½“éªŒçš„è‡ªæˆ‘å¹³ç­‰åœ°å¿å—æ¯æ—¶æ¯åˆ»çš„ä½“éªŒï¼Œè€Œè®°å¿†çš„è‡ªæˆ‘äº‹åå‡ ä¹æŠŠå…¨éƒ¨çš„åˆ¤æ–­æƒé‡æ”¾åœ¨ä¸¤ä¸ªæ—¶åˆ»ä¸Šï¼Œå³æœ€ç³Ÿç³•çš„æ—¶åˆ»å’Œæœ€åçš„æ—¶åˆ»ã€‚å³ä¾¿åœ¨ç»“æœå¼‚å¸¸çš„æƒ…å†µä¸‹ï¼Œè®°å¿†çš„è‡ªæˆ‘ä¹Ÿä¼¼ä¹åšæŒå³°ç»ˆå®šå¾‹ã€‚å³ä¾¿åˆšåˆšç»å—äº†åŠä¸ªå¤šå°æ—¶çš„é«˜æ°´å¹³ç–¼ç—›ï¼Œåªè¦åœ¨åŒ»ç–—è¿‡ç¨‹ç»“æŸæ—¶æœ‰é‚£ä¹ˆå‡ åˆ†é’Ÿä¸ç—›ï¼Œç—…äººå¯¹æ€»ä½“ç–¼ç—›çš„è¯„ä»·å°±ä¼šæˆå‰§æ€§åœ°é™ä½ã€‚äº‹åä»–ä»¬æŠ¥å‘Šè¯´ï¼šâ€œæ²¡æœ‰é‚£ä¹ˆå¯æ€•ã€‚â€è€Œç³Ÿç³•ç»“å°¾åˆ™åŒæ ·æˆå‰§æ€§åœ°æ¨å‡ç–¼ç—›è¯„åˆ†ã€‚<br>å¤šä¸ªèƒŒæ™¯ä¸‹çš„ç ”ç©¶éƒ½è¯å®äº†å³°ç»ˆå®šå¾‹ä»¥åŠæˆ‘ä»¬å¯¹ç–¼ç—›é•¿åº¦çš„å¿½è§†ã€‚ç ”ç©¶è¿˜è¯´æ˜ï¼Œè¿™ä¸ªç°è±¡ä¹ŸåŒæ ·é€‚ç”¨äºäººä»¬å¯¹æ„‰å¿«ç»éªŒçš„è¯„ä»·ã€‚<br>ç„¶è€Œï¼Œæˆ‘ä»¬ä¹Ÿè®¤è¯†åˆ°ï¼Œä¸åº”è¯¥å¿½è§†ä½“éªŒçš„è‡ªæˆ‘â€”â€”é«˜å³°å’Œç»“å°¾å¹¶ä¸æ˜¯å”¯ä¸€é‡è¦çš„éƒ¨åˆ†ã€‚é’çæåº¦å¿«ä¹çš„æ—¶åˆ»è€Œå¿½è§†ç¨³å®šçš„å¹¸ç¦ï¼Œä»è¿™ä¸€ç‚¹æ¥è¯´ï¼Œè®°å¿†çš„è‡ªæˆ‘å¹¶éæ€»æ˜¯æ˜æ™ºçš„ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç¬”è®°æœ¬</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è¯»ä¹¦ç¬”è®°</tag>
      
      <tag>è§‚ç‚¹æ„Ÿæƒ³</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç¬¬ä¸€æ¬¡å…¨æ ˆå¼€å‘æ€»ç»“</title>
    <link href="/posts/1de4d68a/"/>
    <url>/posts/1de4d68a/</url>
    
    <content type="html"><![CDATA[<p>[toc]</p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨ 2020 å¹´ 5 æœˆï¼Œä¹Ÿå°±æ˜¯æˆ‘å‚åŠ  web å‰ç«¯å·¥ä½œçš„ç¬¬ä¸‰ä¸ªå¹´å¤´ã€‚å½“æ—¶æˆ‘åˆšç¦»èŒä¸ä¹…ï¼Œæ‰‹å¤´ä¸Šå­˜äº†ä¸€äº›é’±æƒ³ç€åšç‚¹è‡ªå·±æƒ³åšçš„äº‹ï¼Œå»ä»–å¦ˆçš„å·¥ä½œã€‚å½“æ—¶æ°é€¢ç–«æƒ…ï¼Œè¿œæ–¹è‚¯å®šæ˜¯å»ä¸äº†ï¼Œäºæ˜¯å°±å¼€å§‹å­¦ç€æ‹äº›è§†é¢‘ï¼Œè·Ÿç€ <a href="https://chinese.freecodecamp.org/learn">FreeCodeCamp</a> å­¦äº›æœåŠ¡ç«¯å¼€å‘çš„è¯¾ç¨‹ã€‚è™½ç„¶åšå¼€å‘å·¥ä½œä¸‰å¹´äº†ï¼Œä½†ä¸€ç›´åš web å‰ç«¯,å¯¹æœåŠ¡ç«¯å¼€å‘ä¸äº†è§£ï¼Œåœ¨å…¬å¸é‡Œå°±åƒæ˜¯è¢«ç”¨è°ƒç”¨çš„èµ„æºï¼Œç»™éœ€æ±‚åé¡µé¢ï¼Œåƒä¸‹è›‹æ¯é¸¡ä¸€èˆ¬(<a href="http://www.ruanyifeng.com/blog/2016/07/hen-and-front-end-engineer.html">æ¯é¸¡ä¸å‰ç«¯å·¥ç¨‹å¸ˆ</a>)</p><p>è¶ç€è‡ªç”±èº«ï¼Œå¼€å§‹ä»é›¶å¼€å§‹æ„å»ºä¸€ä¸ª web é¡¹ç›®ï¼Œå‰ç«¯å¼€å‘ç¯å¢ƒã€æœåŠ¡ç«¯å¼€å‘ç¯å¢ƒã€æ•°æ®åº“æ“ä½œã€æ¥å£å¼€å‘ã€é¡¹ç›®éƒ¨ç½²ï¼Œå…¨éƒ¨è‡ªå·±åšã€‚é¦–å…ˆå†™ä¸œè¥¿éœ€è¦åŸå‹å’ŒåŠŸèƒ½ï¼Œæˆ‘æŠŠç›®å…‰æŠ•åˆ°äº† 2018 å¹´åœ¨å…¬å¸å‚ä¸çš„ä¸€ä¸ªå†…æµ‹é¡¹ç›®<code>çŸ¥æ‹¾</code>ã€‚å½“æ—¶çš„æˆ‘åªè´Ÿè´£äº†å‰ç«¯ä¸­æŸä¸ªåŠŸèƒ½ç‚¹çš„å¼€å‘ï¼Œå¥½åœ¨è¿™ä¸ªå†…æµ‹åœ°å€è¿˜èƒ½è®¿é—®ï¼Œé‚£æˆ‘ä¾¿æ ¹æ®å®ƒç…§çŒ«ç”»è™å‡ºæ¥ä¸€ä¸ªè‡ªå·±çš„ <a href="https://www.frmachao.top/datum">çŸ¥æ‹¾</a></p><h2 id="çŸ¥æ‹¾"><a href="#çŸ¥æ‹¾" class="headerlink" title="çŸ¥æ‹¾"></a>çŸ¥æ‹¾</h2><blockquote><p>çŸ¥æ‹¾æ˜¯ä¸€ä¸ªä¸ªäººçŸ¥è¯†åº“ï¼Œæä¾›ä¸€å¥—æ–¹ä¾¿å¿«æ·çš„è®°å½•å’Œç®¡ç†çŸ¥è¯†çš„å·¥å…·ï¼Œè®©æ¯ä¸ªäººè®°å½•è‡ªå·±è®¤ä¸ºæœ‰ç”¨çš„çŸ¥è¯†ã€‚</p></blockquote><ul><li>çŸ¥è¯†åº“é‡Œé¢è®°å½•çš„å¤§éƒ¨åˆ†çŸ¥è¯†éƒ½æ˜¯å…¬å¼€å…±äº«çš„ã€‚</li><li>å¤§å®¶å¯ä»¥é€šè¿‡çŸ¥è¯†åº“è·å¾—å…¶ä»–äººè®¤ä¸ºæœ‰ç”¨çš„çŸ¥è¯†ã€‚</li><li>é€šè¿‡æœç´¢åŠŸèƒ½ï¼ŒçŸ¥è¯†åº“å¸Œæœ›å¯ä»¥æä¾›ä¸€ä¸ªçº¯å‡€çš„çŸ¥è¯†èµ„æºçš„å¿«é€Ÿå¯¼èˆªã€‚</li><li>çŸ¥è¯†åº“å°†ä¼šæä¾›ç¾¤ç»„åŠŸèƒ½ï¼Œè®©ä½ å’Œä½ çš„å°ä¼™ä¼´åˆ†äº«å’Œç®¡ç†äº’ç›¸æ„Ÿå…´è¶£çš„çŸ¥è¯†ã€‚</li><li>æƒé™æ§åˆ¶<ul><li>ç”¨æˆ·å‘å¸ƒçš„æ–‡ç« æœ‰ä¸¤ç§ï¼šéå…¬å¼€æ–‡ç«  ä¸å…¬å¼€æ–‡ç«  éå…¬å¼€æ–‡ç«  åªæœ‰ä½ å’Œæ‰€å±å°ç»„èƒ½çœ‹åˆ°è¯¥æ–‡ç« ã€‚ä½ å¦‚æœæŠŠè¯¥æ–‡ç« ç½‘å€å‘ç»™å…¶ä»–äººï¼Œæœ‰ç½‘å€çš„äººä¹Ÿèƒ½çœ‹åˆ°</li><li>å°ç»„æœ‰ä¸¤ç§: å…¬å¼€å°ç»„ ã€ç§å¯†å°ç»„ã€ ç§å¯†å°ç»„çš„åå­—ã€ç®€ä»‹ã€æˆå‘˜åˆ—è¡¨å’Œå…¶ä»–éƒ½æ˜¯ç§å¯†ä¿¡æ¯ï¼Œç§å¯†å°ç»„å‘å¸ƒçš„æ–‡ç« åªèƒ½ç”±å½“å‰å°ç»„æˆå‘˜çœ‹åˆ°ï¼Œç§å¯†å°ç»„æ— æ³•å‘å¸ƒå…¬å¼€æ–‡ç« ã€‚ å°ç»„åˆ›å»ºä»¥åï¼Œå…¶å…¬å¼€ç§å¯†çŠ¶æ€å°†å›ºå®šæ— æ³•ä¿®æ”¹</li></ul></li><li>çŸ¥æ‹¾è¯„è®ºåŠŸèƒ½<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2021-11-03-ehmddn.png" alt="2021-11-03-ehmddn"></li></ul><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2021-11-03-LqMt5M.png" alt="2021-11-03-LqMt5M"></p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2021-11-03-fHCW8f.png" alt="2021-11-03-fHCW8f"></p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2021-11-03-qOMSzN.png" alt="2021-11-03-qOMSzN"></p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/zpqm2H.png" alt="zpqm2H"></p><h2 id="æŠ€æœ¯é€‰å‹"><a href="#æŠ€æœ¯é€‰å‹" class="headerlink" title="æŠ€æœ¯é€‰å‹"></a>æŠ€æœ¯é€‰å‹</h2><h3 id="å‰ç«¯"><a href="#å‰ç«¯" class="headerlink" title="å‰ç«¯"></a>å‰ç«¯</h3><blockquote><p>React æŠ€æœ¯æ ˆ</p></blockquote><p><code>Typescript + React hooks + Mobx</code> ç¼–å†™å‰ç«¯åº”ç”¨</p><h3 id="åç«¯"><a href="#åç«¯" class="headerlink" title="åç«¯"></a>åç«¯</h3><blockquote><p>Node.jsã€Expressã€GraphQLã€MongoDB</p></blockquote><p>å› ä¸ºæ˜¯å‰ç«¯å‡ºèº«å¯¹<code>javascript</code>è¯­è¨€æ¯”è¾ƒç†Ÿæ‚‰ï¼ŒæœåŠ¡ç«¯å¼€å‘å°±é€‰æ‹©äº†<code>node.js</code> ç›¸å…³çš„æŠ€æœ¯ã€‚é€‰æ‹©<code>GraphQL</code>æ¥å£é£æ ¼ï¼Œä¹Ÿæ˜¯å‡ºäºå¯¹å‰ç«¯è°ƒç”¨å‹å¥½ã€‚MongoDBï¼Œé¢è¿™ä¸ªæ˜¯å› ä¸º è·Ÿç€<a href="https://chinese.freecodecamp.org/learn/back-end-development-and-apis/">FCC çš„ node.js è¯¾ç¨‹å­¦ä¹ </a>æ—¶ï¼Œé‡Œé¢æ•™çš„æ•°æ®åº“å°±æ˜¯å®ƒã€‚</p><p>å¥½å§ï¼Œæˆ‘å¥½æ‡’ï¼Œä¸è‚¯å¤šèŠ±æ—¶é—´å­¦ä¸€é—¨æ­£ç»çš„æœåŠ¡ç«¯ç¼–ç¨‹è¯­è¨€â€¦.</p><ul><li><a href="https://blog.frmachao.top/posts/62bfed46/">ç½‘ç«™è¯„è®ºæ¨¡å— mongodb å­—æ®µè®¾è®¡åŠå®ç° </a></li></ul><h2 id="æ­å»ºå¼€å‘ç¯å¢ƒ"><a href="#æ­å»ºå¼€å‘ç¯å¢ƒ" class="headerlink" title="æ­å»ºå¼€å‘ç¯å¢ƒ"></a>æ­å»ºå¼€å‘ç¯å¢ƒ</h2><h3 id="éœ€æ±‚ï¼š"><a href="#éœ€æ±‚ï¼š" class="headerlink" title="éœ€æ±‚ï¼š"></a>éœ€æ±‚ï¼š</h3><ul><li>å‰ç«¯æ”¯æŒ<code>React</code>å¤šé¡µé¢æ„å»ºä»¥åŠå•é¡µé¢æ„å»ºï¼Œæ”¯æŒå‘½ä»¤è¡Œå‚æ•°</li><li>æœåŠ¡ç«¯é›†æˆ<code>express mongodb graphql</code> å¿«é€Ÿå¼€å§‹å¼€å‘ æ”¯æŒ <code>TypeScript</code> ç¼–å†™</li><li>æ‰¹é‡æ„å»º</li><li>å¤šé¡µé¢ç½‘ç«™ é›†åˆæœåŠ¡ç«¯æ¨¡æ¿</li><li>æ·»åŠ  eslintã€prettier ä»£ç é£æ ¼çº¦æŸ</li></ul><h3 id="å·¥ç¨‹ç›®å½•"><a href="#å·¥ç¨‹ç›®å½•" class="headerlink" title="å·¥ç¨‹ç›®å½•:"></a>å·¥ç¨‹ç›®å½•:</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs bash">|--<br>    |--build<br>    |--dist å‰ç«¯æ‰“åŒ…åçš„èµ„æºæ²¡æœ‰`html`æ–‡ä»¶ï¼Œ`html`äº¤ç»™æœåŠ¡ç«¯å¤„ç†<br>        |--mpa<br>            |--page1<br>            |--page2<br>        |--spa1<br>        |--xxx<br>    |--server ç½‘ç«™åç«¯<br>        |--src<br>            |--middlewares<br>            |--controllers<br>            |--models<br>            |--app.ts<br>        |--public<br>        |--view<br>    |--site ç½‘ç«™å‰ç«¯<br>        |--mpa å¤šé¡µé¢åº”ç”¨èµ„æºç›®å½•<br>            |--page1<br>            |--page2<br>        |--spa1<br>        |--spa2<br>        |--xxxx<br></code></pre></td></tr></table></figure><h3 id="å…·ä½“ä»£ç ï¼š"><a href="#å…·ä½“ä»£ç ï¼š" class="headerlink" title="å…·ä½“ä»£ç ï¼š"></a>å…·ä½“ä»£ç ï¼š</h3><p><a href="https://github.com/frmachao/webpack-examples">https://github.com/frmachao/webpack-examples</a></p><h3 id="Tips"><a href="#Tips" class="headerlink" title="Tips:"></a>Tips:</h3><p><code>çŸ¥æ‹¾</code>æ˜¯<a href="https://www.frmachao.top/">frmachao.top</a> ç½‘ç«™é‡Œçš„ä¸€ä¸ªåº”ç”¨ï¼Œå½“æ—¶æˆ‘çš„æƒ³æ³•æ˜¯åšä¸€ä¸ªç»¼åˆç«™ç‚¹ï¼ŒæŠŠ web å¼€å‘ä¸­å¸¸ç”¨çš„ä¸œè¥¿éƒ½ç”¨ä¸Šã€‚<br>ç½‘ç«™çš„å¤§ä½“ç»“æ„ï¼š</p><ul><li>å¤´éƒ¨<ul><li>ç”±æœåŠ¡å™¨é™æ€æ¨¡æ¿ç¼–å†™ï¼šå¤´éƒ¨ã€å¯¼èˆªæ ã€ç™»å½•ã€æ³¨å†Œ</li></ul></li><li>å†…å®¹åŒºåŸŸ<ul><li>ç”±å•é¡µé¢åº”ç”¨æ¥å¡«å…… æœåŠ¡ç«¯æ ¹æ®è·¯ç”±åŠ¨æ€æ‹¼æ¥å¥½å•é¡µé¢åº”ç”¨éœ€è¦çš„èµ„æº</li></ul></li></ul><h2 id="é¡¹ç›®éƒ¨ç½²"><a href="#é¡¹ç›®éƒ¨ç½²" class="headerlink" title="é¡¹ç›®éƒ¨ç½²"></a>é¡¹ç›®éƒ¨ç½²</h2><blockquote><p>pm2 + shell</p></blockquote><p>æˆ‘åœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨: åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª <code>pm2_start.sh</code> æ–‡ä»¶ï¼Œæ¯æ¬¡æäº¤åé¡¹ç›®åï¼Œåœ¨æœåŠ¡å™¨ç¯å¢ƒä¸­æ‰§è¡Œ <code>sh pm2_start.sh</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;æ‹‰å–gitä»“åº“&quot;</span><br>git pull<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;å®‰è£…å‰ç«¯é¡¹ç›®ä¾èµ–&quot;</span><br>npm i --unsafe-perm<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;å®‰è£…åç«¯é¡¹ç›®ä¾èµ–&quot;</span><br><span class="hljs-built_in">cd</span> server/ &amp;&amp; npm i --unsafe-perm<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;æ„å»ºå‰ç«¯&quot;</span><br><span class="hljs-built_in">cd</span> ../ &amp;&amp; npm run build --unsafe-perm<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;æ„å»ºåç«¯&quot;</span><br><span class="hljs-built_in">cd</span> server &amp;&amp; npm run build --unsafe-perm<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;æ€æ‰æ‰€æœ‰pm2&quot;</span><br>pm2 <span class="hljs-built_in">kill</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;pm2 å¯åŠ¨ node ç¨‹åº&quot;</span><br>NODE_ENV=production pm2 start dist/app.js<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;è®¾ç½® centos å¼€æœºå¯åŠ¨ pm2&quot;</span><br>pm2 startup<br>pm2 save<br></code></pre></td></tr></table></figure><ul><li><a href="https://blog.frmachao.top/posts/7c957dfb/">è®°å½• react+node+mongodb é¡¹ç›®éƒ¨ç½²åˆ°æœåŠ¡å™¨çš„è¿‡ç¨‹</a></li></ul><h2 id="å­¦åˆ°äº†ä»€ä¹ˆ"><a href="#å­¦åˆ°äº†ä»€ä¹ˆ" class="headerlink" title="å­¦åˆ°äº†ä»€ä¹ˆ"></a>å­¦åˆ°äº†ä»€ä¹ˆ</h2><ol><li>ç†Ÿæ‚‰äº† <code>Expressã€MongoDBã€GraphQL</code>ï¼Œé’ˆå¯¹éœ€æ±‚å¯ä»¥åšåˆ°ç®€å•çš„æ•°æ®åº“è®¾è®¡ã€æ¥å£çš„å¼€å‘ä¸è®¾è®¡ã€‚</li><li>ç†Ÿç»ƒä½¿ç”¨ <code>Webpack ã€Gulp</code>ç­‰å·¥å…·ï¼Œå¯¹è„šæ‰‹æ¶åŠŸèƒ½è¿›è¡Œå®šåˆ¶ã€‚</li><li>å­¦ä¹ äº†æœåŠ¡å™¨éƒ¨ç½²ã€<code>Nginx</code>æœåŠ¡å™¨çš„ä½¿ç”¨ã€å’Œå¸¸ç”¨çš„ä¸€äº› <code>Linux</code> å‘½ä»¤ã€‚</li></ol>]]></content>
    
    
    <categories>
      
      <category>ä»£ç äººç”Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è®°å½•</tag>
      
      <tag>å…¨æ ˆå¼€å‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>é…ç½®é˜¿é‡Œäº‘è½»é‡åº”ç”¨æœåŠ¡å™¨å®ç°å…¨ç«™HTTPSè®¿é—®</title>
    <link href="/posts/6d9a362d/"/>
    <url>/posts/6d9a362d/</url>
    
    <content type="html"><![CDATA[<p>[toc]</p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‰æ®µæ—¶é—´ï¼Œæˆ‘å†™äº†ä¸€ä¸ªåŸºäº<code>React</code>+<code>Express</code>+<code>MongoDB</code>çš„ä¸ªäººç½‘ç«™ <a href="http://www.frmachao.top/">www.frmachao.top</a>ï¼Œç°åœ¨è¦ç»™å®ƒåŠ ä¸Š <code>ssl</code> è¯ä¹¦ï¼Œæ¥å®ç°å…¨ç«™<code>https</code>è®¿é—®ã€‚</p><h2 id="è¯ä¹¦"><a href="#è¯ä¹¦" class="headerlink" title="è¯ä¹¦"></a>è¯ä¹¦</h2><h3 id="è´­ä¹°å…è´¹çš„è¯ä¹¦æœåŠ¡"><a href="#è´­ä¹°å…è´¹çš„è¯ä¹¦æœåŠ¡" class="headerlink" title="è´­ä¹°å…è´¹çš„è¯ä¹¦æœåŠ¡"></a>è´­ä¹°å…è´¹çš„è¯ä¹¦æœåŠ¡</h3><p><a href="https://common-buy.aliyun.com/?spm=5176.13785142.commonbuy2container.9.79e8778bjBRbjJ&commodityCode=cas_dv_public_cn&request=%7B%22ord_time%22:%221:Year%22,%22order_num%22:1,%22product%22:%22free_product%22,%22certCount%22:%2220%22%7D">é˜¿é‡Œäº‘ç›¾è¯ä¹¦æœåŠ¡</a></p><blockquote><p>æ³¨æ„ï¼š å•åŸŸåè¡¨ç¤ºè¦ç”³è¯·çš„è¯ä¹¦ç”¨äºç»‘å®š1ä¸ªå…·ä½“åŸŸåï¼ˆä¾‹å¦‚ï¼Œåªç»‘å®š<a href="http://www.frmachao.top)/">www.frmachao.topï¼‰</a></p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/D0z6dz.png" alt="D0z6dz"></p><h3 id="åˆ›å»ºè¯ä¹¦å¹¶è¿›è¡Œè¯ä¹¦ç”³è¯·æ“ä½œ"><a href="#åˆ›å»ºè¯ä¹¦å¹¶è¿›è¡Œè¯ä¹¦ç”³è¯·æ“ä½œ" class="headerlink" title="åˆ›å»ºè¯ä¹¦å¹¶è¿›è¡Œè¯ä¹¦ç”³è¯·æ“ä½œ"></a>åˆ›å»ºè¯ä¹¦å¹¶è¿›è¡Œè¯ä¹¦ç”³è¯·æ“ä½œ</h3><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/gj1Mp8.png" alt="gj1Mp8"></p><h3 id="å¡«å†™ç”³è¯·ä¿¡æ¯-å¹¶éªŒè¯-DNS-ä¿¡æ¯"><a href="#å¡«å†™ç”³è¯·ä¿¡æ¯-å¹¶éªŒè¯-DNS-ä¿¡æ¯" class="headerlink" title="å¡«å†™ç”³è¯·ä¿¡æ¯ å¹¶éªŒè¯ DNS ä¿¡æ¯"></a>å¡«å†™ç”³è¯·ä¿¡æ¯ å¹¶éªŒè¯ DNS ä¿¡æ¯</h3><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/DdJecL.png" alt="DdJecL"></p><blockquote><p>æ³¨æ„ï¼šåŸŸåéªŒè¯è®°å½•è¦åœ¨è¯ä¹¦ç­¾å‘åå†åˆ é™¤ï¼Œå¦åˆ™å› ä¸ºæ²¡æœ‰è§£æè®°å½•å¯¼è‡´è¯ä¹¦ç­¾å‘å¤±è´¥</p></blockquote><p>ä¸»æœºè®°å½•å€¼<code>_dnsauth</code> å°±æ˜¯ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„ åŸŸåéªŒè¯è®°å½• ï¼Œå› ä¸ºè¿™é‡Œæˆ‘çš„åŸŸåä¹Ÿæ˜¯åœ¨é˜¿é‡Œäº‘è§£æçš„ï¼Œå¦‚æœä½ æ˜¯å…¶ä»– DNS æœåŠ¡å•†è§£æçš„ï¼Œéœ€è¦è‡ªå·±æ·»åŠ ä¸€æ¡è¿™æ ·çš„åŸŸåè®°å½•<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/DJ0NyK.png" alt="DJ0NyK"></p><h2 id="æ­å»ºFTPæœåŠ¡å™¨"><a href="#æ­å»ºFTPæœåŠ¡å™¨" class="headerlink" title="æ­å»ºFTPæœåŠ¡å™¨"></a>æ­å»ºFTPæœåŠ¡å™¨</h2><blockquote><p>å‚è€ƒï¼š<a href="https://help.aliyun.com/document_detail/60152.html">é˜¿é‡Œäº‘æ–‡æ¡£</a></p></blockquote><p>Q:ä¸ºä»€ä¹ˆè¦æ­å»ºFTPæœåŠ¡å™¨<br>A:å› ä¸ºè¦ä¸Šä¼ è¯ä¹¦åˆ°æœåŠ¡å™¨,å¯èƒ½æœ‰å…¶ä»–æ–¹å¼ä¸Šä¼ ï¼Œä½†æ˜¯å›¾å½¢ç•Œé¢æ›´ç›´è§‚äº›ã€‚</p><h3 id="è¡¥å……å¸¸ç”¨å‘½ä»¤"><a href="#è¡¥å……å¸¸ç”¨å‘½ä»¤" class="headerlink" title="è¡¥å……å¸¸ç”¨å‘½ä»¤"></a>è¡¥å……å¸¸ç”¨å‘½ä»¤</h3><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs dsconfig">å¯åŠ¨æœåŠ¡ï¼š<span class="hljs-string">systemctl</span> <span class="hljs-string">start</span> <span class="hljs-string">vsftpd</span>.<span class="hljs-string">service</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span>å…³é—­æœåŠ¡ï¼š<span class="hljs-string">systemctl</span> <span class="hljs-string">stop</span> <span class="hljs-string">vsftpd</span>.<span class="hljs-string">service</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span>é‡å¯æœåŠ¡ï¼š<span class="hljs-string">systemctl</span> <span class="hljs-string">restart</span> <span class="hljs-string">vsftpd</span>.<span class="hljs-string">service</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span>æ˜¾ç¤ºæœåŠ¡çš„çŠ¶æ€ï¼š<span class="hljs-string">systemctl</span> <span class="hljs-string">status</span> <span class="hljs-string">vsftpd</span>.<span class="hljs-string">service</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span>åœ¨å¼€æœºæ—¶å¯ç”¨æœåŠ¡ï¼š<span class="hljs-string">systemctl</span> <span class="hljs-string">enable</span> <span class="hljs-string">vsftpd</span>.<span class="hljs-string">service</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span>åœ¨å¼€æœºæ—¶ç¦ç”¨æœåŠ¡ï¼š<span class="hljs-string">systemctl</span> <span class="hljs-string">disable</span> <span class="hljs-string">vsftpd</span>.<span class="hljs-string">service</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span>æŸ¥çœ‹æœåŠ¡æ˜¯å¦å¼€æœºå¯åŠ¨ï¼š<span class="hljs-string">systemctl</span> <span class="hljs-string">is-enabled</span> <span class="hljs-string">vsftpd</span>.<span class="hljs-string">service</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span>æŸ¥çœ‹å·²å¯åŠ¨çš„æœåŠ¡åˆ—è¡¨ï¼š<span class="hljs-string">systemctl</span> <span class="hljs-built_in">list-unit-files|grep</span> <span class="hljs-string">enabled</span><br><span class="hljs-string"></span><br><span class="hljs-string"></span>æŸ¥çœ‹å¯åŠ¨å¤±è´¥çš„æœåŠ¡åˆ—è¡¨ï¼š<span class="hljs-string">systemctl</span> <span class="hljs-built_in">--failed</span><br></code></pre></td></tr></table></figure><h3 id="é‡åˆ°çš„é—®é¢˜ï¼š"><a href="#é‡åˆ°çš„é—®é¢˜ï¼š" class="headerlink" title="é‡åˆ°çš„é—®é¢˜ï¼š"></a>é‡åˆ°çš„é—®é¢˜ï¼š</h3><ol><li>FileZillaå®¢æˆ·ç«¯ è¿æ¥æ—¶çš„åŠ å¯†æ–¹å¼â€¦.. å¡äº†æˆ‘åŠå¤©<br>ä½¿ç”¨æ–‡æ¡£æˆªå›¾ä¸­è¿æ¥çš„åŠ å¯†æ–¹å¼æ—¶ï¼Œä¸€ç›´æç¤ºè¿æ¥è¶…æ—¶ï¼Œæˆ‘ä»¥ä¸ºæ˜¯é…ç½®çš„FTPæœåŠ¡å™¨æœ‰é—®é¢˜ï¼Œå¯¹ç€æ–‡æ¡£åå¤èµ°å‡ éæŠ˜è…¾äº† ä¸€ä¸ªå°æ—¶ï¼Œæœ€åè¯•äº†è¯•é€‰æ‹©æ˜æ–‡è¿æ¥ï¼Œç»“æœç›´æ¥æˆåŠŸäº†</li></ol><p>ğŸ˜­åªè¦æ²¡æ–‡åŒ– å¤„å¤„æ˜¯é­”æ³•<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2YSLJ1.jpg" alt="2YSLJ1"></p><h2 id="centos-7-å®‰è£…-nginx-ssl-æ¨¡å—"><a href="#centos-7-å®‰è£…-nginx-ssl-æ¨¡å—" class="headerlink" title="centos 7 å®‰è£… nginx + ssl æ¨¡å—"></a>centos 7 å®‰è£… nginx + ssl æ¨¡å—</h2><p>æˆ‘è´­ä¹°æ˜¯é˜¿é‡Œäº‘è½»é‡åº”ç”¨æœåŠ¡å™¨ CentOS 7 çš„é•œåƒ<br>ä¸€å¼€å§‹æˆ‘ç›´æ¥ä½¿ç”¨yumæ–¹å¼å®‰è£…çš„ngninxï¼Œä½†æ˜¯è¿™ç§æ–¹å¼å®‰è£…çš„ngninxé»˜è®¤æ˜¯ä¸æ”¯æŒsslçš„ï¼Œæ‰€ä»¥éœ€è¦ä»ä»£ç ç¼–è¯‘å®‰è£…Nginx</p><p>å‚è€ƒ:</p><ol><li><a href="https://www.cnblogs.com/nickchou/p/12978724.html">centos 7 æºç æ–¹å¼å®‰è£…nginx(1.18.0) + ssl + é˜¿é‡Œè¯ä¹¦é…ç½®</a></li></ol><h3 id="æºç å®‰è£…-Nginx"><a href="#æºç å®‰è£…-Nginx" class="headerlink" title="æºç å®‰è£… Nginx"></a>æºç å®‰è£… Nginx</h3><p>é‡åˆ°çš„é—®é¢˜ï¼š</p><ol><li>CentOS7ä¸­æ·»åŠ ç¯å¢ƒå˜é‡åç«‹å³ç”Ÿæ•ˆï¼Œä½†æ˜¯é‡å¯æœåŠ¡å™¨åˆå¤±æ•ˆ</li></ol><p>åŸå› ï¼šæ·»åŠ ç¯å¢ƒå˜é‡åˆ° /etc/profileæ–‡ä»¶<br>source /etc/profile ä½¿é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ<br>å‚è€ƒï¼š<a href="https://blog.csdn.net/lxw1844912514/article/details/108547340">CentOS7ä¸­æ·»åŠ ç¯å¢ƒå˜é‡åç«‹å³ç”Ÿæ•ˆï¼Œä½†æ˜¯é‡å¯æœåŠ¡å™¨åˆå¤±æ•ˆ</a></p><h3 id="æ£€æŸ¥æ˜¯å¦å·²ç»å«æœ‰-ssl-æ¨¡å—"><a href="#æ£€æŸ¥æ˜¯å¦å·²ç»å«æœ‰-ssl-æ¨¡å—" class="headerlink" title="æ£€æŸ¥æ˜¯å¦å·²ç»å«æœ‰ ssl æ¨¡å—"></a>æ£€æŸ¥æ˜¯å¦å·²ç»å«æœ‰ ssl æ¨¡å—</h3><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">nginx -V</span><br></code></pre></td></tr></table></figure><p>çœ‹åˆ°è¾“å‡ºé‡Œ å«æœ‰ <code>--with-http_ssl_module</code> æ˜å°±æ˜¯å¸¦sslå‚æ•°ç¼–è¯‘çš„</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">nginx</span> version: nginx/<span class="hljs-number">1</span>.<span class="hljs-number">20</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">built</span> by gcc <span class="hljs-number">4</span>.<span class="hljs-number">8</span>.<span class="hljs-number">5</span> <span class="hljs-number">20150623</span> (Red Hat <span class="hljs-number">4</span>.<span class="hljs-number">8</span>.<span class="hljs-number">5</span>-<span class="hljs-number">44</span>) (GCC) <br><span class="hljs-attribute">built</span> with OpenSSL <span class="hljs-number">1</span>.<span class="hljs-number">0</span>.<span class="hljs-number">2</span>k-fips  <span class="hljs-number">26</span> Jan <span class="hljs-number">2017</span><br><span class="hljs-attribute">TLS</span> SNI support enabled<br><span class="hljs-attribute">configure</span> arguments: --prefix=/usr/local/nginx --with-threads --with-http_realip_module --with-http_stub_status_module --with-http_gzip_static_module --with-http_ssl_module<br></code></pre></td></tr></table></figure><h3 id="åœ¨NginxæœåŠ¡å™¨ä¸Šå®‰è£…sslè¯ä¹¦"><a href="#åœ¨NginxæœåŠ¡å™¨ä¸Šå®‰è£…sslè¯ä¹¦" class="headerlink" title="åœ¨NginxæœåŠ¡å™¨ä¸Šå®‰è£…sslè¯ä¹¦"></a>åœ¨NginxæœåŠ¡å™¨ä¸Šå®‰è£…sslè¯ä¹¦</h3><blockquote><p>å‚è€ƒï¼š <a href="https://help.aliyun.com/document_detail/98728.html#title-0np-hxn-v02">åœ¨Nginxï¼ˆæˆ–Tengineï¼‰æœåŠ¡å™¨ä¸Šå®‰è£…è¯ä¹¦</a></p></blockquote><h2 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h2><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/OAbHnZ.png" alt="OAbHnZ"></p><h2 id="END"><a href="#END" class="headerlink" title="END"></a>END</h2><p>å­¦ä¹ åˆ°çš„linuxå‘½ä»¤</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">mv</span>  <span class="hljs-comment"># ç§»åŠ¨æ–‡ä»¶/ç›®å½•</span><br><span class="hljs-built_in">cp</span>  <span class="hljs-comment"># å¤åˆ¶æ–‡ä»¶/ç›®å½•</span><br>touch <span class="hljs-comment"># ç”¨äºä¿®æ”¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æ—¶é—´å±æ€§ï¼Œè‹¥æ–‡ä»¶ä¸å­˜åœ¨ä¼šæ–°å»ºä¸€ä¸ª</span><br>mkdir <span class="hljs-comment"># åˆ›å»ºç›®å½•</span><br>ln   <span class="hljs-comment"># ç±»ä¼¼windows ä¸­çš„å¿«æ·æ–¹å¼ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦å‘½ä»¤ï¼Œå®ƒçš„åŠŸèƒ½æ˜¯ä¸ºæŸä¸€ä¸ªæ–‡ä»¶åœ¨å¦å¤–ä¸€ä¸ªä½ç½®å»ºç«‹ä¸€ä¸ªåŒæ­¥çš„é“¾æ¥ã€‚</span><br></code></pre></td></tr></table></figure><p>linux ä¸­çš„å‡ ç§é…ç½®ç¯å¢ƒå˜é‡çš„æ–‡ä»¶ç›®å½•</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/etc/</span>bashrc <br><span class="hljs-regexp">/etc/</span>profile<br><span class="hljs-regexp">/etc/</span>sudoers<br></code></pre></td></tr></table></figure><h2 id="å¦ä¸€ç§æ–¹æ¡ˆ-Letâ€™s-Encrypt"><a href="#å¦ä¸€ç§æ–¹æ¡ˆ-Letâ€™s-Encrypt" class="headerlink" title="å¦ä¸€ç§æ–¹æ¡ˆ: Letâ€™s Encrypt"></a>å¦ä¸€ç§æ–¹æ¡ˆ: <a href="https://letsencrypt.org/zh-cn/about/">Letâ€™s Encrypt</a></h2><blockquote><p>Letâ€™s Encrypt æ˜¯ä¸€å®¶å…è´¹ã€å¼€æ”¾ã€è‡ªåŠ¨åŒ–çš„è¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰ï¼Œä¸ºå…¬ä¼—çš„åˆ©ç›Šè€Œè¿è¡Œã€‚å®ƒæ˜¯ä¸€é¡¹ç”± Internet Security Research Groupï¼ˆISRGï¼‰æä¾›çš„æœåŠ¡ã€‚</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>ä»£ç äººç”Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æœåŠ¡å™¨</tag>
      
      <tag>https</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç½‘ç«™è¯„è®ºæ¨¡å— mongodb å­—æ®µè®¾è®¡åŠå®ç°</title>
    <link href="/posts/62bfed46/"/>
    <url>/posts/62bfed46/</url>
    
    <content type="html"><![CDATA[<p>[toc]</p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>å‰æ®µæ—¶é—´ï¼Œæˆ‘å†™äº†ä¸€ä¸ªåŸºäº<code>React+Express+MongoDB</code>çš„ä¸ªäººç½‘ç«™ã€‚<a href="http://101.132.140.62/">http://101.132.140.62/</a>ï¼Œç½‘ç«™ä¸Šæœ‰ä¸ªå«åš <a href="http://101.132.140.62/datum">çŸ¥æ‹¾</a> çš„å•é¡µé¢åº”ç”¨ï¼Œå®ƒä¸»è¦æ˜¯ä¸€ä¸ªçŸ¥è¯†åº“ç±»å‹çš„åº”ç”¨ï¼Œäººäººéƒ½å¯ä»¥å¾€é‡Œé¢è®°å½•è‡ªå·±è®¤ä¸ºæœ‰ç”¨çš„çŸ¥è¯†ã€‚</p><blockquote><p>ç°åœ¨æˆ‘æƒ³è¦æ·»åŠ å¯¹çŸ¥è¯†çš„è¯„è®ºåŠŸèƒ½</p></blockquote><h2 id="é¡¹ç›®å¼€å‘ç¯å¢ƒ"><a href="#é¡¹ç›®å¼€å‘ç¯å¢ƒ" class="headerlink" title="é¡¹ç›®å¼€å‘ç¯å¢ƒ"></a>é¡¹ç›®å¼€å‘ç¯å¢ƒ</h2><ul><li>MongoDB 4.4.8</li><li>Express 4.17.1</li><li>React 16.13.1</li></ul><h2 id="çŸ¥æ‹¾åº”ç”¨è¯„è®ºåŒºçš„åŠŸèƒ½"><a href="#çŸ¥æ‹¾åº”ç”¨è¯„è®ºåŒºçš„åŠŸèƒ½" class="headerlink" title="çŸ¥æ‹¾åº”ç”¨è¯„è®ºåŒºçš„åŠŸèƒ½"></a>çŸ¥æ‹¾åº”ç”¨è¯„è®ºåŒºçš„åŠŸèƒ½</h2><ul><li>æ”¯æŒåµŒå¥—è¯„è®ºï¼Œæœ€å¤§æ·±åº¦2å±‚</li><li>æ”¯æŒç²¾ç®€ç‰ˆçš„ markdown è¯­æ³•<ul><li>é‚£ä¹ˆè¯„è®ºæäº¤çš„åº”è¯¥æ˜¯html è€Œä¸æ˜¯ textï¼Œ(ä¸æ”¯æŒç¼–è¾‘)</li></ul></li><li>è¯„è®ºåªèƒ½åˆ é™¤ä¸èƒ½ä¿®æ”¹</li><li>è¯„è®ºåº”è¯¥æ”¯æŒåˆ†é¡µ<ul><li>å­è¯„è®ºä¹Ÿè¦æ”¯æŒåˆ†é¡µ</li></ul></li><li>å¢åŠ æ–°è¯„è®ºæ—¶é‚®ä»¶é€šçŸ¥ <code>çŸ¥è¯†ä½œè€…</code> æˆ–è€… <code>è¢«å›å¤äºº</code></li></ul><blockquote><p>å‚è€ƒ B ç«™è¯„è®ºåŒº</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/FTZrwc.png" alt="FTZrwc"><br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/haVB0N.png" alt="haVB0N"></p><h2 id="æ•°æ®åº“å­—æ®µè®¾è®¡"><a href="#æ•°æ®åº“å­—æ®µè®¾è®¡" class="headerlink" title="æ•°æ®åº“å­—æ®µè®¾è®¡"></a>æ•°æ®åº“å­—æ®µè®¾è®¡</h2><p>å¦‚å›¾æ‰€ç¤ºï¼š<code>Articleã€ Comment ã€User</code> ä¸‰ä¸ªé›†åˆï¼Œé€šè¿‡MongoDB çš„ ref å°†ä¸‰ä¸ªé›†åˆå…³è”èµ·æ¥ã€‚<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/g2V5mw.png" alt="g2V5mw"></p><h3 id="å¯¹åº”åˆ°-Mongoose-ä¸­çš„è¯„è®ºæ¨¡å‹"><a href="#å¯¹åº”åˆ°-Mongoose-ä¸­çš„è¯„è®ºæ¨¡å‹" class="headerlink" title="å¯¹åº”åˆ° Mongoose ä¸­çš„è¯„è®ºæ¨¡å‹"></a>å¯¹åº”åˆ° Mongoose ä¸­çš„è¯„è®ºæ¨¡å‹</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> CommentSchema = <span class="hljs-keyword">new</span> mongoose.Schema(&#123;<br>    <span class="hljs-comment">// è¯„è®ºæ‰€åœ¨çš„æ–‡ç«  id å…³è” Article é›†åˆ</span><br>    datumID: &#123; <span class="hljs-attr">type</span>: mongoose.Schema.Types.ObjectId, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> &#125;,<br>    html: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">validate</span>: <span class="hljs-regexp">/\S+/</span> &#125;,<br>    <span class="hljs-comment">//é¢„ç•™å­—æ®µ è¢«èµæ•°</span><br>    likes: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">Number</span>, <span class="hljs-attr">default</span>: <span class="hljs-number">0</span> &#125;,<br>    <span class="hljs-comment">//é¢„ç•™å­—æ®µ è¢«è¸©æ•°</span><br>    unlikes: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">Number</span>, <span class="hljs-attr">default</span>: <span class="hljs-number">0</span> &#125;,<br>    <span class="hljs-comment">// è¯„è®ºä½œè€…ä¿¡æ¯ å…³è” User é›†åˆ</span><br>    author: &#123;<br>        user: &#123; <span class="hljs-attr">type</span>: mongoose.Schema.Types.ObjectId, <span class="hljs-attr">ref</span>: <span class="hljs-string">&quot;User&quot;</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> &#125;,<br>        role: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">default</span>: <span class="hljs-string">&quot;normal&quot;</span> &#125;, <span class="hljs-comment">// author|normal</span><br>    &#125;,<br>    <span class="hljs-comment">// åˆ›å»ºæ—¥æœŸ</span><br>    create_time: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">Date</span>, <span class="hljs-attr">default</span>: <span class="hljs-built_in">Date</span>.now &#125;,<br>    <span class="hljs-comment">// æœ€åä¿®æ”¹æ—¥æœŸ</span><br>    update_time: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">Date</span>, <span class="hljs-attr">default</span>: <span class="hljs-built_in">Date</span>.now &#125;,<br>    child_comments: [<br>        &#123;<br>            <span class="hljs-comment">// è°åœ¨è¯„è®º  å…³è” User é›†åˆ</span><br>            author: &#123;<br>                user: &#123; <span class="hljs-attr">type</span>: mongoose.Schema.Types.ObjectId, <span class="hljs-attr">ref</span>: <span class="hljs-string">&quot;User&quot;</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> &#125;,<br>                role: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">default</span>: <span class="hljs-string">&quot;normal&quot;</span> &#125;, <span class="hljs-comment">// author|normal</span><br>            &#125;,<br>            <span class="hljs-comment">// å¯¹è°è¯„è®º  å…³è” User é›†åˆ</span><br>            reply_to_author: &#123;<br>                user: &#123; <span class="hljs-attr">type</span>: mongoose.Schema.Types.ObjectId, <span class="hljs-attr">ref</span>: <span class="hljs-string">&quot;User&quot;</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> &#125;,<br>                role: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">default</span>: <span class="hljs-string">&quot;normal&quot;</span> &#125;, <span class="hljs-comment">// author|normal &#125;,</span><br>            &#125;,<br>            html: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">validate</span>: <span class="hljs-regexp">/\S+/</span> &#125;,<br>            <span class="hljs-comment">// è¢«èµæ•°</span><br>            likes: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">Number</span>, <span class="hljs-attr">default</span>: <span class="hljs-number">0</span> &#125;,<br>            <span class="hljs-comment">// è¢«è¸©æ•°</span><br>            unlikes: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">Number</span>, <span class="hljs-attr">default</span>: <span class="hljs-number">0</span> &#125;,<br>            <span class="hljs-comment">// åˆ›å»ºæ—¥æœŸ</span><br>            create_time: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">Date</span>, <span class="hljs-attr">default</span>: <span class="hljs-built_in">Date</span>.now &#125;,<br>        &#125;,<br>    ],<br>&#125;);<br></code></pre></td></tr></table></figure><h2 id="è¯„è®ºåŠŸèƒ½å®ç°"><a href="#è¯„è®ºåŠŸèƒ½å®ç°" class="headerlink" title="è¯„è®ºåŠŸèƒ½å®ç°"></a>è¯„è®ºåŠŸèƒ½å®ç°</h2><p>å› ä¸ºæ²¡æœ‰ç¼–è¾‘è¯„è®ºå†…å®¹çš„éœ€æ±‚ï¼Œæ‰€ä»¥åªè¦å®ç°å¢åŠ (Create)ã€è¯»å–(Retrieve)ã€å’Œåˆ é™¤(Delete)</p><ol><li>æ·»åŠ <ul><li>æ·»åŠ çˆ¶è¯„è®º</li><li>æ·»åŠ å­è¯„è®º</li></ul></li><li>æŸ¥è¯¢<ul><li>è·å–çˆ¶è¯„è®ºåˆ—è¡¨æ¥å£</li><li>è·å–å­è¯„è®ºåˆ—è¡¨æ¥å£</li></ul></li><li>åˆ é™¤<ul><li>åˆ é™¤çˆ¶è¯„è®º</li><li>åˆ é™¤å­è¯„è®º</li></ul></li></ol><h3 id="å®é™…é¡¹ç›®ä¸­å¯¹åº”çš„ä»£ç "><a href="#å®é™…é¡¹ç›®ä¸­å¯¹åº”çš„ä»£ç " class="headerlink" title="å®é™…é¡¹ç›®ä¸­å¯¹åº”çš„ä»£ç "></a>å®é™…é¡¹ç›®ä¸­å¯¹åº”çš„ä»£ç </h3><blockquote><p>Tips é¡¹ç›®ä¸­æˆ‘ä½¿ç”¨äº† GraphQL æ¥å£é£æ ¼ <a href="https://graphql.cn/">ä»€ä¹ˆæ˜¯Graphql</a></p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">/**</span><br><span class="hljs-comment"> * å¤„ç† async å‡½æ•°ä¸­çš„å¼‚å¸¸</span><br><span class="hljs-comment"> * <span class="hljs-doctag">@param <span class="hljs-variable">promise</span></span></span><br><span class="hljs-comment"> */</span><br><span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">awaitWrap</span>&lt;<span class="hljs-title">T</span>, <span class="hljs-title">U</span> = <span class="hljs-title">Error</span>&gt;(<span class="hljs-params">promise: <span class="hljs-built_in">Promise</span>&lt;T&gt;</span>): <span class="hljs-title">Promise</span>&lt;[<span class="hljs-title">U</span> | <span class="hljs-title">null</span>, <span class="hljs-title">T</span> | <span class="hljs-title">null</span>]&gt; </span>&#123;<br>    <span class="hljs-keyword">return</span> promise<br>        .then&lt;[<span class="hljs-literal">null</span>, T]&gt;(<span class="hljs-function">(<span class="hljs-params">data: T</span>) =&gt;</span> [<span class="hljs-literal">null</span>, data])<br>        .catch&lt;[U, <span class="hljs-literal">null</span>]&gt;(<span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> [err, <span class="hljs-literal">null</span>]);<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆ›å»ºçˆ¶è¯„è®ºï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs js">add: <span class="hljs-keyword">async</span> (args: Iadd, <span class="hljs-attr">context</span>: any) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> &#123; datumID, html, author &#125; = args;<br>    <span class="hljs-keyword">if</span> (!context.req.user) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;æœªç™»é™†ç”¨æˆ·æ— æƒé™&quot;</span>;<br>    &#125;<br>    <span class="hljs-comment">// æŸ¥è¯¢æ–‡ç« è·å–æ–‡ç« ç›¸å…³ä¿¡æ¯</span><br>    <span class="hljs-keyword">const</span> [errArticle, result] = <span class="hljs-keyword">await</span> awaitWrap&lt;ArticleDocument&gt;(<br>        Article.findOne(&#123; <span class="hljs-attr">_id</span>: datumID &#125;, &#123; <span class="hljs-attr">author</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">title</span>: <span class="hljs-number">1</span> &#125;)<br>            .populate(&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;author&quot;</span> &#125;)<br>            .exec()<br>    );<br>    <span class="hljs-keyword">if</span> (errArticle) <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;æ·»åŠ è¯„è®ºå¤±è´¥1&quot;</span>;<br>    <span class="hljs-keyword">const</span> [err, newComment] = <span class="hljs-keyword">await</span> awaitWrap(<br>        Comment.create(&#123;<br>            datumID,<br>            html,<br>            author: &#123;<br>                user: author,<br>                role: getRole(author, result.author._id.toString()),<br>            &#125;,<br>            child_comments: [],<br>        &#125;)<br>    );<br>    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;æ·»åŠ è¯„è®ºå¤±è´¥2&quot;</span>;<br>    <span class="hljs-keyword">const</span> &#123; req &#125; = context;<br>    <span class="hljs-comment">// é‚®ä»¶é€šçŸ¥ä½œè€… è°è¯„è®º</span><br>    <span class="hljs-keyword">const</span> sendApplyJoinEmail = <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">const</span> transporter = nodemailer.createTransport(&#123;<br>            service: <span class="hljs-string">&quot;126&quot;</span>,<br>            auth: &#123;<br>                user: process.env.SMTP_USER,<br>                pass: process.env.SMTP_PASSWORD,<br>            &#125;,<br>        &#125;);<br>        <span class="hljs-keyword">const</span> mailOptions = &#123;<br>            to: result.author.email,<br>            <span class="hljs-keyword">from</span>: process.env.SMTP_USER,<br>            subject: <span class="hljs-string">`&quot;<span class="hljs-subst">$&#123;context.req.user.profile.name&#125;</span>&quot;è¯„è®ºäº†ä½ çš„çŸ¥è¯†ã€Š<span class="hljs-subst">$&#123;result.title&#125;</span>ã€‹`</span>,<br>            html: <span class="hljs-string">`ç‚¹å‡»ä¸‹é¢é“¾æ¥å¤„ç†:</span><br><span class="hljs-string">            &lt;p/&gt;</span><br><span class="hljs-string">            &lt;a href=&quot;<span class="hljs-subst">$&#123;req.headers.origin&#125;</span>/datum/view?id=<span class="hljs-subst">$&#123;datumID&#125;</span>&quot;&gt;<span class="hljs-subst">$&#123;req.headers.origin&#125;</span>/datum/view?id=<span class="hljs-subst">$&#123;datumID&#125;</span>&lt;/a&gt;`</span>,<br>        &#125;;<br>        transporter.sendMail(mailOptions);<br>    &#125;;<br>    sendApplyJoinEmail();<br>    <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;ok&quot;</span>, <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;æ·»åŠ æˆåŠŸ&quot;</span>, <span class="hljs-attr">commentID</span>: newComment._id &#125;;<br>&#125;,<br><br></code></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬æ·»åŠ ä¸€æ¡çˆ¶è¯„è®ºæµ‹è¯•ä¸€ä¸‹æ¥å£ï¼š<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/tbIzXv.png" alt="tbIzXv"><br>ç„¶åå»æ•°æ®åº“ä¸­æŸ¥çœ‹ï¼š<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/NO3YVi.png" alt="NO3YVi"></p><p>åˆ›å»ºå­è¯„è®ºï¼šä¸»è¦é€šè¿‡ <code>$push</code> æ“ä½œç¬¦å®ç°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><code class="hljs js">addChild: <span class="hljs-keyword">async</span> (args: IaddChild, <span class="hljs-attr">context</span>: any) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> &#123; id, datumID, html, author, reply_to_author &#125; = args;<br>    <span class="hljs-keyword">if</span> (!context.req.user) &#123;<br>        <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;æœªç™»é™†ç”¨æˆ·æ— æƒé™&quot;</span>;<br>    &#125;<br>    <span class="hljs-comment">// æŸ¥è¯¢æ–‡ç« è·å–æ–‡ç« ä½œè€…</span><br>    <span class="hljs-keyword">const</span> [errArticle, result] = <span class="hljs-keyword">await</span> awaitWrap(<br>        Article.findOne(&#123; <span class="hljs-attr">_id</span>: datumID &#125;, &#123; <span class="hljs-attr">author</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">title</span>: <span class="hljs-number">1</span> &#125;)<br>            .populate(&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&quot;author&quot;</span> &#125;)<br>            .exec()<br>    );<br>    <span class="hljs-keyword">if</span> (errArticle) <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;æ·»åŠ è¯„è®ºå¤±è´¥&quot;</span>;<br><br>    <span class="hljs-keyword">const</span> [err] = <span class="hljs-keyword">await</span> awaitWrap(<br>        Comment.updateOne(<br>            &#123; <span class="hljs-attr">_id</span>: id &#125;,<br>            &#123;<br>                $push: &#123;<br>                    child_comments: &#123;<br>                        author: &#123;<br>                            user: author,<br>                            role: getRole(author, result.author._id.toString()),<br>                        &#125;,<br>                        reply_to_author: &#123;<br>                            user: reply_to_author,<br>                            role: getRole(reply_to_author, result.author._id.toString()),<br>                        &#125;,<br>                        html,<br>                    &#125;,<br>                &#125;,<br>            &#125;<br>        ).exec()<br>    );<br>    <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;æ·»åŠ è¯„è®ºå¤±è´¥&quot;</span>;<br>    <span class="hljs-keyword">const</span> &#123; req &#125; = context;<br>    <span class="hljs-comment">// å‘é‚®ä»¶ç»™ reply_to_author</span><br>    <span class="hljs-keyword">const</span> [errUser, data] = <span class="hljs-keyword">await</span> awaitWrap&lt;UserDocument&gt;(<br>        User.findOne(&#123; <span class="hljs-attr">_id</span>: reply_to_author &#125;).exec()<br>    );<br>    <span class="hljs-keyword">if</span> (errUser) <span class="hljs-keyword">throw</span> <span class="hljs-string">&quot;æ·»åŠ è¯„è®ºå¤±è´¥&quot;</span>;<br>    <span class="hljs-keyword">const</span> sendApplyJoinEmail = <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">const</span> transporter = nodemailer.createTransport(&#123;<br>            service: <span class="hljs-string">&quot;126&quot;</span>,<br>            auth: &#123;<br>                user: process.env.SMTP_USER,<br>                pass: process.env.SMTP_PASSWORD,<br>            &#125;,<br>        &#125;);<br>        <span class="hljs-keyword">const</span> mailOptions = &#123;<br>            to: data.email,<br>            <span class="hljs-keyword">from</span>: process.env.SMTP_USER,<br>            subject: <span class="hljs-string">`&quot;<span class="hljs-subst">$&#123;context.req.user.profile.name&#125;</span>&quot;åœ¨ã€Š<span class="hljs-subst">$&#123;result.title&#125;</span>ã€‹å›å¤äº†ä½ `</span>,<br>            html: <span class="hljs-string">`ç‚¹å‡»ä¸‹é¢é“¾æ¥å¤„ç†:</span><br><span class="hljs-string">                    &lt;p/&gt;</span><br><span class="hljs-string">                    &lt;a href=&quot;<span class="hljs-subst">$&#123;req.headers.origin&#125;</span>/datum/view?id=<span class="hljs-subst">$&#123;datumID&#125;</span>&quot;&gt;<span class="hljs-subst">$&#123;req.headers.origin&#125;</span>/datum/view?id=<span class="hljs-subst">$&#123;datumID&#125;</span>&lt;/a&gt;`</span>,<br>        &#125;;<br>        transporter.sendMail(mailOptions);<br>    &#125;;<br>    sendApplyJoinEmail();<br>    <span class="hljs-keyword">return</span> &#123; <span class="hljs-attr">status</span>: <span class="hljs-string">&quot;ok&quot;</span>, <span class="hljs-attr">msg</span>: <span class="hljs-string">&quot;æ·»åŠ æˆåŠŸ&quot;</span> &#125;;<br>&#125;,<br></code></pre></td></tr></table></figure><p>ç°åœ¨æˆ‘ä»¬æ·»åŠ ä¸€æ¡å­è¯„è®ºæµ‹è¯•ä¸€ä¸‹æ¥å£ï¼š<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/1IuESr.png" alt="1IuESr"><br>ç„¶åå»æ•°æ®åº“ä¸­æŸ¥çœ‹ï¼š<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/x8m6z5.png" alt="x8m6z5"></p><p>è¯»å–(Retrieve)ã€å’Œåˆ é™¤(Delete) çš„æ¥å£ç±»ä¼¼ï¼Œæˆ‘è¿™é‡Œå°±ä¸è´´äº†..</p><ul><li>å­è¯„è®ºåˆ†é¡µä¸»è¦é€šè¿‡ <code>$slice</code> å’Œ <code>$size</code> æ“ä½œç¬¦å®ç°</li><li>åˆ é™¤å­è¯„è®º é€šè¿‡<code>$pull</code>æ“ä½œæ³•å®ç°</li></ul><h3 id="ä¸è¦ç›¸ä¿¡å‰ç«¯ä¼ æ¥çš„æ•°æ®ï¼"><a href="#ä¸è¦ç›¸ä¿¡å‰ç«¯ä¼ æ¥çš„æ•°æ®ï¼" class="headerlink" title="ä¸è¦ç›¸ä¿¡å‰ç«¯ä¼ æ¥çš„æ•°æ®ï¼"></a>ä¸è¦ç›¸ä¿¡å‰ç«¯ä¼ æ¥çš„æ•°æ®ï¼</h3><p>â€˜author.roleâ€™çš„å€¼åº”é€šè¿‡æŸ¥è¯¢æ–‡ç« è·å–ä½œè€…id å’Œ å½“å‰ç™»é™†ç”¨æˆ·id åœ¨åç«¯æ¯”è¾ƒå‡ºæ¥çš„, åŒç† reply_to_author.role ä¹Ÿæ˜¯ä¸€æ ·ã€‚</p><h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><h3 id="MongoDB-å¯¹åµŒå¥—çš„æ•°ç»„å¯¹è±¡ä½¿ç”¨-lookupæ“ä½œæ³•"><a href="#MongoDB-å¯¹åµŒå¥—çš„æ•°ç»„å¯¹è±¡ä½¿ç”¨-lookupæ“ä½œæ³•" class="headerlink" title="MongoDB å¯¹åµŒå¥—çš„æ•°ç»„å¯¹è±¡ä½¿ç”¨ $lookupæ“ä½œæ³•"></a>MongoDB å¯¹åµŒå¥—çš„æ•°ç»„å¯¹è±¡ä½¿ç”¨ $lookupæ“ä½œæ³•</h3><p>å› ä¸º Comment é›†åˆä¸­çš„ child_comments å­—æ®µæ˜¯ä¸€ä¸ªæ•°ç»„å¯¹è±¡</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">child_comments:[<br><span class="hljs-code">    &#123;author:&#123;user,role&#125;,reply_to_author,....&#125;</span><br>]<br><br></code></pre></td></tr></table></figure><p>å½“æˆ‘åšé€šè¿‡ $lookup æ“ä½œç¬¦åšå¤šè¡¨å…³è”æŸ¥æ‰¾æ“ä½œæ—¶,child_comments ä¸­çš„å­—æ®µä¼šè¢«è¦†ç›–</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-comment">// æ‰§è¡Œ</span><br>&#123;<br>$lookup: &#123;<br><span class="hljs-symbol">from:</span> <span class="hljs-string">&quot;users&quot;</span>,<br><span class="hljs-symbol">localField:</span> <span class="hljs-string">&quot;child_comments.author.user&quot;</span>,<br><span class="hljs-symbol">foreignField:</span> <span class="hljs-string">&quot;_id&quot;</span>,<br><span class="hljs-symbol">as:</span> <span class="hljs-string">&quot;child_comments.author.user&quot;</span>,<br>&#125;,<br>&#125;<br><span class="hljs-comment">// å®é™…è¿”å›çš„ child_comments æ•°ç»„å¯¹è±¡ä¸­ author.role å­—æ®µæ²¡æœ‰äº†</span><br>    <span class="hljs-string">&quot;child_comments&quot;</span>: &#123;<br>      <span class="hljs-string">&quot;author&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;user&quot;</span>: [<br>          &#123;<br>            <span class="hljs-string">&quot;_id&quot;</span>: ObjectId(<span class="hljs-string">&quot;5a934e000102030405000003&quot;</span>),<br>            <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;frmachao@126.com&quot;</span>,<br>            <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;user1&quot;</span>,<br>            <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;frmachao&quot;</span><br>          &#125;<br>        ]<br>      &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>é™„ä¸Šæ¼”ç¤ºåœ°å€ï¼š<a href="https://mongoplayground.net/p/aSKn8PhYXow">MongoDB playground</a></p><p>é€šè¿‡æœç´¢å¼•æ“ æ£€ç´¢ <code>mongodb</code>+ <code>array</code> + <code>lookup</code> æˆ‘æ‰¾åˆ°äº†è§£å†³åŠæ³•</p><p>åœ¨stack overflowä¸Šæœ‰ä¸ªé—®é¢˜ï¼Œè·Ÿæˆ‘é‡åˆ°çš„æƒ…å†µåŸºæœ¬ä¸€æ ·ï¼š <a href="https://stackoverflow.com/questions/63267126/mongodb-lookup-with-array">mongodb-lookup-with-array</a></p><blockquote><p>è§£å†³åŠæ³•ï¼š é€šè¿‡ <code>unwind</code> + <code>$group</code> æ¥åš</p></blockquote><p>å…ˆå°†æ•°ç»„æ‰“å¹³ï¼Œç„¶åæ‰§è¡Œ lookup æ“ä½œ</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs dts">&#123;<br>  $unwind: &#123;<br><span class="hljs-symbol">    path:</span> <span class="hljs-string">&quot;$child_comments&quot;</span>,<br><span class="hljs-symbol">    preserveNullAndEmptyArrays:</span> true,<br>    <br>  &#125;,<br>  <br>&#125;,<br>  &#123;<br>  $lookup: &#123;<br><span class="hljs-symbol">    from:</span> <span class="hljs-string">&quot;user&quot;</span>,<br><span class="hljs-symbol">    localField:</span> <span class="hljs-string">&quot;child_comments.author.user&quot;</span>,<br><span class="hljs-symbol">    foreignField:</span> <span class="hljs-string">&quot;id&quot;</span>,<br><span class="hljs-symbol">    as:</span> <span class="hljs-string">&quot;child_comments.author.user&quot;</span>,<br>    <br>  &#125;,<br>  <br>&#125;,<br></code></pre></td></tr></table></figure><p>æœ€å é€šè¿‡ <code>group</code> é‡æ–°ç”Ÿæˆæ•°ç»„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs bash">&#123;<br>  <span class="hljs-variable">$group</span>: &#123;<br>    _id: <span class="hljs-string">&quot;<span class="hljs-variable">$_id</span>&quot;</span>,<br>    datumID: &#123;<br>      <span class="hljs-variable">$first</span>: <span class="hljs-string">&quot;<span class="hljs-variable">$datumID</span>&quot;</span>,<br>      <br>    &#125;,<br>    html: &#123;<br>      <span class="hljs-variable">$first</span>: <span class="hljs-string">&quot;<span class="hljs-variable">$html</span>&quot;</span><br>    &#125;,<br>    child_comments: &#123;<br>      <span class="hljs-variable">$push</span>: <span class="hljs-string">&quot;<span class="hljs-variable">$child_comments</span>&quot;</span>,<br>      <br>    &#125;,<br>    <br>  &#125;,<br>  <br>&#125;,<br></code></pre></td></tr></table></figure><p>é™„ä¸Šæ¼”ç¤ºåœ°å€ï¼š<a href="https://mongoplayground.net/p/h3jwNQ0Yoxv">MongoDB playground</a></p><h3 id="æ•°ç»„ä¸­çš„å­—æ®µä¸ä¸€å®šå­˜åœ¨æ—¶-è¯¥å¦‚ä½•åˆ¤æ–­"><a href="#æ•°ç»„ä¸­çš„å­—æ®µä¸ä¸€å®šå­˜åœ¨æ—¶-è¯¥å¦‚ä½•åˆ¤æ–­" class="headerlink" title="æ•°ç»„ä¸­çš„å­—æ®µä¸ä¸€å®šå­˜åœ¨æ—¶ è¯¥å¦‚ä½•åˆ¤æ–­"></a>æ•°ç»„ä¸­çš„å­—æ®µä¸ä¸€å®šå­˜åœ¨æ—¶ è¯¥å¦‚ä½•åˆ¤æ–­</h3><p>å› ä¸ºæˆ‘è¦ç»Ÿè®¡æ¯æ¡çˆ¶è¯„è®ºä¸‹ä¸€å…±æœ‰å¤šå°‘å­è¯„è®º,æ¥å®ç°å­è¯„è®ºçš„åˆ†é¡µæŸ¥è¯¢æ“ä½œï¼Œè¿™ä¸ªä¸»è¦é€šè¿‡ $sizeæ“ä½œç¬¦æ¥å®ç°</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">$addFields: &#123;<br>child_total: &#123;<br>$size: <span class="hljs-string">&quot;$child_comments&quot;</span><br>&#125;,<br>&#125;,<br><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯ä¸Šé¢ä»£ç æ‰§è¡Œåçš„ç»“æœå¹¶ä¸æ˜¯æˆ‘é¢„æœŸçš„ï¼Œå› ä¸ºä¹‹å‰åœ¨åš<code>lookup</code>æ“ä½œæ—¶ï¼Œå¦‚æœ <code>child_comments</code>å­—æ®µä¸ºç©ºå°±ä¼šå¾—åˆ°è¿™æ ·çš„ç»“æœ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>  <span class="hljs-string">&quot;_id&quot;</span>: ObjectId(<span class="hljs-string">&quot;5a934e000102030405000002&quot;</span>),<br>  <span class="hljs-string">&quot;child_comments&quot;</span>: [<br>    &#123;<br>      <span class="hljs-string">&quot;author&quot;</span>: &#123;<br>        <span class="hljs-string">&quot;user&quot;</span>: []<br>      &#125;<br>    &#125;<br>  ],<br>  <span class="hljs-string">&quot;datumID&quot;</span>: <span class="hljs-literal">null</span>,<br>  <span class="hljs-string">&quot;html&quot;</span>: <span class="hljs-string">&quot;è¿™æ˜¯çˆ¶è¯„è®º2&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure><p>æ˜¾ç„¶åƒè¿™æ ·çš„è¯ï¼Œ<code>child_comments</code> æ•°ç»„çš„é•¿åº¦å°±ä¼šè·Ÿå®é™…å­è¯„è®ºæ•°é‡ä¸åŒï¼Œæ‰€ä»¥åœ¨è®¡ç®—child_total è¦é¢å¤–åˆ¤æ–­ã€‚</p><p>ä¸€å¼€å§‹æˆ‘ä½¿ç”¨ $type æ“ä½œç¬¦ åœ¨èšåˆæ“ä½œä¸­åšåˆ¤æ–­ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>  <span class="hljs-string">&quot;$addFields&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;child_total&quot;</span>: &#123;<br>      $type: <span class="hljs-string">&quot;$child_comments.author&quot;</span><br>    &#125;<br>  &#125;<br>&#125;<br><span class="hljs-comment">// å¾—åˆ° child_total å±…ç„¶æ˜¯ array</span><br></code></pre></td></tr></table></figure><p>ç¿»é˜…æ–‡æ¡£åå¾—çŸ¥åœ¨èšåˆé˜¶æ®µ ä¸$typeæ ¹æ® BSON ç±»å‹åŒ¹é…æ•°ç»„å…ƒç´ çš„æŸ¥è¯¢è¿ç®—ç¬¦ä¸åŒï¼Œ$type èšåˆè¿ç®—ç¬¦ä¸æ£€æŸ¥æ•°ç»„å…ƒç´ ã€‚ç›¸åï¼Œå½“ä¼ é€’ä¸€ä¸ªæ•°ç»„ä½œä¸ºå…¶å‚æ•°æ—¶ï¼Œ$typeèšåˆè¿ç®—ç¬¦è¿”å›å‚æ•°çš„ç±»å‹ï¼Œå³â€arrayâ€ã€‚</p><p>æ—¢ç„¶è¿™æ ·æˆ‘å°±æ¢ç§æ€è·¯ï¼š</p><ol><li>å…ˆå°†è®¡ç®— child_total å­—æ®µçš„æ“ä½œæå‰åˆ° æ•°ç»„ lookup æ“ä½œä¹‹å‰</li><li>åœ¨<code>group</code>æ“ä½œé‡æ–°ç”Ÿæˆæ•°ç»„æ—¶ï¼Œå¯¹ <code>child_comments</code>åšå¦‚ä¸‹å¤„ç†<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>$set: &#123;<br>child_comments: &#123;<br>$switch: &#123;<br>branches: [&#123;<br><span class="hljs-keyword">case</span>:<br>&#123;<br>$in:<br>[<span class="hljs-string">&quot;normal&quot;</span>, <span class="hljs-string">&quot;$child_comments.author.role&quot;</span>],<br>&#125;,<br>then: <span class="hljs-string">&quot;$child_comments&quot;</span>,<br>&#125;,<br>&#123;<br><span class="hljs-keyword">case</span>:<br>&#123;<br>$in:<br>[<span class="hljs-string">&quot;author&quot;</span>, <span class="hljs-string">&quot;$child_comments.author.role&quot;</span>],<br>&#125;,<br>then: <span class="hljs-string">&quot;$child_comments&quot;</span>,<br>&#125;,<br>],<br><span class="hljs-keyword">default</span>:<br>[],<br>&#125;,<br>&#125;,<br>&#125;,<br>&#125;,<br></code></pre></td></tr></table></figure>è¿™æ ·å°±èƒ½å¾—åˆ°æˆ‘æƒ³è¦çš„ç»“æ„äº†ï¼Œæˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs js">[<br>  &#123;<br>    <span class="hljs-string">&quot;_id&quot;</span>: ObjectId(<span class="hljs-string">&quot;5a934e000102030405000001&quot;</span>),<br>    <span class="hljs-string">&quot;child_comments&quot;</span>: [<br>      &#123;<br>        <span class="hljs-string">&quot;author&quot;</span>: &#123;<br>          <span class="hljs-string">&quot;role&quot;</span>: <span class="hljs-string">&quot;author&quot;</span>,<br>          <span class="hljs-string">&quot;user&quot;</span>: [<br>            &#123;<br>              <span class="hljs-string">&quot;_id&quot;</span>: ObjectId(<span class="hljs-string">&quot;5a934e000102030405000003&quot;</span>),<br>              <span class="hljs-string">&quot;email&quot;</span>: <span class="hljs-string">&quot;frmachao@126.com&quot;</span>,<br>              <span class="hljs-string">&quot;id&quot;</span>: <span class="hljs-string">&quot;user1&quot;</span>,<br>              <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;frmachao&quot;</span><br>            &#125;<br>          ]<br>        &#125;<br>      &#125;<br>    ],<br>    <span class="hljs-string">&quot;child_total&quot;</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-string">&quot;datumID&quot;</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-string">&quot;html&quot;</span>: <span class="hljs-string">&quot;è¿™æ˜¯çˆ¶è¯„è®º1&quot;</span><br>  &#125;,<br>  &#123;<br>    <span class="hljs-string">&quot;_id&quot;</span>: ObjectId(<span class="hljs-string">&quot;5a934e000102030405000002&quot;</span>),<br>    <span class="hljs-string">&quot;child_comments&quot;</span>: [],<br>    <span class="hljs-string">&quot;child_total&quot;</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-string">&quot;datumID&quot;</span>: <span class="hljs-literal">null</span>,<br>    <span class="hljs-string">&quot;html&quot;</span>: <span class="hljs-string">&quot;è¿™æ˜¯çˆ¶è¯„è®º2&quot;</span><br>  &#125;<br>]<br></code></pre></td></tr></table></figure>é™„ä¸Šæ¼”ç¤ºåœ°å€ï¼š<a href="https://mongoplayground.net/p/RkZ2FNWbJl8">MongoDB playground</a></li></ol><h2 id="å‰ç«¯è¯„è®ºæ¡†å®ç°"><a href="#å‰ç«¯è¯„è®ºæ¡†å®ç°" class="headerlink" title="å‰ç«¯è¯„è®ºæ¡†å®ç°"></a>å‰ç«¯è¯„è®ºæ¡†å®ç°</h2><ul><li>Ant Design<ul><li>Comment ç»„ä»¶</li><li>Pagination ç»„ä»¶</li><li>Popconfirm ç»„ä»¶</li><li>Form ç»„ä»¶</li></ul></li></ul><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/dD1EER.png" alt="dD1EER"></p><ul><li>markdown-it Markdown è§£æå™¨<ul><li>ç²¾ç®€ç‰ˆ Markdown ä¸æ”¯æŒ htm æ ‡ç­¾è§£æ<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> mdParserComment = MarkdownIt(&#123;<br>    html: <span class="hljs-literal">false</span>, <span class="hljs-comment">// ä¸æ”¯æŒhtmlåµŒå¥—</span><br>    linkify: <span class="hljs-literal">true</span>, <span class="hljs-comment">// æ”¯æŒurlç”Ÿæˆaé“¾æ¥</span><br>    typographer: <span class="hljs-literal">true</span>,<br>    highlight: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">str, lang</span>) </span>&#123;<br>        <span class="hljs-keyword">if</span> (lang &amp;&amp; hljs.getLanguage(lang)) &#123;<br>            <span class="hljs-keyword">return</span> hljs.highlight(str, &#123; <span class="hljs-attr">language</span>: lang &#125;).value;<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>; <span class="hljs-comment">// use external default escaping</span><br>    &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2></li></ul></li></ul><p>æˆ‘çš„<a href="http://101.132.140.62/">ä¸ªäººç½‘ç«™</a>â€“ã€‹<a href="http://101.132.140.62/datum">çŸ¥æ‹¾</a>â€”ã€‹<a href="http://101.132.140.62/datum/view?id=6131aa762237bc57827adaf5">è¯„è®º</a> æ¬¢è¿å¤§å®¶ä½¿ç”¨ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/zpqm2H.png" alt="zpqm2H"></p>]]></content>
    
    
    <categories>
      
      <category>ä»£ç äººç”Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nodejs</tag>
      
      <tag>mongodb</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>mongodb æŸ¥è¯¢åµŒå…¥å¼æ–‡æ¡£æ•°ç»„æ¯”è¾ƒæŸé¡¹å­—æ®µçš„å€¼</title>
    <link href="/posts/7d83f8b4/"/>
    <url>/posts/7d83f8b4/</url>
    
    <content type="html"><![CDATA[<p>[toc]</p><h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>ç°åœ¨æˆ‘æœ‰ä¸€ä¸ªè¿™æ ·çš„ mongodb æ–‡æ¡£æ¨¡å‹ <code>Article</code></p><p><code>authorã€group</code> è¿™ä¸¤ä¸ªå­—æ®µåˆ†åˆ«å·¦å¤–éƒ¨è”æ¥ <code>User</code>å’Œ<code>ArticleGroup</code>ä¸¤ä¸ªé›†åˆ</p><blockquote><p>æˆ‘ä½¿ç”¨çš„æ˜¯ mongoose å¯¹è±¡æ–‡æ¡£æ¨¡å‹ï¼ˆODMï¼‰åº“ï¼Œé›†åˆåç§°éƒ½æ˜¯å¤§å†™çš„</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"><br><span class="hljs-keyword">const</span> ArticleSchema = <span class="hljs-keyword">new</span> mongoose.Schema(&#123;<br>    title: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> &#125;,<br>    author: &#123; <span class="hljs-attr">type</span>: mongoose.Schema.Types.ObjectId, <span class="hljs-attr">ref</span>: <span class="hljs-string">&quot;User&quot;</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> &#125;,<br>    group: &#123; <span class="hljs-attr">type</span>: mongoose.Schema.Types.ObjectId, <span class="hljs-attr">ref</span>: <span class="hljs-string">&quot;ArticleGroup&quot;</span> &#125;,<br>&#125;);<br><span class="hljs-comment">// ArticleGroup</span><br><span class="hljs-keyword">const</span> ArticleGroupSchema = <span class="hljs-keyword">new</span> mongoose.Schema(&#123;<br>    name: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> &#125;,<br>    desc: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>, <span class="hljs-attr">default</span>: <span class="hljs-string">&quot;&quot;</span> &#125;,<br>    state: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">default</span>: <span class="hljs-string">&quot;public&quot;</span> &#125;,<br>    members: [<br>        &#123;<br>            desc: <span class="hljs-built_in">String</span>,<br>            role: <span class="hljs-built_in">String</span>,<br>            user: &#123; <span class="hljs-attr">type</span>: mongoose.Schema.Types.ObjectId, <span class="hljs-attr">ref</span>: <span class="hljs-string">&quot;User&quot;</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> &#125;,<br>        &#125;,<br>    ],<br>&#125;);<br><span class="hljs-comment">// User</span><br><span class="hljs-keyword">const</span> userSchema = <span class="hljs-keyword">new</span> mongoose.Schema(<br>    &#123;<br>        email: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>, <span class="hljs-attr">unique</span>: <span class="hljs-literal">true</span> &#125;,<br>        password: <span class="hljs-built_in">String</span>,<br>    &#125;,<br>);<br></code></pre></td></tr></table></figure><p>test data :</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>  _id: <span class="hljs-string">&quot;6131aa5b367318e2df14b988&quot;</span>,<br>  title: <span class="hljs-string">&quot;åŠŸèƒ½æ›´æ–°æ¸…å•&quot;</span>,<br>  author: ObjectId(<span class="hljs-string">&quot;607edeb4b1e1bea9acb5af38&quot;</span>),<br>  group: ObjectId(<span class="hljs-string">&quot;612d00a43c52975d4ade10d4&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æˆ‘é¢„æœŸçš„ç»“æœ"><a href="#æˆ‘é¢„æœŸçš„ç»“æœ" class="headerlink" title="æˆ‘é¢„æœŸçš„ç»“æœ"></a>æˆ‘é¢„æœŸçš„ç»“æœ</h2><p>æˆ‘æƒ³åœ¨ aggregate èšåˆæ“ä½œå†…é€šè¿‡æ¯”è¾ƒ author._id == group.members.user çš„å€¼ï¼Œå‘æ–‡æ¡£æ·»åŠ ä¸€ä¸ªæ–°å­—æ®µ can_editã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs js"> Article.aggregate([<br>&#123;<br>  $lookup: &#123;<br>       <span class="hljs-keyword">from</span>: <span class="hljs-string">&quot;users&quot;</span>,<br>       localField: <span class="hljs-string">&quot;author&quot;</span>,<br>       foreignField: <span class="hljs-string">&quot;_id&quot;</span>,<br>       <span class="hljs-keyword">as</span>: <span class="hljs-string">&quot;author&quot;</span>,<br>     &#125;,<br> &#125;,<br>&#123;<br>    $lookup: &#123;<br>      <span class="hljs-keyword">from</span>: <span class="hljs-string">&quot;articlegroups&quot;</span>,<br>      localField: <span class="hljs-string">&quot;group&quot;</span>,<br>      foreignField: <span class="hljs-string">&quot;_id&quot;</span>,<br>      <span class="hljs-keyword">as</span>: <span class="hljs-string">&quot;group&quot;</span><br>    &#125;<br>&#125;,<br>  &#123;<br>     $addFields: &#123;<br>          can_edit: &#123;<br>                        $eq: [<span class="hljs-string">&quot;$group.members.user&quot;</span>, <span class="hljs-string">&quot;$author._id&quot;</span>],<br>                      &#125;,<br>                &#125;<br>  &#125;<br>])<br><br></code></pre></td></tr></table></figure><p>å¯æ˜¯æˆ‘å¾—åˆ°çš„ can_edit å€¼å§‹ç»ˆæ˜¯ false,æˆ‘ç¡®å®šåœ¨æˆ‘çš„æµ‹è¯•æ•°æ®ä¸­ author._id çš„å€¼å’Œgroup.members.user æ˜¯ç›¸åŒã€‚</p><p>æœŸæœ›è¿”å›çš„æ–‡æ¡£ç»“æ„:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>  _id: <span class="hljs-string">&quot;6131aa5b367318e2df14b988&quot;</span>,<br>  can_edit: <span class="hljs-literal">true</span>,<br>  title: <span class="hljs-string">&quot;åŠŸèƒ½æ›´æ–°æ¸…å•&quot;</span>,<br>  author: &#123;<br>    _id: <span class="hljs-string">&quot;607edeb4b1e1bea9acb5af38&quot;</span>,<br>    email: <span class="hljs-string">&quot;frmachao@126.com&quot;</span>,<br>    <br>  &#125;,<br>  group: &#123;<br>    _id: <span class="hljs-string">&quot;612d00a43c52975d4ade10d4&quot;</span>,<br>    desc: <span class="hljs-string">&quot;å¼€å‘&quot;</span>,<br>    state: <span class="hljs-string">&quot;public&quot;</span>,<br>    name: <span class="hljs-string">&quot;å¼€å‘å°ç»„&quot;</span>,<br>    members: [<br>      &#123;<br>        _id: <span class="hljs-string">&quot;612d00a43c52975d4ade10d5&quot;</span>,<br>        role: <span class="hljs-string">&quot;admin&quot;</span>,<br>        user: <span class="hljs-string">&quot;607edeb4b1e1bea9acb5af38&quot;</span>,<br>        <br>      &#125;<br>    ]<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>åˆšåˆšï¼Œæˆ‘æ‰¾åˆ°ä¸€ä¸ªç›¸ä¼¼çš„é—®é¢˜ <a href="https://stackoverflow.com/questions/46771145/querying-mongo-array-of-embedded-documents-in-aggregation-pipeline">stackoverflow</a>ã€‚ä¸Šé¢æåˆ°ï¼š $eq (èšåˆ)æ¯”è¾ƒä¸åŒäºæŸ¥è¯¢ eq opeator çš„å€¼å’Œç±»å‹ï¼Œåè€…å¯ä»¥æ¯”è¾ƒä»»ä½•ç±»å‹çš„å€¼ã€‚éœ€è¦ $in (èšåˆ)æ¥éªŒè¯æ•°ç»„ä¸­çš„å€¼</p><p>äºæ˜¯æˆ‘å°è¯•åšäº†ä¸‹é¢æ›´æ”¹</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php">Article.aggregate([<br>&#123;<br>  <span class="hljs-variable">$lookup</span>: &#123;<br>       <span class="hljs-keyword">from</span>: <span class="hljs-string">&quot;users&quot;</span>,<br>       localField: <span class="hljs-string">&quot;author&quot;</span>,<br>       foreignField: <span class="hljs-string">&quot;_id&quot;</span>,<br>       <span class="hljs-keyword">as</span>: <span class="hljs-string">&quot;author&quot;</span>,<br>     &#125;,<br> &#125;,<br>&#123;<br>    <span class="hljs-variable">$lookup</span>: &#123;<br>      <span class="hljs-keyword">from</span>: <span class="hljs-string">&quot;articlegroups&quot;</span>,<br>      localField: <span class="hljs-string">&quot;group&quot;</span>,<br>      foreignField: <span class="hljs-string">&quot;_id&quot;</span>,<br>      <span class="hljs-keyword">as</span>: <span class="hljs-string">&quot;group&quot;</span><br>    &#125;<br>&#125;,<br>  &#123;<br>    <span class="hljs-variable">$addFields</span>: &#123;<br>      can_edit: &#123;<br>        <span class="hljs-variable">$in</span>: [<br>          <span class="hljs-string">&quot;<span class="hljs-subst">$author</span>._id&quot;</span>,<br>          <span class="hljs-string">&quot;<span class="hljs-subst">$group</span>.members.user&quot;</span><br>        ],<br>      &#125;,<br>    &#125;,<br>  &#125;<br>])<br><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯é‡åˆ°äº†æ–°é—®é¢˜ï¼š <code>$in requires an array as a second argument</code></p><p>åœ¨æŒ£æ‰äº†100åˆ†é’Ÿ: å°è¯•ç”¨æœç´¢å¼•æ“æ£€ç´¢æˆ‘é‡åˆ°çš„é—®é¢˜ã€å»ç¿»é˜…<code>$eqèšåˆé˜¶æ®µ</code>çš„æ–‡æ¡£ã€å’¨è¯¢å¾®ä¿¡é‡Œåšè¿‡æœåŠ¡ç«¯å¼€å‘çš„ç½‘å‹</p><p>å¯æ˜¯é—®é¢˜è¿˜æ˜¯æ²¡æœ‰è§£å†³ï¼Œæœ€åæˆ‘å†³å®šå»ç¤¾åŒºæé—®ã€‚</p><h2 id="å»ç¤¾åŒºæé—®"><a href="#å»ç¤¾åŒºæé—®" class="headerlink" title="å»ç¤¾åŒºæé—®"></a>å»ç¤¾åŒºæé—®</h2><ol><li>å›½å†… <a href="https://segmentfault.com/q/1010000040631179">segmentfault</a></li><li>å›½å¤–çš„ <a href="https://stackoverflow.com/questions/46771145/querying-mongo-array-of-embedded-documents-in-aggregation-pipeline">stackoverflow</a><h2 id="mongoplayground"><a href="#mongoplayground" class="headerlink" title="mongoplayground"></a>mongoplayground</h2></li></ol><p>stackoverflow ä¸Šé¢ï¼Œä¸€ä½çƒ­å¿ƒçš„é©¬æ¥è¥¿äºšç¨‹åºå‘˜å¸®æˆ‘è§£å†³äº†é—®é¢˜:<br>ä»–å‘Šè¯‰æˆ‘ åº”è¯¥ <code>group.members must be array checking</code>ï¼Œä¹Ÿå°±æ˜¯å…ˆè¦åˆ¤æ–­group.members æ˜¯ä¸æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚</p><p>åˆ†æï¼šåœ¨æˆ‘å®šä¹‰çš„æ•°æ®æ¨¡å‹é‡Œï¼Œgroup å¹¶ä¸æ˜¯ä¸€ä¸ªå¿…å¡«é¡¹ï¼Œæ‰€ä»¥ group å­—æ®µå¯èƒ½ä¸ºç©º</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> ArticleSchema = <span class="hljs-keyword">new</span> mongoose.Schema(&#123;<br>    title: &#123; <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> &#125;,<br>    author: &#123; <span class="hljs-attr">type</span>: mongoose.Schema.Types.ObjectId, <span class="hljs-attr">ref</span>: <span class="hljs-string">&quot;User&quot;</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> &#125;,<br>    group: &#123; <span class="hljs-attr">type</span>: mongoose.Schema.Types.ObjectId, <span class="hljs-attr">ref</span>: <span class="hljs-string">&quot;ArticleGroup&quot;</span> &#125;,<br>&#125;);<br></code></pre></td></tr></table></figure><p>çƒ­æƒ…çš„é©¬æ¥è¥¿äºšç¨‹åºå‘˜ ç”šè‡³ç»™å‡ºäº†å®Œæ•´çš„ åˆ¤æ–­ group.members must be array çš„æ ·ä¾‹ï¼Œé™„ä¸Šè°ƒè¯•åœ°å€ï¼Œrespectï¼ï¼</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs js">db.collection.aggregate([<br>  &#123;<br>    $addFields: &#123;<br>      can_edit: &#123;<br>        $switch: &#123;<br>          branches: [<br>            &#123;<br>              <span class="hljs-keyword">case</span>: &#123;<br>                $ne: [<br>                  &#123;<br>                    <span class="hljs-string">&quot;$type&quot;</span>: <span class="hljs-string">&quot;$group.members&quot;</span><br>                  &#125;,<br>                  <span class="hljs-string">&quot;array&quot;</span><br>                ]<br>              &#125;,<br>              then: <span class="hljs-literal">false</span><br>            &#125;,<br>            &#123;<br>              <span class="hljs-keyword">case</span>: &#123;<br>                $ne: [<br>                  &#123;<br>                    <span class="hljs-string">&quot;$type&quot;</span>: <span class="hljs-string">&quot;$group.members&quot;</span><br>                  &#125;,<br>                  <span class="hljs-string">&quot;array&quot;</span><br>                ]<br>              &#125;,<br>              then: <span class="hljs-literal">false</span><br>            &#125;,<br>            &#123;<br>              <span class="hljs-keyword">case</span>: &#123;<br>                $in: [<br>                  <span class="hljs-string">&quot;$author._id&quot;</span>,<br>                  <span class="hljs-string">&quot;$group.members.user&quot;</span><br>                ]<br>              &#125;,<br>              then: <span class="hljs-literal">true</span><br>            &#125;<br>          ],<br>          <span class="hljs-keyword">default</span>: <span class="hljs-literal">false</span><br>        &#125;<br>      &#125;<br>    &#125;<br>  &#125;<br>])<br></code></pre></td></tr></table></figure><h2 id="æ”¶è·"><a href="#æ”¶è·" class="headerlink" title="æ”¶è·"></a>æ”¶è·</h2><ol><li><a href="https://mongoplayground.net/">mongoplayground</a>ä¸€ä¸ªç½‘ç«™ å¯ä»¥åœ¨çº¿è°ƒè¯• mongoDBçš„æŸ¥è¯¢</li><li>$eq (èšåˆ)æ¯”è¾ƒä¸åŒäºæŸ¥è¯¢ eq opeator çš„å€¼å’Œç±»å‹ï¼Œåè€…å¯ä»¥æ¯”è¾ƒä»»ä½•ç±»å‹çš„å€¼ã€‚éœ€è¦ $in (èšåˆ)æ¥éªŒè¯æ•°ç»„ä¸­çš„å€¼ã€‚</li><li>å»ç¤¾åŒºæé—®éœ€è¦æ³¨æ„ï¼šæè¿°æ¸…æ¥šè‡ªå·±çš„é—®é¢˜ï¼Œä¸è¦å¸¦ä¸Šè‡ªå·±çš„ä¸šåŠ¡ç»†èŠ‚æŠŠé—®é¢˜å‰¥ç¦»å‡ºæ¥ï¼Œæœ€å¥½èƒ½æä¾›ä¸€ä¸ªåœ¨çº¿è¿è¡Œçš„<code>playground</code>ã€‚</li></ol><h2 id="ğŸ¤”æ€è€ƒ"><a href="#ğŸ¤”æ€è€ƒ" class="headerlink" title="ğŸ¤”æ€è€ƒ"></a>ğŸ¤”æ€è€ƒ</h2><ol><li>è‡ªå­¦èƒ½åŠ›å·®ï¼š ä¸ºä»€ä¹ˆæˆ‘ç¿»çœ‹æ–‡æ¡£æ—¶æ²¡æœ‰çœ‹åˆ° <code>$eq (èšåˆ)æ¯”è¾ƒä¸åŒäºæŸ¥è¯¢ eq opeator çš„å€¼å’Œç±»å‹ï¼Œåè€…å¯ä»¥æ¯”è¾ƒä»»ä½•ç±»å‹çš„å€¼ã€‚éœ€è¦ $in (èšåˆ)æ¥éªŒè¯æ•°ç»„ä¸­çš„å€¼</code></li><li>è‹±è¯­å¾ˆå·®ï¼šstackoverflow ä¸Šç¼–å†™çš„æé—®æè¿°å…¨éƒ¨æ¥è‡ª google ç¿»è¯‘ ä¸­â€“ã€‹è‹±</li></ol>]]></content>
    
    
    <categories>
      
      <category>ä»£ç äººç”Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nodejs</tag>
      
      <tag>mongodb</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®°å½•react+node+mongodbé¡¹ç›®éƒ¨ç½²åˆ°æœåŠ¡å™¨çš„è¿‡ç¨‹</title>
    <link href="/posts/7c957dfb/"/>
    <url>/posts/7c957dfb/</url>
    
    <content type="html"><![CDATA[<p>[toc]</p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æˆ‘ä¹‹å‰åªåšè¿‡webå‰ç«¯å¼€å‘ï¼Œå¯¹æœåŠ¡å™¨ç›¸å…³çš„ä¸œè¥¿æ˜¯çº¯å°ç™½ï¼Œè¿™ç¯‡æ–‡ç« ä»…ç”¨æ¥è®°å½•å­¦ä¹ ã€‚</p><h2 id="å¸¸ç”¨Linuxå‘½ä»¤"><a href="#å¸¸ç”¨Linuxå‘½ä»¤" class="headerlink" title="å¸¸ç”¨Linuxå‘½ä»¤"></a>å¸¸ç”¨Linuxå‘½ä»¤</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">cd</span> è¿›å…¥ç›®å½•<br><span class="hljs-keyword">cd</span> <span class="hljs-string">..</span> è¿”å›ä¸Šä¸€ä¸ªç›®å½•<br><span class="hljs-keyword">ls</span> -a æŸ¥çœ‹å½“å‰ç›®å½•<br>mkdir abc åˆ›å»ºabcæ–‡ä»¶å¤¹<br>mv ç§»åŠ¨æˆ–é‡å‘½å<br>rm åˆ é™¤ä¸€ä¸ªæ–‡ä»¶<br>rm -rf é€’å½’åˆ é™¤æŒ‡å®šæ–‡ä»¶å¤¹<br>å…³æœºå‘½ä»¤ï¼š<span class="hljs-keyword">shutdown</span>æˆ–poweroff<br><span class="hljs-keyword">shutdown</span><span class="hljs-function">:shutdown</span> -h now  <span class="hljs-comment">#ç«‹å³å…³æœºï¼ˆshutdown -h 10   #10åˆ†é’Ÿåå…³æœºï¼‰</span><br>poweroffï¼šç›´æ¥è¾“å…¥poweroff å³å¯<br>é‡å¯å‘½ä»¤ï¼š<span class="hljs-keyword">shutdown</span>æˆ–reboot<br><span class="hljs-keyword">shutdown</span><span class="hljs-function">:shutdown</span> -r now  <span class="hljs-comment">#ç«‹å³é‡æ–°å¯åŠ¨  ï¼ˆshutdown -r +10  #10åˆ†é’Ÿä¹‹åé‡å¯ï¼‰</span><br>rebootï¼šç›´æ¥è¾“å…¥å³å¯ã€‚<br></code></pre></td></tr></table></figure><h2 id="è´­ä¹°æœåŠ¡å™¨"><a href="#è´­ä¹°æœåŠ¡å™¨" class="headerlink" title="è´­ä¹°æœåŠ¡å™¨"></a>è´­ä¹°æœåŠ¡å™¨</h2><p>æˆ‘çš„æœåŠ¡å™¨ä¿¡æ¯ï¼š</p><ul><li>é˜¿é‡Œäº‘è½»é‡æœåŠ¡å™¨ï¼š2Gè¿è¡Œå†…å­˜ 2æ ¸ 60Gç¡¬ç›˜ 1000Gæµé‡/æœˆ </li><li>é•œåƒä¿¡æ¯: CentOS 7.3</li><li>å…¬ç½‘ IP: <a href="http://101.132.140.62/">http://101.132.140.62</a></li><li>å¤‡æ¡ˆåæ‰å¯ä»¥ä½¿ç”¨80ç«¯å£è®¿é—®åŸŸå</li><li>æˆ‘æ²¡æœ‰å¤‡æ¡ˆ æš‚æ—¶é€šè¿‡å…¬ç½‘ IP è®¿é—® </li></ul><h2 id="SSH-è¿æ¥åˆ°æœåŠ¡å™¨"><a href="#SSH-è¿æ¥åˆ°æœåŠ¡å™¨" class="headerlink" title="SSH è¿æ¥åˆ°æœåŠ¡å™¨"></a>SSH è¿æ¥åˆ°æœåŠ¡å™¨</h2><ol><li>åœ¨é˜¿é‡Œäº‘çš„å·¥ä½œå° ä½¿ç”¨æµè§ˆå™¨å‘èµ·å®‰å…¨è¿æ¥ï¼ˆæ¨èï¼‰</li><li>å®¢æˆ·ç«¯ä½¿ç”¨è´¦å·å¯†ç è¿›è¡Œè¿æ¥ (åœ¨é˜¿é‡Œäº‘åå°è®¾ç½®å¯†ç åï¼Œåœ¨ç”µè„‘ç»ˆç«¯æ‰§è¡Œ ssh <a href="mailto:&#114;&#111;&#111;&#x74;&#x40;&#x31;&#48;&#x31;&#x2e;&#x31;&#x33;&#50;&#x2e;&#x31;&#x34;&#48;&#46;&#x36;&#50;">&#114;&#111;&#111;&#x74;&#x40;&#x31;&#48;&#x31;&#x2e;&#x31;&#x33;&#50;&#x2e;&#x31;&#x34;&#48;&#46;&#x36;&#50;</a> æ ¹æ®æç¤ºè¾“å…¥å¯†ç )<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/6SByfM.png" alt="6SByfM"></li></ol><h2 id="å®‰è£…node-js"><a href="#å®‰è£…node-js" class="headerlink" title="å®‰è£…node.js"></a>å®‰è£…node.js</h2><p>å…ˆå®‰è£…nvm ç„¶å é€šè¿‡nvm å®‰è£…è·Ÿæœ¬åœ°å¼€å‘ç¯å¢ƒä¸€æ ·çš„nodejs ç‰ˆæœ¬</p><ol><li><code>curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | bash</code></li><li><code>source ~/.bashrc</code></li><li><code>nvm install 12.16.1</code> ï¼ˆå®‰è£…çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬æˆä¸ºé»˜è®¤ç‰ˆæœ¬ï¼‰</li></ol><h2 id="å®‰è£…mongodb"><a href="#å®‰è£…mongodb" class="headerlink" title="å®‰è£…mongodb"></a>å®‰è£…mongodb</h2><p>å‚è€ƒ: <a href="https://jasonkayzk.github.io/2021/03/10/CentOS7%E5%AE%89%E8%A3%85MongoDB/">https://jasonkayzk.github.io/2021/03/10/CentOS7%E5%AE%89%E8%A3%85MongoDB/</a></p><blockquote><p> è¿˜æ˜¯è¦è·Ÿç€å®˜æ–¹æ–‡æ¡£èµ°ï¼Œæœ‰äººå†™å¾—åšå®¢å†…å®¹å¯èƒ½å·²ç»è¿‡æ—¶ï¼Œæˆ–è€…ä½œè€…å¾—å†…å®¹æœ¬èº«å°±æœ‰é—®é¢˜.</p></blockquote><ol><li><p>åˆ›å»º/etc/yum.repos.d/MongoDB-enterprise-4.4. repo æ–‡ä»¶ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ yum</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">[mongodb-enterprise-4.4]<br>name=MongoDB Enterprise Repository<br>baseurl=https://repo.mongodb.com/yum/redhat/<span class="hljs-variable">$releasever</span>/mongodb-enterprise/4.4/<span class="hljs-variable">$basearch</span>/<br>gpgcheck=1<br>enabled=1<br>gpgkey=https://www.mongodb.org/static/pgp/server-4.4.asc<br><br></code></pre></td></tr></table></figure><p>æ³¨é‡Š</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs makefile">name <span class="hljs-comment"># åç§°</span><br>baseurl <span class="hljs-comment"># è·å¾—ä¸‹è½½çš„è·¯å¾„</span><br>gpkcheck=1 <span class="hljs-comment"># è¡¨ç¤ºå¯¹ä»è¿™ä¸ªæºä¸‹è½½çš„rpmåŒ…è¿›è¡Œæ ¡éªŒï¼›</span><br>enable=1 <span class="hljs-comment"># è¡¨ç¤ºå¯ç”¨è¿™ä¸ªæº</span><br>gpgkey <span class="hljs-comment"># gpgéªŒè¯</span><br></code></pre></td></tr></table></figure></li><li><p><code>sudo yum install -y mongodb-enterprise</code></p></li><li><p>éªŒè¯å®‰è£…ç»“æœ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">æ‰§è¡Œï¼š rpm -qa |grep mongodb<br>è¾“å‡º:<br>mongodb-enterprise-server-4.4.8-1.el7.x86_64<br>mongodb-enterprise-tools-4.4.8-1.el7.x86_64<br>mongodb-enterprise-database-tools-extra-4.4.8-1.el7.x86_64<br>mongodb-enterprise-4.4.8-1.el7.x86_64<br>mongodb-enterprise-shell-4.4.8-1.el7.x86_64<br>mongodb-enterprise-mongos-4.4.8-1.el7.x86_64<br>mongodb-database-tools-100.5.0-1.x86_64<br>mongodb-enterprise-cryptd-4.4.8-1.el7.x86_64<br></code></pre></td></tr></table></figure></li><li><p>å¯åŠ¨MongoDBæœåŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">systemctl start mongod.service<br></code></pre></td></tr></table></figure></li><li><p>éªŒè¯æœåŠ¡å¼€å¯</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vim">æ‰§è¡Œ: mongo<br>è¾“å‡ºï¼š MongoDB <span class="hljs-keyword">shell</span> <span class="hljs-keyword">version</span> v4.<span class="hljs-number">4.8</span><br>connecting <span class="hljs-keyword">to</span>: mongod<span class="hljs-variable">b:</span>//<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">27017</span>/?compressors=disabled&amp;gssapiServiceName=mongodb<br></code></pre></td></tr></table></figure><h2 id="å®‰è£…Nginx"><a href="#å®‰è£…Nginx" class="headerlink" title="å®‰è£…Nginx"></a>å®‰è£…Nginx</h2></li></ol><blockquote><p>å‚è€ƒ:<a href="https://juejin.cn/post/6844904134345228301">https://juejin.cn/post/6844904134345228301</a></p></blockquote><p>å®‰è£…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sudo yum -y install nginx   <span class="hljs-comment"># å®‰è£… nginx</span><br>sudo yum remove nginx  <span class="hljs-comment"># å¸è½½ nginx</span><br></code></pre></td></tr></table></figure><p>ä½¿ç”¨ yum è¿›è¡Œ Nginx å®‰è£…æ—¶ï¼ŒNginx é…ç½®æ–‡ä»¶åœ¨ /etc/nginx ç›®å½•ä¸‹ã€‚<br>é…ç½®Nginx æœåŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ sudo systemctl <span class="hljs-built_in">enable</span> nginx <span class="hljs-comment"># è®¾ç½®å¼€æœºå¯åŠ¨ </span><br>$ sudo service nginx start <span class="hljs-comment"># å¯åŠ¨ nginx æœåŠ¡</span><br>$ sudo service nginx stop <span class="hljs-comment"># åœæ­¢ nginx æœåŠ¡</span><br>$ sudo service nginx restart <span class="hljs-comment"># é‡å¯ nginx æœåŠ¡</span><br>$ sudo service nginx reload <span class="hljs-comment"># é‡æ–°åŠ è½½é…ç½®ï¼Œä¸€èˆ¬æ˜¯åœ¨ä¿®æ”¹è¿‡ nginx é…ç½®æ–‡ä»¶æ—¶ä½¿ç”¨</span><br><br></code></pre></td></tr></table></figure><h2 id="å®‰è£…git"><a href="#å®‰è£…git" class="headerlink" title="å®‰è£…git"></a>å®‰è£…git</h2><blockquote><p>å‚è€ƒ: <a href="https://segmentfault.com/a/1190000023077588">https://segmentfault.com/a/1190000023077588</a></p></blockquote><h2 id="å®‰è£…-npm-ä¾èµ–"><a href="#å®‰è£…-npm-ä¾èµ–" class="headerlink" title="å®‰è£… npm ä¾èµ–"></a>å®‰è£… npm ä¾èµ–</h2><h3 id="åœ¨ä½¿ç”¨npm-install-çš„æ—¶å€™æç¤º-core-js-pure-postinstall-æ‰§è¡Œå‡ºé”™"><a href="#åœ¨ä½¿ç”¨npm-install-çš„æ—¶å€™æç¤º-core-js-pure-postinstall-æ‰§è¡Œå‡ºé”™" class="headerlink" title="åœ¨ä½¿ç”¨npm install çš„æ—¶å€™æç¤º core-js-pure postinstall æ‰§è¡Œå‡ºé”™"></a>åœ¨ä½¿ç”¨npm install çš„æ—¶å€™æç¤º core-js-pure postinstall æ‰§è¡Œå‡ºé”™</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">core-js-pure@3.6.5 postinstall: `node -e <span class="hljs-string">&quot;try&#123;require(&#x27;./postinstall&#x27;)&#125;catch(e)&#123;&#125;&quot;</span>`<br>npm ERR! spawn ENOENT<br>npm ERR! <br>npm ERR! Failed at the core-js-pure@3.6.5 postinstall script.<br>npm ERR! This is probably not a problem with npm. There is likely additional logging output above.<br></code></pre></td></tr></table></figure><p>è§£å†³æ–¹å¼:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">npm i --unsafe-perm<br></code></pre></td></tr></table></figure><p>åŸå› ï¼š</p><p>npm å‡ºäºå®‰å…¨è€ƒè™‘ä¸æ”¯æŒä»¥ root ç”¨æˆ·è¿è¡Œï¼Œå³ä½¿ä½ ç”¨ root ç”¨æˆ·èº«ä»½è¿è¡Œäº†ï¼Œnpm ä¼šè‡ªåŠ¨è½¬æˆä¸€ä¸ªå« nobody çš„ç”¨æˆ·æ¥è¿è¡Œï¼Œè€Œè¿™ä¸ªç”¨æˆ·å‡ ä¹æ²¡æœ‰ä»»ä½•æƒé™ã€‚è¿™æ ·çš„è¯å¦‚æœä½ è„šæœ¬é‡Œæœ‰ä¸€äº›éœ€è¦æƒé™çš„æ“ä½œï¼Œæ¯”å¦‚å†™æ–‡ä»¶ï¼ˆå°¤å…¶æ˜¯å†™ /root/.node-gypï¼‰ï¼Œå°±ä¼šå´©æ‰äº†ã€‚</p><p>ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œè¦ä¹ˆæŒ‰ç…§ npm çš„è§„çŸ©æ¥ï¼Œä¸“é—¨å»ºä¸€ä¸ªç”¨äºè¿è¡Œ npm çš„é«˜æƒé™ç”¨æˆ·ï¼›è¦ä¹ˆåŠ  â€“unsafe-perm å‚æ•°ï¼Œè¿™æ ·å°±ä¸ä¼šåˆ‡æ¢åˆ° nobody ä¸Šï¼Œè¿è¡Œæ—¶æ˜¯å“ªä¸ªç”¨æˆ·å°±æ˜¯å“ªä¸ªç”¨æˆ·ï¼Œå³ä½¿æ˜¯ rootã€‚</p><p>æƒé™ä¸è¶³æŠ¥é”™æ—¶ä½¿ç”¨npmçš„å§¿åŠ¿ï¼š<br>sudo + å‘½ä»¤ + â€“unsafe-perm</p><p>emmmmâ€¦.</p><h3 id="åœ¨å›½å†…åŠ é€Ÿ-npm-å®‰è£…ä¾èµ–çš„"><a href="#åœ¨å›½å†…åŠ é€Ÿ-npm-å®‰è£…ä¾èµ–çš„" class="headerlink" title="åœ¨å›½å†…åŠ é€Ÿ npm å®‰è£…ä¾èµ–çš„"></a>åœ¨å›½å†…åŠ é€Ÿ npm å®‰è£…ä¾èµ–çš„</h3><p>åœ¨é¡¹ç›®æ ¹ç›®å½• åˆ›å»º<code>.npmrc</code>æ–‡ä»¶</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-comment"># é…ç½®æ·˜å®çš„ npm é•œåƒæº</span><br>registry=https:<span class="hljs-regexp">//</span>registry.npm.taobao.org<br></code></pre></td></tr></table></figure><h2 id="å‰ç«¯æ„å»ºç¯å¢ƒ"><a href="#å‰ç«¯æ„å»ºç¯å¢ƒ" class="headerlink" title="å‰ç«¯æ„å»ºç¯å¢ƒ"></a>å‰ç«¯æ„å»ºç¯å¢ƒ</h2><ol><li>babel+ webpack æ„å»ºæ—¶æŠ¥é”™ï¼šCanâ€™t resolve â€˜regenerator-runtime/runtimeâ€™<blockquote><p>å‚è€ƒï¼š<a href="https://stackoverflow.com/questions/58919016/babel-and-webpack-are-throwing-cant-resolve-regenerator-runtime-runtime">https://stackoverflow.com/questions/58919016/babel-and-webpack-are-throwing-cant-resolve-regenerator-runtime-runtime</a></p></blockquote></li></ol><p>ä¹‹å‰æ„å»ºæ˜¯æ­£å¸¸çš„å•Šï¼Œå¥‡æ€ªâ€¦å¯èƒ½åé¢é¡¹ç›®ä¸­ç”¨åˆ°äº†ä»€ä¹ˆæ–°è¯­æ³•å§</p><blockquote><p>æ³¨æ„æˆ‘é¡¹ç›®ä¸­çš„<code>babel</code>ç‰ˆæœ¬æ˜¯7.9</p></blockquote><p>è§£å†³ï¼šåªéœ€è¿è¡Œ npm i regenerator-runtime å°±å¯ä»¥ä¿®å¤å®ƒï¼Œ<br>å»çœ‹äº† babel å®˜ç½‘å…³äº<a href="https://babeljs.io/docs/en/babel-preset-env">useBuiltIns</a> è¿™ä¸ªé…ç½®é¡¹ï¼Œæ˜¯è¿™æ ·æè¿°çš„:</p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gradle">useBuiltIns: <span class="hljs-string">&#x27;entry&#x27;</span><br><br>&gt; Only use <span class="hljs-keyword">import</span> <span class="hljs-string">&quot;core-js&quot;</span>; and <span class="hljs-keyword">import</span> <span class="hljs-string">&quot;regenerator-runtime/runtime&quot;</span>;<br> åªä½¿ç”¨å¯¼å…¥â€œ core-jsâ€; å¯¼å…¥â€œ regenerator-<span class="hljs-keyword">runtime</span>/<span class="hljs-keyword">runtime</span>â€; åœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­åªä½¿ç”¨ä¸€æ¬¡<br></code></pre></td></tr></table></figure><p>è¯´å®è¯æˆ‘æ²¡è¯»æ‡‚â€¦</p><ol start="2"><li>gifsicle pre-build test failed</li></ol><p>å‚è€ƒï¼š<a href="https://github.com/frmachao/frmachao.github.io/issues/8">è®° gulp-imagemin å®‰è£…æ—¶é‡åˆ°çš„é—®é¢˜</a></p><h2 id="ngix-ä»£ç†è¯·æ±‚åˆ°-express-å¹¶å¼€å¯gzip"><a href="#ngix-ä»£ç†è¯·æ±‚åˆ°-express-å¹¶å¼€å¯gzip" class="headerlink" title="ngix ä»£ç†è¯·æ±‚åˆ° express å¹¶å¼€å¯gzip"></a>ngix ä»£ç†è¯·æ±‚åˆ° express å¹¶å¼€å¯gzip</h2><ul><li>æˆ‘çš„é…ç½®æ–‡ä»¶è·¯å¾„æ˜¯<code>/etc/nginx/nginx.conf</code></li><li>æˆ‘çš„express è¿è¡Œçš„ç«¯å£æ˜¯ 3000</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs bash">server &#123;<br>    gzip         on;<br>    listen       80;<br>    listen       [::]:80;<br>    server_name  _;<br>    root         /usr/share/nginx/html;<br><br>    <span class="hljs-comment"># Load configuration files for the default server block.</span><br>    include /etc/nginx/default.d/*.conf;<br>    location / &#123;<br>     proxy_pass    http://localhost:3000;<br>    &#125;<br><br>    error_page 404 /404.html;<br>    location = /404.html &#123;<br>    &#125;<br><br>    error_page 500 502 503 504 /50x.html;<br>    location = /50x.html &#123;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¿®æ”¹é…ç½®æ–‡ä»¶å æ‰§è¡Œ<code>sudo service nginx reload</code></p><h2 id="SEO-robots-txtæ–‡ä»¶é…ç½®"><a href="#SEO-robots-txtæ–‡ä»¶é…ç½®" class="headerlink" title="SEO robots.txtæ–‡ä»¶é…ç½®"></a>SEO robots.txtæ–‡ä»¶é…ç½®</h2><p>èµ·å› ï¼šæŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—å‘ç°ä¸æ–­æœ‰äººæœ‰è¯·æ±‚/robots.txt</p><p>æŸ¥è¯¢åå¾—çŸ¥ robots.txt æ–‡ä»¶è§„å®šäº†æœç´¢å¼•æ“æŠ“å–å·¥å…·å¯ä»¥è®¿é—®æ‚¨ç½‘ç«™ä¸Šçš„å“ªäº›ç½‘å€ã€‚ æ­¤æ–‡ä»¶ä¸»è¦ç”¨äºé¿å…æ‚¨çš„ç½‘ç«™æ”¶åˆ°è¿‡å¤šè¯·æ±‚ï¼›</p><p>robots.txt æ–‡ä»¶ä¸­çš„ä»¥ä¸‹æŒ‡ä»¤:</p><ol><li>user-agent: [å¿…éœ€ï¼Œæ¯ä¸ªç»„éœ€å«ä¸€ä¸ªæˆ–å¤šä¸ª User-agent æ¡ç›®] è¯¥æŒ‡ä»¤æŒ‡å®šäº†è§„åˆ™é€‚ç”¨çš„è‡ªåŠ¨å®¢æˆ·ç«¯ï¼ˆå³æœç´¢å¼•æ“æŠ“å–å·¥å…·ï¼‰çš„åç§°ã€‚è¿™æ˜¯æ¯ä¸ªè§„åˆ™ç»„çš„é¦–è¡Œå†…å®¹.</li><li>disallow: [æ¯æ¡è§„åˆ™éœ€å«è‡³å°‘ä¸€ä¸ªæˆ–å¤šä¸ª disallow æˆ– allow æ¡ç›®] æ‚¨ä¸å¸Œæœ›ç”¨æˆ·ä»£ç†æŠ“å–çš„ç›®å½•æˆ–ç½‘é¡µï¼ˆç›¸å¯¹äºæ ¹ç½‘åŸŸè€Œè¨€ï¼‰ã€‚</li><li>allow: [æ¯æ¡è§„åˆ™éœ€å«è‡³å°‘ä¸€ä¸ªæˆ–å¤šä¸ª disallow æˆ– allow æ¡ç›®] ä¸Šæ–‡ä¸­æåˆ°çš„ç”¨æˆ·ä»£ç†å¯ä»¥æŠ“å–çš„ç›®å½•æˆ–ç½‘é¡µï¼ˆç›¸å¯¹äºæ ¹ç½‘åŸŸè€Œè¨€ï¼‰ã€‚</li><li>itemap: [å¯é€‰ï¼Œæ¯ä¸ªæ–‡ä»¶å¯å«é›¶ä¸ªæˆ–å¤šä¸ª sitemap æ¡ç›®] ç›¸åº”ç½‘ç«™çš„ç«™ç‚¹åœ°å›¾çš„ä½ç½®ã€‚ç«™ç‚¹åœ°å›¾ç½‘å€å¿…é¡»æ˜¯å®Œå…¨é™å®šçš„ç½‘å€</li></ol><blockquote><p>å‚è€ƒï¼š<a href="https://developers.google.com/search/docs/advanced/robots/intro?hl=zh-cn">robots.txt ç®€ä»‹</a></p></blockquote><p>è¿™æ˜¯æˆ‘çš„ robots.txt ï¼š</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs dts">User-agent: *<br><span class="hljs-symbol">Disallow:</span> <span class="hljs-meta-keyword">/admin/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-meta-keyword">/manage/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-meta-keyword">/ajax/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-meta-keyword">/graphql/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-meta-keyword">/auth/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-meta-keyword">/api/</span><br><span class="hljs-symbol">Disallow:</span> <span class="hljs-meta-keyword">/account/</span><br><span class="hljs-symbol">Disallow:</span> *.php<br><span class="hljs-symbol">Disallow:</span> *.asp<br><span class="hljs-symbol">Disallow:</span> *.aspx<br></code></pre></td></tr></table></figure><h2 id="ä½¿ç”¨PM2éƒ¨ç½²é¡¹ç›®"><a href="#ä½¿ç”¨PM2éƒ¨ç½²é¡¹ç›®" class="headerlink" title="ä½¿ç”¨PM2éƒ¨ç½²é¡¹ç›®"></a>ä½¿ç”¨PM2éƒ¨ç½²é¡¹ç›®</h2><blockquote><p>ä»€ä¹ˆæ˜¯PM2: PM2 æ˜¯ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ç®¡ç†å™¨ï¼Œå®ƒå°†å¸®åŠ©æ‚¨ç®¡ç†å’Œä¿æŒæ‚¨çš„åº”ç”¨ç¨‹åºåœ¨çº¿</p></blockquote><p>å¿«é€Ÿä½¿ç”¨ï¼š</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-built_in">npm</span> install pm2@latest -g<br>pm2 start app.js<br></code></pre></td></tr></table></figure><p>æˆ‘åœ¨é¡¹ç›®ä¸­çš„ä½¿ç”¨: åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª <code>pm2_start.sh</code> æ–‡ä»¶ï¼Œæ¯æ¬¡æäº¤åé¡¹ç›®åï¼Œå†æœåŠ¡å™¨ç¯å¢ƒä¸­æ‰§è¡Œ <code>sh pm2_start.sh</code></p><p>Todo: æˆ‘çš„è¿™ç§ä¸æ˜¯å¥½çš„éƒ¨ç½²æ–¹å¼</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ‹‰å–gitä»“åº“&quot;</span><br>git pull<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å®‰è£…å‰ç«¯é¡¹ç›®ä¾èµ–&quot;</span><br>npm i <span class="hljs-params">--unsafe-perm</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;å®‰è£…åç«¯é¡¹ç›®ä¾èµ–&quot;</span><br><span class="hljs-keyword">cd</span> server/ &amp;&amp; npm i <span class="hljs-params">--unsafe-perm</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ„å»ºå‰ç«¯&quot;</span><br><span class="hljs-keyword">cd</span> <span class="hljs-string">../</span> &amp;&amp; npm run build <span class="hljs-params">--unsafe-perm</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ„å»ºåç«¯&quot;</span><br><span class="hljs-keyword">cd</span> server &amp;&amp; npm run build <span class="hljs-params">--unsafe-perm</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;æ€æ‰æ‰€æœ‰pm2&quot;</span><br>pm2 kill<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;pm2 å¯åŠ¨ node ç¨‹åº&quot;</span><br>NODE_ENV=production pm2 start dist/app.js<br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;è®¾ç½® centos å¼€æœºå¯åŠ¨ pm2&quot;</span><br>pm2 startup<br>pm2 save<br></code></pre></td></tr></table></figure><h2 id="åç«¯æ„å»ºé‡åˆ°çš„é—®é¢˜ï¼š"><a href="#åç«¯æ„å»ºé‡åˆ°çš„é—®é¢˜ï¼š" class="headerlink" title="åç«¯æ„å»ºé‡åˆ°çš„é—®é¢˜ï¼š"></a>åç«¯æ„å»ºé‡åˆ°çš„é—®é¢˜ï¼š</h2><h3 id="Command-failed-bin-sh-c-autoreconf-ivf-gifsicle-postinstall"><a href="#Command-failed-bin-sh-c-autoreconf-ivf-gifsicle-postinstall" class="headerlink" title="Command failed: /bin/sh -c autoreconf -ivf gifsicle postinstall"></a><code>Command failed: /bin/sh -c autoreconf -ivf gifsicle postinstall</code></h3><p>åŸå› ï¼šWe are using imagemin-gifsicle and therefore gifsicle-bin as part of our build. With the release 5.0.0, the linux bin files got removed. As consequence of that removal, our build does not work anymore on the CI Server. (The build tries to rebuild gifcicle and misses autoreconf for that..)</p><p>è§£å†³æ–¹å¼: </p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs angelscript">Linux:<br>sudo apt-<span class="hljs-keyword">get</span> install libtool <span class="hljs-built_in">auto</span>make <span class="hljs-built_in">auto</span>conf nasm<br><span class="hljs-comment">// centos ä¸Š ä½¿ç”¨ yum æ¥å®‰è£…: sudo yum install libtool automake autoconf nasm</span><br>OS X:<br>brew install libtool <span class="hljs-built_in">auto</span>make <span class="hljs-built_in">auto</span>conf nasm<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ä»£ç äººç”Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>æœåŠ¡ç«¯éƒ¨ç½²</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åšå®¢ SEO ä¼˜åŒ–</title>
    <link href="/posts/df28a7c5/"/>
    <url>/posts/df28a7c5/</url>
    
    <content type="html"><![CDATA[<h2 id="é…ç½®ç«™ç‚¹åœ°å›¾"><a href="#é…ç½®ç«™ç‚¹åœ°å›¾" class="headerlink" title="é…ç½®ç«™ç‚¹åœ°å›¾"></a>é…ç½®ç«™ç‚¹åœ°å›¾</h2><ul><li>é€šè¿‡ hexo-generator-sitemap æ’ä»¶ç”Ÿæˆç«™ç‚¹åœ°å›¾ </li><li><a href="https://blog.frmachao.top/sitemap.xml">https://blog.frmachao.top/sitemap.xml</a><h2 id="é…ç½®-robots-txt-æ–‡ä»¶"><a href="#é…ç½®-robots-txt-æ–‡ä»¶" class="headerlink" title="é…ç½® robots.txt æ–‡ä»¶"></a>é…ç½® robots.txt æ–‡ä»¶</h2></li><li>ç½‘ç«™æ ¹ç›®å½•æ·»åŠ  robots.txt æ–‡ä»¶</li><li><a href="https://blog.frmachao.top/robots.txt">https://blog.frmachao.top/robots.txt</a><h2 id="è°·æ­Œæ”¶å½•"><a href="#è°·æ­Œæ”¶å½•" class="headerlink" title="è°·æ­Œæ”¶å½•"></a>è°·æ­Œæ”¶å½•</h2>åœ¨ <a href="https://search.google.com/search-console">search.google.com</a> ä¸­ä½¿ç”¨<code>html æ ‡è®°</code>çš„æ–¹å¼åˆ†åˆ«æ”¶å½•äº† <code>blog.frmachao.top</code> å’Œ <code>frmachao.top</code> ä¸¤ä¸ªç«™ç‚¹</li></ul><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2023-04-09-2xHj0F.png" alt="htmlæ ‡è®°æ”¶å½•"></p><p>ä¸»åŠ¨æäº¤ç«™ç‚¹åœ°å›¾</p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2023-04-09-OwcxWJ.png" alt="æäº¤ç«™ç‚¹åœ°å›¾"></p>]]></content>
    
    
    <categories>
      
      <category>ç¬”è®°æœ¬</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
      <tag>åšå®¢</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®°å½•ä»é£ŸæŒ‡ä¼¸è‚Œè…±æ‰‹æœ¯åç”²æ ¹é•¿æœŸæ„ŸæŸ“ä¸æ„ˆåˆåˆ°äºŒæ¬¡æ‰‹æœ¯çš„è¿‡ç¨‹</title>
    <link href="/posts/9d3837ea/"/>
    <url>/posts/9d3837ea/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å¤šå›¾é¢„è­¦ï¼š æœ¬æ–‡ä¸­å«æœ‰å¤§é‡æ‰‹æŒ‡æµè¡€æ„ŸæŸ“çš„å›¾ç‰‡ï¼Œå¯èƒ½ä¼šå¼•èµ·è¯»è€…ç”Ÿç†æ€§ä¸é€‚</p></blockquote><p><strong>å…ˆè¯´ä¸ªäººç»“è®ºï¼š</strong><br>åœ¨äººå‡åŒ»ç–—èµ„æºç´§ç¼ºçš„èƒŒæ™¯ä¸‹ï¼šå¤§å‹åŒ»é™¢çš„åŒ»ç”Ÿå¾€å¾€ä»¥æ‰‹æœ¯ä¸ºå¯¼å‘ï¼Œå¯¹äºä¸éœ€è¦æ‰‹æœ¯çš„ç—…äººï¼Œå¾€å¾€å‡ å¥æ¶ˆæ¯’æ³¨æ„å«ç”Ÿå°±æ‰“å‘èµ°äº†ç—…äººï¼Œç”šè‡³æ²¡æœ‰ä½“æ ¼æ£€æŸ¥è¿™ç±»ä¼šå ç”¨åŒ»ç”Ÿå®è´µé—¨è¯Šæ—¶é—´çš„è¡Œä¸ºã€‚</p><h2 id="æ—¶é—´çº¿"><a href="#æ—¶é—´çº¿" class="headerlink" title="æ—¶é—´çº¿"></a>æ—¶é—´çº¿</h2><p><strong>2021å¹´3æœˆä»½</strong>åœ¨å››å·æˆéƒ½çš„ <a href="http://scxdyy.com/">å››å·ç°ä»£åŒ»é™¢</a> æ¥å—äº†é£ŸæŒ‡ä¼¸è‚Œè…±é”®å¸½ä¿®å¤ï¼Œ3æœˆ5å·æ‰‹æœ¯ï¼Œä½é™¢5å¤©ï¼Œæœ¯åçŸ³è†å›ºå®š3å¤©ï¼Œç„¶åæ¢æˆæ”¯å…·å›ºå®šã€‚ï¼ˆ3æœˆ5å·æ‰‹æœ¯çš„åŸå› æˆ‘ä¼šå•ç‹¬å†™ä¸€ç¯‡æ–‡ç« æ¥è®°å½•ï¼Œåªèƒ½è¯´æ˜¯ä¸€æ¬¡æƒ¨ç—›çš„æ•™è®­ï¼‰</p><p>æœ¯åç¬¬ä¸‰å¤©æ‹†çŸ³è†æˆ‘æ„Ÿè§‰æ˜¯é£ŸæŒ‡ç”²æ ¹å¤„æœ‰äº›è‚¿ç—›ï¼ˆä¸‹å›¾ï¼‰ï¼Œäºæ˜¯è¯¢é—®äº†æŸ¥æˆ¿åŒ»ç”Ÿï¼ŒåŒ»ç”Ÿçœ‹åè¯´æ²¡æœ‰é—®é¢˜è¿‡å‡ å¤©å°±å¥½äº†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/VQE2wm.jpg" alt="VQE2wm"></p><p><strong>2021å¹´3æœˆ30å· æ‰‹æœ¯å25å¤©</strong> æ‹†é™¤æ”¯å…· ï¼ˆä¸‹å›¾ï¼‰å‘ç°ç”²æ ¹å¤„å¼€å§‹çº¢è‚¿æŒ‡ç”²æ²¡æœ‰ç”Ÿé•¿ç—•è¿¹ï¼ŒæŒ‰å‹æ„Ÿè§‰åˆºç—›ï¼Œå½“å¤©å»åŒ»é™¢é—¨è¯Šæ‰¾åŒ»ç”Ÿæ£€æŸ¥ï¼ŒåŒ»ç”Ÿå‘ŠçŸ¥è‡ªå·±æ²¡æœ‰åœ¨ä¸´åºŠé‡åˆ°è¿‡ï¼Œä½†æ˜¯æ¨æµ‹æ˜¯çœŸèŒæ„ŸæŸ“ç”²æ ¹ï¼Œè®©æˆ‘å›å®¶æ³¨æ„å«ç”Ÿå¤šè§‚å¯Ÿï¼Œå®šæœŸæ¥åŒ»é™¢å¤æŸ¥ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/h5ncYE.jpg" alt="h5ncYE"></p><p><strong>2021å¹´4æœˆ15å· æ‰‹æœ¯41å¤©</strong> æŒ‡ç”²å¼€å§‹ç”Ÿé•¿ï¼Œä½†æ˜¯ç”²æ ¹å¤„çº¢è‚¿åŠ å…·ã€‚å»åŒ»é™¢è¯¢é—®æ‰‹æœ¯åŒ»ç”Ÿï¼Œç­”å¤ä¾ç„¶æ˜¯æ³¨æ„æ‰‹éƒ¨å«ç”Ÿã€‚ç°åœ¨å›æƒ³ åŒ»ç”Ÿæ˜¯ä¸æ˜¯æ²¡æœ‰ä¸Šå¿ƒå»å¤„ç†å‘¢ï¼Œè¿˜æ˜¯è¯´è¿™æ—¶çœŸçš„æ²¡ä»€ä¹ˆå¥½å¤„ç†çš„ï¼Œåªèƒ½æ³¨æ„å«ç”Ÿï¼Ÿ</p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/Al01Cp.jpg" alt="Al01Cp"></p><p><strong>2021å¹´5æœˆ5æ—¥ æ‰‹æœ¯å61å¤©</strong> ç”²æ ¹å¤„å¼€å§‹æœ‰æ·¡é»„è‰²æ¶²ä½“æ¸—å‡ºï¼ˆä¸‹å›¾ï¼‰ï¼Œè¿™æ—¶æˆ‘å·²ç»ç¦»å¼€æˆéƒ½è¿”å›å¾å·ã€‚å¾®ä¿¡åœ¨çº¿å’¨è¯¢æ‰‹æœ¯åŒ»ç”Ÿï¼ŒåŒ»ç”Ÿè¿™æ—¶å»ºè®®æ‹”ç”²æ²»ç–—ï¼Œä½†æ˜¯æˆ‘ä¸æƒ³å†å¯¹æ‰‹æŒ‡é€ æˆä¼¤å®³ï¼ˆæ‹”ç”²è¦åˆ‡å¼€å‘¨å›´çš®è‚¤ï¼Œæ‹”é™¤åé‡æ–°ç”Ÿé•¿çš„è¿‡ç¨‹ä¹Ÿå¾ˆç—›è‹¦ï¼‰ï¼Œæˆ‘å†³å®šç»§ç»­ä¿å®ˆæ²»ç–—ã€‚å»äº†å½“åœ°åŒ»é™¢æ‰‹å¤–ç§‘é—¨è¯Šï¼Œè¢«å‘ŠçŸ¥åªéœ€è¦æ¯å¤©ç”¨ç¢˜ä¼æµ¸æ³¡ä¸€ä¼šå³å¯ï¼Œå°½é‡ä¸è¦ç¢°åˆ°æ°´ï¼Œæˆ–è€…ç¢°æ°´åç«‹åˆ»æ¶ˆæ¯’ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/BUMbLd.jpg" alt="BUMbLd"></p><p><strong>2021å¹´5æœˆ15å· æœ¯å71å¤©</strong> æ¯å¤©æ¶ˆæ¯’é¿å…æ‚£å¤„ç¢°æ°´ï¼ŒåšæŒäº†10å¤©å‘ç°æƒ…å†µåœ¨ä¸æ–­æ¶åŒ–ï¼Œä¾¿å»äº†å½“åœ°ä¸‰ç”²åŒ»é™¢ <a href="https://www.xzch.cn/">å¾å·å¸‚ç¬¬å››äººæ°‘åŒ»é™¢</a> å°±è¯Šã€‚æˆ‘è®°å¾—å½“æ—¶ç‰¹æ„æŒ‚çš„ä¸“å®¶é—¨è¯Šï¼Œå¤§æ¦‚4ç‚¹ä¸´è¿‘ä¸‹ç­å»äº†è¯Šå®¤ã€‚</p><p>æˆ‘ï¼šâ€œåŒ»ç”Ÿï¼Œæˆ‘è¿™æ‰‹æŒ‡å¤´åœ¨æ‰‹æœ¯åä¸€ç›´çº¢è‚¿ï¼Œæœ¯åä¸€ä¸ªæœˆåå¼€å§‹æ¸—å‡ºæ¶²ä½“â€œ</p><p>é—¨è¯ŠåŒ»ç”Ÿï¼šâ€œå“¦ï¼Œä½ å…ˆæ‹ä¸ªå½©è¶…â€œ</p><p>æˆ‘ï¼šâ€œåŒ»ç”Ÿæ‚¨ä¸åšä¸ªä½“æ ¼æ£€æŸ¥ï¼Œå…ˆçœ‹çœ‹å˜›ï¼Œä½ çœ‹æˆ‘è¿™ç”²æ ¹å¤„æŒ‰å‹ä¼šæœ‰æ¶²ä½“æµå‡ºï¼Œæ‚¨èƒ½ä¸èƒ½å‘Šè¯‰æˆ‘è¿™æ˜¯ä»€ä¹ˆç–¾ç—…â€</p><p>é—¨è¯ŠåŒ»ç”Ÿï¼šâ€œä½ åˆ«è¿™è·Ÿæˆ‘å” å¨äº†ï¼Œä½ å¿«å»åšæ£€æŸ¥ï¼Œä¸ç„¶å¾…ä¼šå°±ä¸‹ç­äº†â€</p><p>æˆ‘ï¼šâ€œåŒ»ç”Ÿä½ ä¸ºä»€ä¹ˆå‚¬æˆ‘ï¼Œç°åœ¨ä¹Ÿæ²¡æœ‰å…¶ä»–ç—…äººï¼ˆæ­¤æ—¶è¯Šå®¤åªæœ‰æˆ‘è·ŸåŒ»ç”Ÿä¸¤ä¸ªäººï¼Œå¤–é¢ä¹Ÿæ²¡æœ‰å€™è¯Šçš„ç—…äººï¼‰â€</p><p>ä¸æ„‰å¿«åï¼Œå»æ’é˜Ÿåšäº†å½©è¶…æ£€æŸ¥ï¼Œåšå®Œç«‹å³å‡ºæ¥æŠ¥å‘Šã€‚æˆ‘æ‹¿ç€æŠ¥å‘Šå»è¯Šå®¤æ‰¾åŒ»ç”Ÿï¼Œç»“æœåŒ»ç”Ÿæå‰æºœå›ç—…æˆ¿äº†ï¼Œæˆ‘èµ¶å¿™è·‘å»ç—…æˆ¿ï¼Œæ‰¾åˆ°åŒ»ç”Ÿã€‚<br>åŒ»ç”Ÿçœ‹å®ŒæŠ¥å‘Šè¯´ï¼šâ€œä¸‹é¢é•¿äº†ä¸ªå›Šè‚¿ï¼Œä½ å‡†å¤‡åŠä½é™¢æ‰‹æœ¯å§â€</p><p>æˆ‘ï¼šï¼Ÿï¼Ÿï¼Ÿ æ‰‹æœ¯ï¼Ÿå›Šè‚¿ï¼Ÿå¿ƒæƒ³æŒ‡ç”²æ ¹å“ªé‡Œæ¥çš„å›Šè‚¿ï¼Œä¸»è¦è¿™åŒ»ç”Ÿç»™æˆ‘çš„æ„Ÿè§‰å¾ˆå·®ï¼Œæˆ‘å€Ÿå£è¯´å›å®¶æƒ³æƒ³ï¼Œä¾¿ç¦»å¼€äº†åŒ»é™¢</p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/x9Tmi4.jpg" alt="x9Tmi4"></p><p><strong>ç¬¬äºŒå¤© 5æœˆ16 æ—¥</strong>ï¼Œå»äº†å½“åœ°ä¸€å®¶æ‰‹å¤–ä¼¤è§é•¿çš„ä¸“ç§‘åŒ»é™¢ <a href="http://www.xzrcyy.com/">å¾å·ä»æ…ˆåŒ»é™¢</a> åŒæ ·æ˜¯ä¸“å®¶é—¨è¯Šã€‚ç®€å•å‘ŠçŸ¥ç—…æƒ…åï¼ŒåŒ»ç”Ÿæ·¡æ·¡çš„è¯´ï¼šâ€œå½“æ—¶æ‰“çŸ³è†äº†å§ï¼Œæ‰“çŸ³è†åå°±å®¹æ˜“å‡ºç°è¿™ç§æƒ…å†µï¼Œä½ æ¯å¤©ç”¨é…’ç²¾æ³¡æ³¡ï¼Œè¦æ˜¯ä¸¥é‡äº†å†è¿‡æ¥â€ï¼Œè¯éŸ³åˆšè½ åŒ»ç”Ÿå°±å«äº†ä¸‹ä¸€ä½å€™è¯Šçš„ç—…äººè¿‡æ¥ã€‚</p><p><strong>5æœˆ17æ—¥</strong> æˆ‘åˆå»äº† å½“åœ°å¦å¤–ä¸€å®¶ä¸‰ç”²åŒ»é™¢ <a href="http://www.xzzlyy.com/">å¾å·å¸‚è‚¿ç˜¤åŒ»é™¢</a> ï¼ŒåŒæ ·æ˜¯æŸæŸä¸“å®¶ä¸»ä»»ï¼Œè¿™ä½åŒ»ç”Ÿä¹Ÿæ˜¯è¯´ç”¨é…’ç²¾æµ¸æ³¡ æ¯æ¬¡æµ¸æ³¡10åˆ†é’Ÿã€‚è¿™æ¬¡æˆ‘çªç„¶æ„Ÿè§‰æœ‰å¸Œæœ›äº†ï¼Œä¸¤ä¸ªåŒ»ç”Ÿç»™çš„æ–¹æ³•ä¸€æ ·ï¼Œä½†æ˜¯æ²¡æƒ³åˆ°è¿™å¹¶ä¸æ˜¯æ­£ç¡®çš„æ–¹å¼ã€‚<br>2021å¹´ 5æœˆ30å· æŒ‡ç”²ç»§ç»­æ¶åŒ–ï¼Œå¼€å§‹æµè¡€æ°´ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/8QqkwE.jpg" alt="8QqkwE"></p><p>åˆ°è¿™é‡Œï¼Œæˆ‘åœ¨å½“åœ°ä¸€å…±å»äº†å››æ¬¡åŒ»é™¢ï¼ŒæŒ‡ç”²çš„æƒ…å†µä¸€æ¬¡æ¯”ä¸€æ¬¡æ¶åŒ–ï¼Œä½†æ˜¯æ²¡æœ‰ä¸€ä½é—¨è¯ŠåŒ»ç”Ÿç»™æˆ‘çš„æ‰‹æŒ‡åšæ¸…åˆ›åŒ…æ‰å¤„ç†ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/4O2vx9.jpg" alt="4O2vx9"></p><p><strong>åœ¨2021å¹´6æœˆ12å·</strong> æ‰‹æŒ‡ä¸æ–­æ¶åŒ–å¼€å§‹æœ‰è„“æµå‡ºï¼Œæˆ‘å»äº†åŒ»é™¢æ€¥è¯Šã€‚è½¬æŠ˜æ¥äº†ï¼Œæ€¥è¯ŠåŒ»ç”Ÿå«æ¥æ‰‹å¤–ç§‘åŒ»ç”Ÿä¼šè¯Šï¼Œå¸®æˆ‘æˆ‘æ¸…ç†äº†ä¼¤å£è¿›è¡ŒåŒ…æ‰ï¼Œå¹¶å¼€äº†ä¸¤å¤©çš„æŠ—ç”Ÿç´ é™è„‰æ³¨å°„ã€‚åŒ»ç”Ÿå®å˜±ï¼Œç¬¬ä¸€å‘¨æ¯å¤©æ¢ä¸€æ¬¡è¯ï¼Œç¬¬äºŒå‘¨ä¸‰å¤©æ¢ä¸€æ¬¡è¯ï¼Œä¸¤å‘¨åå¦‚æœè¿˜æ²¡æœ‰æ„ˆåˆå»ç—…æˆ¿æ‰¾ä»–ï¼Œæˆ‘ä»¿ä½›æŠ“åˆ°äº†æ•‘å‘½ç¨»è‰ï¼Œèµ¶ç´§åŠ äº†åŒ»ç”Ÿå¾®ä¿¡ã€‚</p><p>6æœˆ13å·æ¢è¯å:</p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/8db10C.jpg" alt="8db10C"></p><p><strong>2021å¹´6æœˆ28æ—¥ æ‰‹æœ¯å115å¤©</strong>ä¸å¹¸çš„æ˜¯ï¼Œä¸¤å‘¨åæ‰‹æŒ‡ä¾ç„¶æ²¡æœ‰æ„ˆåˆï¼Œå»åŒ»é™¢åŠç†äº†ä½é™¢ï¼Œæ‰‹æœ¯å‰åŒ»ç”Ÿç»™é‡‡é›†äº†ä¼¤å£éƒ¨åˆ†ç»„ç»‡é€å»åšç»†èŒåŸ¹å…»ã€‚6æœˆ28æ—¥ä¸‹åˆ æ‰‹æœ¯â€¦. æŒ‡ç”²æœ€ç»ˆæ²¡æœ‰ä¿ä½ï¼Œä¸¤ä¾§åˆ‡å¼€å</p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/A2f4mK.jpg" alt="A2f4mK"><br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/sru5is.jpg" alt="sru5is"></p><p>æ‰‹æœ¯ååœ¨ç—…æˆ¿ä½é™¢ä¸€å‘¨ï¼Œå‰ä¸‰å¤©åŒ»ç”Ÿç»™äºˆæŠ—ç”Ÿç´ é™è„‰æ³¨å°„ï¼Œä½†æˆ‘å¤´å­¢çš®è¯•è¿‡æ•ï¼Œäºæ˜¯é€‰ç”¨äº†é’éœ‰ç´ ç±»è¯ç‰©ã€‚</p><p>æ‰‹æœ¯åç¬¬ä¸€æ¬¡æ¢è¯ï¼šä½“ä¼šåˆ°äº†â€œåæŒ‡è¿å¿ƒâ€ï¼Œå¤±å»äº†æŒ‡ç”²çš„ä½ç½®åŠå…¶æ•æ„Ÿï¼Œç—›åˆ°è„šè½¯æµæ±—ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/qumxhw.jpg" alt="qumxhw"></p><p>å¥½åœ¨ç¬¬äºŒæ¬¡æ¢è¯æ—¶åŒ»ç”Ÿç”¨ä¸€å—æ²¹çº±ç›–åœ¨äº†æŒ‡ç”²ä¸Šï¼Œæ­¤åçš„æ¢è¯å°±æ²¡é‚£ä¹ˆç—›è‹¦äº†ï¼Œæ‰€ä»¥ç°åœ¨å›å¿†èµ·æ¥å†³å®šå¥½åƒä¹Ÿæ²¡æœ‰é‚£ä¹ˆç—›è‹¦ã€‚åæ¥çŸ¥é“ è¿™ç§å¿ƒç†è¢«è¯ºè´å°”å¥–å¾—ä¸» ä¸¹å°¼å°”Â·å¡å°¼æ›¼ï¼ˆDaniel Kahnemanï¼‰å« <a href="https://baike.baidu.com/item/%E5%B3%B0%E7%BB%88%E5%AE%9A%E5%BE%8B/6345450">â€œå³°ç»ˆå®šå¾‹ï¼ˆPeak-End ruleï¼‰â€œ</a>ï¼Œå³åªè®¡ç®—åœ¨ä¸¤ä¸ªæ—¶åˆ»ä½“éªŒåˆ°çš„å¹³å‡ç–¼ç—›ï¼Œå³è¿‡ç¨‹ä¸­æœ€ç³Ÿç³•çš„ä¸€ä¸ªæ—¶åˆ»å’Œæœ€åæ—¶åˆ»ã€‚</p><p>â€œäººå¥½åƒæœ‰ä¸¤ä¸ªä¸åŒçš„è‡ªæˆ‘ï¼šä½“éªŒçš„è‡ªæˆ‘å¹³ç­‰åœ°å¿å—æ¯æ—¶æ¯åˆ»çš„ä½“éªŒï¼Œè€Œè®°å¿†çš„è‡ªæˆ‘äº‹åå‡ ä¹æŠŠå…¨éƒ¨çš„åˆ¤æ–­æƒé‡æ”¾åœ¨ä¸¤ä¸ªæ—¶åˆ»ä¸Šï¼Œå³æœ€ç³Ÿç³•çš„æ—¶åˆ»å’Œæœ€åçš„æ—¶åˆ»ã€‚å³ä¾¿åœ¨ç»“æœå¼‚å¸¸çš„æƒ…å†µä¸‹ï¼Œè®°å¿†çš„è‡ªæˆ‘ä¹Ÿä¼¼ä¹åšæŒå³°ç»ˆå®šå¾‹ã€‚å³ä¾¿åˆšåˆšç»å—äº†åŠä¸ªå¤šå°æ—¶çš„é«˜æ°´å¹³ç–¼ç—›ï¼Œåªè¦åœ¨åŒ»ç–—è¿‡ç¨‹ç»“æŸæ—¶æœ‰é‚£ä¹ˆå‡ åˆ†é’Ÿä¸ç—›ï¼Œç—…äººå¯¹æ€»ä½“ç–¼ç—›çš„è¯„ä»·å°±ä¼šæˆå‰§æ€§åœ°é™ä½ã€‚â€œ</p><blockquote><p>è¦†ç›–åœ¨æŒ‡å¤´ä¸Šçš„æ²¹çº±</p></blockquote><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/DaYgei.jpg" alt="DaYgei"></p><p>ä¸‰å¤©åç»†èŒåŸ¹å…»çš„æŠ¥å‘Šå‡ºæ¥ï¼Œæ²¡æœ‰æ„ŸæŸ“ç‰¹åˆ«çš„ç»†èŒï¼ŒåŒæ—¶ä¸‰å¤©çš„é’éœ‰ç´ æ³¨å°„ä¹Ÿè®©æ‰‹æŒ‡çš„ç‚ç—‡å¾—ä»¥æ§åˆ¶æ²¡æœ‰å‡ºç°æœ¯åæ„ŸæŸ“ã€‚äº‹æƒ…ä¼¼ä¹å†å¾€å¥½çš„æ–¹å‘å‘å±•ï¼Œä½†æ˜¯è¿™æ—¶æœ‰äº†æ–°çš„é—®é¢˜ï¼šX å…‰å½±åƒæŠ¥å‘Šæ˜¾ç¤ºæ‰‹æŒ‡éª¨å¯†åº¦å¼‚å¸¸ï¼ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/7Bhd5e.jpg" alt="7Bhd5e"></p>]]></content>
    
    
    <categories>
      
      <category>ç¬”è®°æœ¬</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¥åº·</tag>
      
      <tag>æ‰‹æœ¯</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è®°ä¸€æ¬¡nodeçˆ¬è™«ç»å†</title>
    <link href="/posts/332c06cc/"/>
    <url>/posts/332c06cc/</url>
    
    <content type="html"><![CDATA[<h2 id="éœ€æ±‚è¯´æ˜"><a href="#éœ€æ±‚è¯´æ˜" class="headerlink" title="éœ€æ±‚è¯´æ˜"></a>éœ€æ±‚è¯´æ˜</h2><ul><li>è®¿é—®ç½‘ç«™</li><li>è·å–åˆ—è¡¨é¡µæ•°æ®</li><li>å¾ªç¯åˆ—è¡¨é¡µæ•°æ®è·å–æ¯æ¡æ•°æ®å¯¹åº”çš„è¯¦æƒ…é¡µæ•°æ®<ul><li>æœºæ„åç§°</li><li>æœºæ„ç±»å‹</li><li>æœºæ„æ€§è´¨</li><li>è”ç³»äºº</li><li>å›ºå®šç”µè¯</li><li>è”ç³»ç”µè¯</li><li>è”ç³»åœ°å€</li></ul></li><li>å¯¼å‡º excel</li></ul><h2 id="å¼€å‘ç¯å¢ƒ"><a href="#å¼€å‘ç¯å¢ƒ" class="headerlink" title="å¼€å‘ç¯å¢ƒ"></a>å¼€å‘ç¯å¢ƒ</h2><ul><li>Mac OS v10.15.7</li><li>node v12.16.1</li><li>ç”¨åˆ° npm åŒ…</li></ul><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs json">&quot;dependencies&quot;: &#123;<br>  &quot;async&quot;: &quot;^3.2.0&quot;,<br>  &quot;cheerio&quot;: &quot;^1.0.0-rc.5&quot;,<br>  &quot;json2xls&quot;: &quot;^0.1.2&quot;,<br>  &quot;nodemon&quot;: &quot;^2.0.7&quot;,<br>  &quot;puppeteer-core&quot;: &quot;^8.0.0&quot;,<br>  &quot;request&quot;: &quot;^2.88.2&quot;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="å‡†å¤‡å·¥ä½œ"><a href="#å‡†å¤‡å·¥ä½œ" class="headerlink" title="å‡†å¤‡å·¥ä½œ"></a>å‡†å¤‡å·¥ä½œ</h2><ul><li>cheerio å­¦ä¹ æ“ä½œè¯­æ³• åŸºæœ¬è·Ÿ jQuery ä¸€è‡´</li><li>request è¯·æ±‚æ¨¡å—çš„åŸºæœ¬ä½¿ç”¨</li><li>puppeteer æ— å¤´æµè§ˆå™¨çš„åŸºæœ¬ä½¿ç”¨</li><li>node fs æ–‡ä»¶æ¨¡å—çš„åŸºæœ¬ä½¿ç”¨</li></ul><h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜:"></a>é‡åˆ°çš„é—®é¢˜:</h2><h3 id="é¡µé¢ä¸­çš„æ•°æ®æ˜¯-ajax-åŠ è½½å‡ºæ¥çš„"><a href="#é¡µé¢ä¸­çš„æ•°æ®æ˜¯-ajax-åŠ è½½å‡ºæ¥çš„" class="headerlink" title="é¡µé¢ä¸­çš„æ•°æ®æ˜¯ ajax åŠ è½½å‡ºæ¥çš„"></a>é¡µé¢ä¸­çš„æ•°æ®æ˜¯ ajax åŠ è½½å‡ºæ¥çš„</h3><p>åˆšå¼€å§‹ä½¿ç”¨ request ç›´æ¥è¯·æ±‚é¡µé¢ï¼Œå‘ç°å“åº”å›æ¥çš„ html æ–‡æ¡£å¹¶ä¸æ˜¯å®Œæ•´çš„ï¼Œé¡µé¢ä¸Šæœ‰ ajax è¯·æ±‚ï¼ŒåŠ¨æ€ç”Ÿæˆäº†ä¸€éƒ¨åˆ† DOM , æˆ‘åŸæœ¬æƒ³åˆ†æå®ƒè¿™ä¸ª ajax è¯·æ±‚çš„æ¥å£ï¼Œå‘ç°è¯·æ±‚åœ°å€ä¸Šæœ‰ä¸ªæŸ¥è¯¢å­—ç¬¦ä¸²,åƒè¿™æ ·ï¼š<br><code>?ajaxtype=yanglaoxx_showlianxi&amp;rand=0.17592822223231708</code><br>ä¸æ‡‚è¿™ä¸ª rand å€¼æ˜¯æ€ä¹ˆè®¡ç®—å‡ºæ¥çš„ï¼Œå®åœ¨ä¸æƒ³å†å»æ‰’ç½‘ç«™ js çš„ä»£ç ï¼Œäºæ˜¯æƒ³åˆ°ç”¨æ— å¤´æµè§ˆå™¨æ¥æ¸²æŸ“å®Œæ•´ç½‘é¡µï¼›</p><p>è¿™é‡Œæˆ‘ä½¿ç”¨ puppeteer æ¸²æŸ“å®Œæ•´çš„ç½‘é¡µ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">await</span> page.goto(url, &#123;<br>  waitUntil: <span class="hljs-string">&quot;networkidle0&quot;</span>, <span class="hljs-comment">// ç­‰å¾…ç½‘é¡µä¸Šæ‰€æœ‰ç½‘ç»œè¯·æ±‚ç»“æŸ</span><br>&#125;);<br><span class="hljs-keyword">const</span> html = <span class="hljs-keyword">await</span> page.content();<br>fs.writeFileSync(<span class="hljs-string">&quot;./loacl.html&quot;</span>, html); <span class="hljs-comment">// å°† puppeteer è¯·æ±‚å›æ¥çš„é¡µé¢å¦å­˜ä¸ºæœ¬åœ°çš„htmlæ–‡ä»¶ï¼Œæ–¹ä¾¿æŸ¥çœ‹é¡µé¢æ˜¯å¦å®Œæ•´</span><br></code></pre></td></tr></table></figure><p>æˆ‘åªå®‰è£…äº† <code>puppeteer-core</code> æ ¸å¿ƒï¼Œä½¿ç”¨ <code>puppeteer-core</code>éœ€è¦æ‰‹åŠ¨æŒ‡å®šå·²å®‰è£…çš„ <code>Chrome </code>æµè§ˆå™¨çš„å®‰è£…è·¯å¾„ã€‚<br><code>Mac</code>ç”µè„‘ä¸Š<code>Chrome</code>æµè§ˆå™¨çš„çš„å®‰è£…è·¯å¾„ï¼Œå¯ä»¥é€šè¿‡åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ <code>chrome:\\version</code> æ¥æŸ¥çœ‹ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> browser = <span class="hljs-keyword">await</span> puppeteer.launch(&#123;<br>  executablePath:<br>    <span class="hljs-string">&quot;/Applications/Google Chrome.app/Contents/MacOS/Google Chrome&quot;</span>,<br>  headless: <span class="hljs-literal">true</span>,<br>  <span class="hljs-comment">// args: [ &#x27;--proxy-server=http://188.166.215.141:3128&#x27; ] // ç”¨ä½ çš„æœ‰æ•ˆä»£ç†æœåŠ¡å™¨æ›¿æ¢</span><br>&#125;);<br></code></pre></td></tr></table></figure><p>è¿™æ˜¯ puppeteer è¿”å›çš„å®Œæ•´ html ç»“æ„ï¼ŒåŒ…å«äº† ajax è¯·æ±‚åŠ¨æ€ç”Ÿæˆçš„ DOM ç»“æ„:<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/4YZvCU.jpg" alt="4YZvCU"></p><p>æˆ‘ç°åœ¨é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šåœ¨ puppeteer ä¸­ä½¿ç”¨ cheerio è§£æ html æ–‡æ¡£ å’Œ åœ¨æµè§ˆå™¨ä½¿ç”¨ jquery çš„è¡¨ç°ä¸åŒã€‚</p><p>ç–‘é—®ï¼š è¿™ä¸¤ç§ dom é€‰æ‹©æœ‰åŒºåˆ«å—ï¼Ÿ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">$(<span class="hljs-string">&quot;#ContactUs &gt; .leftcontext:eq(0)  &gt; .leftcontexttitle:eq(3)&quot;</span>).text(); <span class="hljs-comment">// cheerio è§£æä¸åˆ°,æµè§ˆå™¨ä¸­ jquery å¯ä»¥æ­£å¸¸æ‰§è¡Œ</span><br>$(<span class="hljs-string">&quot;#ContactUs &gt; .leftcontext:eq(0)&quot;</span>).children(<span class="hljs-string">&quot;.leftcontexttitle:eq(3)&quot;</span>).text(); <span class="hljs-comment">//  cheerio è§£ææˆåŠŸ</span><br></code></pre></td></tr></table></figure><h3 id="ç½‘ç«™åçˆ¬"><a href="#ç½‘ç«™åçˆ¬" class="headerlink" title="ç½‘ç«™åçˆ¬"></a>ç½‘ç«™åçˆ¬</h3><p>é‡åˆ° <code>pyppeteer.errors.TimeoutError: Navigation Timeout Exceeded: 30000 ms exceeded</code><br>çˆ¬å–è¯¦æƒ…é¡µæ—¶ï¼Œè®¿é—®æ¬¡æ•°å¤šäº† puppeteer å°±ä¼šæŠ¥é”™å“åº”è¶…æ—¶ æˆ‘çš„æ€è·¯æ˜¯è®© puppeteer æ‰“å¼€é¡µé¢å‰ç­‰å¾… 3-10 ç§’,åŒæ—¶è®© puppeteer ç­‰å¾…ç½‘ç«™å“åº”çš„æ—¶é—´æ— é™é•¿</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> sleep = <span class="hljs-function">(<span class="hljs-params">time</span>) =&gt;</span><br>  <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>      resolve(<span class="hljs-literal">true</span>);<br>    &#125;, time);<br>  &#125;);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRandom</span>(<span class="hljs-params">n, m</span>) </span>&#123;<br>  <span class="hljs-keyword">var</span> num = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * (m - n + <span class="hljs-number">1</span>) + n);<br>  <span class="hljs-keyword">return</span> num;<br>&#125;<br><span class="hljs-comment">//</span><br><span class="hljs-keyword">await</span> sleep(getRandom(<span class="hljs-number">3000</span>, <span class="hljs-number">10000</span>));<br><span class="hljs-keyword">await</span> page.goto(url, &#123;<br>  waitUntil: <span class="hljs-string">&quot;load&quot;</span>, <span class="hljs-comment">// è¿™é‡Œè®¾ç½®æˆ load å’Œ networkidle0 çš„è¡¨ç°ä¸€è‡´ï¼Œè¦ç ”ç©¶ä¸€ä¸‹ä¸¤ç§çš„åŒºåˆ«</span><br>  timeout: <span class="hljs-number">0</span>, <span class="hljs-comment">// å¯ä»¥ç­‰å¾…é¡µé¢åŠ è½½çš„æ—¶é—´ï¼Œè¶…å‡ºå°±ä¼šæŠ¥é”™è¯·æ±‚è¶…æ—¶ å¡« 0 æ— é™ç­‰å¾…</span><br>&#125;);<br></code></pre></td></tr></table></figure><h3 id="éœ€è¦å†å»ç ”ç©¶çš„"><a href="#éœ€è¦å†å»ç ”ç©¶çš„" class="headerlink" title="éœ€è¦å†å»ç ”ç©¶çš„"></a>éœ€è¦å†å»ç ”ç©¶çš„</h3><ul><li>load networkidle0 domcontentloaded ä¸‰è€…çš„åŒºåˆ«ï¼Ÿ</li><li>åœ¨ puppeteer ä¸­ä½¿ç”¨ cheerio è§£æ html æ–‡æ¡£ å’Œ åœ¨æµè§ˆå™¨ä½¿ç”¨ jquery çš„è¡¨ç°ä¸åŒ</li><li>node ä¸­å¼‚æ­¥æµç¨‹æ§åˆ¶ä¸é”™è¯¯å¤„ç†</li></ul><h2 id="å¼€å§‹çˆ¬å–éœ€è¦çš„æ•°æ®"><a href="#å¼€å§‹çˆ¬å–éœ€è¦çš„æ•°æ®" class="headerlink" title="å¼€å§‹çˆ¬å–éœ€è¦çš„æ•°æ®"></a>å¼€å§‹çˆ¬å–éœ€è¦çš„æ•°æ®</h2><p>çˆ¬å–ä¸­<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/iRuOZ9.jpg" alt="iRuOZ9"><br>å¯¼å‡ºä¸º excel<br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/p0wkT2.jpg" alt="p0wkT2"></p><p>å…¶å®å°±æ˜¯ä¸€ä¸ªåŠŸèƒ½åŠå…¶ç®€å•çš„ç©å…·çˆ¬è™«</p><h2 id="å®Œæ•´çš„ä»£ç -å»æ‰æ³¨é‡Šä¸åˆ°-100-è¡Œ"><a href="#å®Œæ•´çš„ä»£ç -å»æ‰æ³¨é‡Šä¸åˆ°-100-è¡Œ" class="headerlink" title="å®Œæ•´çš„ä»£ç  å»æ‰æ³¨é‡Šä¸åˆ° 100 è¡Œ"></a>å®Œæ•´çš„ä»£ç  å»æ‰æ³¨é‡Šä¸åˆ° 100 è¡Œ</h2><ol><li>å¾ªç¯åˆ—è¡¨é¡µé¢å¾—åˆ°è·³è½¬åˆ°è¯¦æƒ…é¡µçš„åœ°å€ æ•´ç†æˆä¸€ä¸ªæ•°ç»„</li><li>å¾ªç¯å¾—åˆ°çš„æ•°ç»„ï¼Œä¾æ¬¡è®¿é—®å¯¹åº”çš„é¡µé¢ï¼Œå°†éœ€è¦çš„è¯¦æƒ…é¡µä¸Šçš„æ•°æ®æ•´ç†æˆæ•°ç»„</li><li>å¯¼å‡ºæ•°ç»„ä¸º excel</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// è¯·æ±‚æ¨¡å—ï¼ˆ1.è®¿é—®ç½‘ç«™ï¼‰</span><br><span class="hljs-keyword">const</span> request = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;request&quot;</span>);<br><span class="hljs-comment">// å¯ä»¥çœ‹åšæˆnodeç‰ˆçš„jQueryï¼ˆ2.è·å–é¡µé¢æŒ‡å®šæ•°æ®æºï¼‰</span><br><span class="hljs-keyword">const</span> cheerio = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;cheerio&quot;</span>);<br><span class="hljs-comment">// nodeå¼‚æ­¥æµç¨‹æ§åˆ¶ å¼‚æ­¥å¾ªç¯ï¼ˆ3.æ ¹æ®é¡µé¢æ•°æ®æºå†è®¿é—®è¯¦æƒ…æ•°æ®ï¼‰</span><br><span class="hljs-keyword">const</span> <span class="hljs-keyword">async</span> = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;async&quot;</span>);<br><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;fs&quot;</span>);<br><span class="hljs-comment">// æ— å¤´æµè§ˆå™¨</span><br><span class="hljs-keyword">const</span> puppeteer = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;puppeteer-core&quot;</span>);<br><span class="hljs-comment">// json å¯¼å‡º excel</span><br><span class="hljs-keyword">const</span> json2xls = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;json2xls&quot;</span>);<br><span class="hljs-keyword">const</span> sleep = <span class="hljs-function">(<span class="hljs-params">time</span>) =&gt;</span><br>  <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve, reject</span>) =&gt;</span> &#123;<br>    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>      resolve(<span class="hljs-literal">true</span>);<br>    &#125;, time);<br>  &#125;);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getRandom</span>(<span class="hljs-params">n, m</span>) </span>&#123;<br>  <span class="hljs-keyword">var</span> num = <span class="hljs-built_in">Math</span>.floor(<span class="hljs-built_in">Math</span>.random() * (m - n + <span class="hljs-number">1</span>) + n);<br>  <span class="hljs-keyword">return</span> num;<br>&#125;<br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">requestInfo</span>(<span class="hljs-params">url</span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;å¼€å§‹è¯·æ±‚è¯¦æƒ…é¡µ&quot;</span>, url);<br>  <span class="hljs-comment">//æ¨¡æ‹Ÿäººä¸ºæ“ä½œ æ‰“å¼€é¡µé¢åç­‰å¾…3-10ç§’</span><br>  <span class="hljs-keyword">await</span> sleep(getRandom(<span class="hljs-number">3000</span>, <span class="hljs-number">10000</span>));<br>  <span class="hljs-keyword">const</span> browser = <span class="hljs-keyword">await</span> puppeteer.launch(&#123;<br>    executablePath:<br>      <span class="hljs-string">&quot;/Applications/Google Chrome.app/Contents/MacOS/Google Chrome&quot;</span>,<br>    headless: <span class="hljs-literal">true</span>,<br>    <span class="hljs-comment">// args: [ &#x27;--proxy-server=http://188.166.215.141:3128&#x27; ] // ç”¨ä½ çš„æœ‰æ•ˆä»£ç†æœåŠ¡å™¨æ›¿æ¢</span><br>  &#125;);<br>  <span class="hljs-keyword">const</span> page = <span class="hljs-keyword">await</span> browser.newPage();<br>  <span class="hljs-keyword">await</span> page.goto(url, &#123;<br>    waitUntil: <span class="hljs-string">&quot;load&quot;</span>,<br>    timeout: <span class="hljs-number">0</span>, <span class="hljs-comment">// å¯ä»¥ç­‰å¾…é¡µé¢åŠ è½½çš„æ—¶é—´ï¼Œè¶…å‡ºå°±ä¼šæŠ¥é”™è¯·æ±‚è¶…æ—¶ å¡« 0 æ— é™ç­‰å¾…</span><br>  &#125;);<br>  <span class="hljs-keyword">const</span> html = <span class="hljs-keyword">await</span> page.content();<br>  <span class="hljs-comment">// fs.writeFileSync(&#x27;./test.html&#x27;, html)</span><br>  <span class="hljs-keyword">const</span> $ = cheerio.load(html);<br>  <span class="hljs-keyword">let</span> info = &#123;&#125;;<br>  info.æœºæ„åç§° = $(<br>    <span class="hljs-string">&quot;#BasicInformation &gt; .leftcontext_left &gt; .leftcontexttitle &gt; label&quot;</span><br>  )<br>    .text()<br>    .trim();<br>  <span class="hljs-comment">// .... è¿™é‡Œå¤„ç†éœ€è¦çš„æ•°æ®</span><br>  info.æ•°æ®æ¥æº = url;<br>  browser.close();<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;info==&quot;</span>, info);<br>  <span class="hljs-keyword">return</span> info;<br>&#125;<br><br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">requestPage</span>(<span class="hljs-params">page = <span class="hljs-number">1</span>, callback</span>) </span>&#123;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;å¼€å§‹è¯·æ±‚åˆ—è¡¨é¡µé¢&quot;</span>, page);<br>  request(<br>    &#123;<br>      url: <span class="hljs-string">&quot;ä½ çš„ç›®æ ‡é¡µé¢&quot;</span> + page,<br>      method: <span class="hljs-string">&quot;get&quot;</span>,<br>      headers: &#123;<br>        <span class="hljs-string">&quot;User-Agent&quot;</span>:<br>          <span class="hljs-string">&quot;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/74.0.3729.169 Safari/537.36&quot;</span>,<br>        Accept:<br>          <span class="hljs-string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3&quot;</span>,<br>        <span class="hljs-comment">// &#x27;Accept-Encoding&#x27;: &#x27;gzip, deflate&#x27;,</span><br>        <span class="hljs-string">&quot;Accept-Language&quot;</span>: <span class="hljs-string">&quot;zh-CN,zh;q=0.9&quot;</span>,<br>        <span class="hljs-string">&quot;Cache-Control&quot;</span>: <span class="hljs-string">&quot;no-cache&quot;</span>,<br>      &#125;,<br>      encoding: <span class="hljs-literal">null</span>,<br>    &#125;,<br>    <span class="hljs-keyword">async</span> (err, res, body) =&gt; &#123;<br>      <span class="hljs-keyword">const</span> list = [];<br>      <span class="hljs-keyword">const</span> $ = cheerio.load(body.toString());<br>      <span class="hljs-comment">// è·å–æŒ‡å®šå…ƒç´ </span><br>      <span class="hljs-keyword">let</span> item = $(<span class="hljs-string">&quot;#yly_list_div  div[class=&#x27;jiadiantujianjie_but&#x27;]&quot;</span>);<br>      <span class="hljs-comment">// å¾ªç¯å¾—åˆ°å…ƒç´ çš„è·³è½¬åœ°å€å’Œåç§°</span><br>      item.map(<span class="hljs-function">(<span class="hljs-params">i, index</span>) =&gt;</span> &#123;<br>        <span class="hljs-keyword">let</span> obj = &#123;&#125;;<br>        obj.link = $(index).children(<span class="hljs-string">&quot;a&quot;</span>).attr(<span class="hljs-string">&quot;href&quot;</span>);<br>        list.push(obj);<br>      &#125;);<br>      callback(<span class="hljs-literal">null</span>, list);<br>    &#125;<br>  );<br>&#125;<br><span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">main</span>(<span class="hljs-params"></span>) </span>&#123;<br>  <span class="hljs-keyword">const</span> requestList = [];<br>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">1</span>; i &lt;= <span class="hljs-number">20</span>; i++) &#123;<br>    requestList.push(<span class="hljs-function">(<span class="hljs-params">callback</span>) =&gt;</span> &#123;<br>      requestPage(i, callback);<br>    &#125;);<br>  &#125;<br>  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;requestList&quot;</span>, requestList); <span class="hljs-comment">// [Function, Function] å…¨æ˜¯functionçš„æ•°ç»„</span><br>  <span class="hljs-keyword">async</span>.series(requestList, <span class="hljs-function">(<span class="hljs-params">err, result</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// async.series æˆ‘ä¸ä¼šç”¨</span><br>    <span class="hljs-keyword">const</span> arry = [].concat.apply([], result);<br>    <span class="hljs-keyword">const</span> infoList = [];<br>    (<span class="hljs-keyword">async</span> () =&gt; &#123;<br>      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> index = <span class="hljs-number">0</span>; index &lt; arry.length; index++) &#123;<br>        <span class="hljs-keyword">const</span> reust = <span class="hljs-keyword">await</span> requestInfo(arry[index].link);<br>        infoList.push(reust);<br>      &#125;<br>      <span class="hljs-keyword">const</span> xls = json2xls(infoList);<br>      <span class="hljs-comment">// å°†è¿”å›ç»“æœè½¬æˆexcel</span><br>      fs.writeFileSync(<span class="hljs-string">&quot;æˆéƒ½.xlsx&quot;</span>, xls, <span class="hljs-string">&quot;binary&quot;</span>);<br>      process.exit();<br>    &#125;)();<br>  &#125;);<br>&#125;<br><br>main();<br></code></pre></td></tr></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><section class="footnotes"><div class="footnote-list"><ol><li><span id="fn:1" class="footnote-text"><span><a href="https://zhuanlan.zhihu.com/p/94451941">è®°ä¸€æ¬¡ node çˆ¬è™«ç»å†ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ çˆ¬è™«</a><a href="#fnref:1" rev="footnote" class="footnote-backref"> â†©</a></span></span></li><li><span id="fn:2" class="footnote-text"><span><a href="https://www.itfanr.cc/2019/04/10/configuration-development-of-puppeteer/">Puppeteer é…ç½®å°è®°</a><a href="#fnref:2" rev="footnote" class="footnote-backref"> â†©</a></span></span></li></ol></div></section>]]></content>
    
    
    <categories>
      
      <category>ä»£ç äººç”Ÿ</category>
      
    </categories>
    
    
    <tags>
      
      <tag>nodejs</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æˆ‘é‡æ–°å†™åšå®¢äº†</title>
    <link href="/posts/9573d8fb/"/>
    <url>/posts/9573d8fb/</url>
    
    <content type="html"><![CDATA[<h2 id="é‡æ–°å¼€å§‹æåšå®¢"><a href="#é‡æ–°å¼€å§‹æåšå®¢" class="headerlink" title="é‡æ–°å¼€å§‹æåšå®¢"></a>é‡æ–°å¼€å§‹æåšå®¢</h2><blockquote><p>ä¸ºä»€ä¹ˆé€‰ <code>hexo</code> ?</p></blockquote><p>ä¸€å¼€å§‹åªæƒ³æœ‰ä¸ªå±äºè‡ªå·±çš„åœ°æ–¹å†™æ–‡å­—è®°å½•,é™æ€åšå®¢ã€ä½¿ç”¨<code>markdown</code>ç¼–å†™å°±æ˜¯æˆ‘çš„é¦–é€‰äº†ï¼Œå°¤å…¶æ˜¯ <code>markdown</code> è‡ªç”±çš„æ’å…¥å›¾ç‰‡ã€è§†é¢‘ï¼Œç»“åˆå…è´¹çš„å›¾åºŠå’Œäº‘å­˜å‚¨æœåŠ¡ï¼Œå°±å¯ä»¥æŠŠè¿™äº›åª’ä½“æ–‡ä»¶ä»æ–‡å­—ä¸­åˆ†ç¦»å‡ºæ¥ï¼Œä»¥åæœ‰äº†è‡ªå·±çš„åŠ¨æ€ç½‘ç«™è¿ç§»æ–‡ç« ä¹Ÿæ–¹ä¾¿ã€‚å…¶æ¬¡æ˜¯è‡ªå·±ä»¥å‰æ­å»ºè¿‡ hexo + github pages çš„åšå®¢, è¿˜æœ‰ä¸€ç‚¹å¾ˆé‡è¦ï¼š<code>è¿™äº›ä¸œè¥¿å®Œå…¨å…è´¹</code>ï¼Œå¦‚æœä½ ä¸ä½¿ç”¨è‡ªå®šä¹‰åŸŸåçš„è¯ï¼Œè¿åŸŸåçš„é’±çš„çœäº†ã€‚</p><p>æ‰€ä»¥ï¼Œè¿™ä¸ªåŸºäº hexo çš„é™æ€åšå®¢æ‰˜ç®¡åœ¨ <code>Github Pages</code>æœåŠ¡ä¸Š <a href="https://github.com/frmachao/frmachao.github.io">ä»“åº“åœ°å€</a> </p><p>å½“ç„¶å…è´¹ä¹Ÿæ˜¯æœ‰ä»£ä»·çš„:</p><ul><li>github åœ¨å›½å†…æ²¡æœ‰æœåŠ¡å™¨,è®¿é—®é€Ÿåº¦è¾ƒæ…¢</li><li>åœ¨æ•æ„Ÿæ—¶é—´æ¯”å¦‚<code>ä¸¤ä¼š</code>æœŸé—´ï¼ŒGitHub åœ¨å›½å†…ä¼šå®Œå…¨æ— æ³•è®¿é—®</li></ul><p>æœ¬ç«™ç‚¹å”¯ä¸€çš„å¼€é”€å°±æ˜¯ <a href="http://frmachao.top/">frmachao.top</a> è¿™ä¸ªåŸŸåäº†ï¼Œä¸€å£æ°”ä¹°äº† 10 å¹´ã€‚</p><blockquote><p>è¯„è®ºæ€ä¹ˆè¿ç§»å‘¢?</p></blockquote><p>è¿™ä¸ªè¿˜æ²¡æƒ³å¥½ï¼Œå› ä¸ºç°åœ¨çš„è¯„è®ºåŠŸèƒ½æ˜¯ä½¿ç”¨ <code>Gitalk</code> å®ç°çš„ï¼Œåé¢å¯¼å‡ºè¯„è®ºæ•°æ®å¯èƒ½éœ€è¦è‡ªå·±å†™ä¸ªè„šæœ¬æ‰èƒ½æ‰¹é‡å¯¼å‡ºã€‚</p><p>å…¶å®ä¸æ­¢è¯„è®ºï¼Œå› ä¸ºé™æ€åšå®¢çš„åŸå› ï¼Œå¾ˆå¤šä¸œè¥¿éƒ½è¦å€ŸåŠ©ç¬¬ä¸‰æ–¹çš„æ’ä»¶æ¥å®ç°,æ¯”å¦‚</p><ul><li>æ–‡ç« é˜…è¯»é‡</li><li>ç½‘é¡µè®¿é—®é‡</li><li>é‚®ä»¶è®¢é˜…</li><li>åœ¨çº¿èŠå¤©</li></ul><h2 id="è‡ªå®šä¹‰åŸŸåä¸-SSL-è¯ä¹¦"><a href="#è‡ªå®šä¹‰åŸŸåä¸-SSL-è¯ä¹¦" class="headerlink" title="è‡ªå®šä¹‰åŸŸåä¸ SSL è¯ä¹¦"></a>è‡ªå®šä¹‰åŸŸåä¸ SSL è¯ä¹¦</h2><p>å½“å‰åŸºäº hexo çš„é™æ€åšå®¢ <a href="http://blog.frmachao.top/">frmachaoâ€™blog</a> æ‰˜ç®¡åœ¨ <code>Github Pages</code> æœåŠ¡ä¸Šã€‚</p><p>åŸŸååœ¨è´­ä¹°äºé˜¿é‡Œäº‘å¹¶å¤‡æ¡ˆï¼Œä¸»è¦ä¸ºäº†ä½¿ç”¨é˜¿é‡Œäº‘å…è´¹çš„<code>SSL</code>è¯ä¹¦æ‰å¤‡æ¡ˆçš„åŸŸåï¼Œç»“æœæ™šä¸Šçœ‹äº†ä¸€ç¯‡åšå®¢ æ‰çŸ¥é“ï¼š Github Pages æ”¯æŒç»‘å®šè‡ªå®šä¹‰çš„åŸŸåï¼Œå¯ç”¨åŸŸåç»‘å®šåæ— éœ€ç”¨æˆ·è‡ªè¡Œé…ç½®ã€‚ï¼ˆåšå®¢é“¾æ¥å¿˜è®°äº†ï¼Œåé¢æ‰¾åˆ°åè¡¥ä¸Šï¼‰</p><h2 id="è¯„è®ºæ’ä»¶"><a href="#è¯„è®ºæ’ä»¶" class="headerlink" title="è¯„è®ºæ’ä»¶"></a>è¯„è®ºæ’ä»¶</h2><h3 id="ä½¿ç”¨gitalkè¯„è®ºæ’ä»¶"><a href="#ä½¿ç”¨gitalkè¯„è®ºæ’ä»¶" class="headerlink" title="ä½¿ç”¨gitalkè¯„è®ºæ’ä»¶"></a>ä½¿ç”¨<code>gitalk</code>è¯„è®ºæ’ä»¶</h3><p>é‡åˆ°é—®é¢˜ï¼šgitalk å®˜æ–¹ä»£ç é‡‡ç”¨äº†ç¬¬ä¸‰æ–¹æä¾›çš„ cors proxy æœåŠ¡ï¼Œæ­¤æœåŠ¡å·²äº 2021 å¹´ 1 æœˆ 31 æ—¥ç»ˆæ­¢</p><p>è§£å†³ï¼šgitalking åˆ‡æ¢åˆ°è‡ªå»ºçš„ CORS proxy å‚è€ƒï¼š</p><ol><li><a href="https://github.com/Zibri/cloudflare-cors-anywhere">https://github.com/Zibri/cloudflare-cors-anywhere</a> ä¸€ä¸ªä»£ç†åº“</li><li><a href="https://github.com/gitalk/gitalk/issues/429">https://github.com/gitalk/gitalk/issues/429</a> å¤§å®¶å¯¹è¿™ä¸ªé—®é¢˜çš„è®¨è®º</li></ol><blockquote><p>2021.03.03 Gitalk ä½œè€…å‘å¸ƒäº†æ›´æ–°</p></blockquote><p><code>Gitalk</code> æ›´æ–°ç‰ˆæœ¬åˆ° 1.7.2 æˆ–è€…ä¿®æ”¹é…ç½®å¢åŠ  proxy: â€˜<a href="https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token&#39;">https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token&#39;</a></p><p>åé¢è‡ªå·±æ­å»ºäº† cors æœåŠ¡ï¼Œå‚è€ƒ: <a href="https://lanyundev.com/posts/1f7efefb">https://lanyundev.com/posts/1f7efefb</a></p><h3 id="Gitalk-åŸç†"><a href="#Gitalk-åŸç†" class="headerlink" title="Gitalk åŸç†"></a>Gitalk åŸç†</h3><p>åœ¨é™æ€åšå®¢ä¸­ä½¿ç”¨è¯„è®ºåŠŸèƒ½ï¼Œæ–‡ç« çš„å”¯ä¸€æ ‡ç¤ºå°±æ˜¯é¡µé¢çš„<code>location.href</code> å³ url ,gitalk å°† è¿™ä¸ªå”¯ä¸€æ ‡è¯† ä½œä¸º issue çš„ label ä¸æ–‡ç« å…³è”ï¼Œæ¯ç¯‡æ–‡ç« å¯¹åº”ä¸€ä¸ª Issue</p><p><code>fluidä¸»é¢˜</code> é‡Œé›†æˆ Gitalk æ’ä»¶æ—¶å¤šå¤„ç†äº†ä¸€æ­¥ åœ¨ <code>gitalk.ejs</code> é‡Œåšäº† md5 åŠ å¯†ï¼ŒåŠ å¯†åçš„å€¼å°±æ˜¯ issue çš„ label</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> gitalk = <span class="hljs-keyword">new</span> Gitalk(&#123;<br>  clientID: <span class="hljs-string">&#x27;&lt;%= theme.gitalk.clientID %&gt;&#x27;</span>,<br>  clientSecret: <span class="hljs-string">&#x27;&lt;%= theme.gitalk.clientSecret %&gt;&#x27;</span>,<br>  repo: <span class="hljs-string">&#x27;&lt;%= theme.gitalk.repo %&gt;&#x27;</span>,<br>  owner: <span class="hljs-string">&#x27;&lt;%= theme.gitalk.owner %&gt;&#x27;</span>,<br>  admin: &lt;%- <span class="hljs-built_in">JSON</span>.stringify(theme.gitalk.admin || []) %&gt;,<br>  id: <span class="hljs-string">&#x27;&lt;%= md5(page.path) %&gt;&#x27;</span>, <span class="hljs-comment">// è¿™é‡Œåšäº†md5 åŠ å¯†</span><br>  language: <span class="hljs-string">&#x27;&lt;%= theme.gitalk.language %&gt;&#x27;</span>,<br>  labels: &lt;%- <span class="hljs-built_in">JSON</span>.stringify(theme.gitalk.labels || []) %&gt;,<br>  perPage: &lt;%= theme.gitalk.perPage %&gt;,<br>  pagerDirection: <span class="hljs-string">&#x27;&lt;%= theme.gitalk.pagerDirection %&gt;&#x27;</span>,<br>  createIssueManually: &lt;%= theme.gitalk.createIssueManually %&gt;,<br>  distractionFreeMode: &lt;%= theme.gitalk.distractionFreeMode %&gt;,<br>  proxy: <span class="hljs-string">&#x27;&lt;%= theme.gitalk.proxy %&gt;&#x27;</span><br>&#125;);<br></code></pre></td></tr></table></figure><p><code>page.path</code> :page æ˜¯ hexo ä¸­æä¾›çš„å˜é‡ï¼Œpage.path æ˜¯é¡µé¢ç½‘å€ï¼ˆä¸å«æ ¹è·¯å¾„ï¼‰<br>æ¯”å¦‚ <code>https://blog.frmachao.top/posts/9573d8fb/</code>è¿™ä¸ªé¡µé¢å– page.path çš„å€¼å°±æ˜¯ <code>posts/9573d8fb/</code></p><p>åŠ å¯†åçš„ 32 ä½ MD5ï¼š<code>f43773bc09059051be6825b5c9006f58</code><br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2023-04-09-FPGr4k.png" alt="2023-04-09-FPGr4k"></p><p><code>https://blog.frmachao.top/links/</code><br>éæ–‡ç« é¡µé¢å– page.path çš„å€¼å°±æ˜¯ â€”&gt; <code>links/index.html </code></p><p>åŠ å¯†åçš„ 32 ä½ MD5ï¼š<code>38687fdbcd50268b872dd8c493f739e6</code><br><img src="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/wYtVZti7RfqJ.png" alt="wYtVZti7RfqJ"></p><p><code>æ³¨æ„âš ï¸</code>: page.path å–åˆ°çš„ url è·¯å¾„æ˜¯ url è§£ç è¿‡çš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">2021/03/%E4%B8%80%E4%B8%AA%E5%8D%9A%E5%AE%A2/ <span class="hljs-comment"># urlç¼–ç </span><br>2021/03/ä¸€ä¸ªåšå®¢/  <span class="hljs-comment"># urlè§£ç </span><br></code></pre></td></tr></table></figure><h2 id="å›¾åºŠ"><a href="#å›¾åºŠ" class="headerlink" title="å›¾åºŠ"></a>å›¾åºŠ</h2><blockquote><p>ç›®å‰ä½¿ç”¨ github ä»“åº“ ä½œä¸ºå›¾åºŠ</p></blockquote><p>ä½¿ç”¨ <code>github</code>ä»“åº“åšå›¾åºŠï¼Œåˆ©ç”¨ public repo æä¾›çš„å…è´¹ jsdelivr CDN </p><ul><li>ä»“åº“åœ°å€ï¼š <a href="https://github.com/frmachao/images">https://github.com/frmachao/images</a></li><li>å›¾ç‰‡é“¾æ¥ï¼š <a href="https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2023-04-05-5xznzZ.png">https://cdn.jsdelivr.net/gh/frmachao/images@blog/uPic/2023-04-05-5xznzZ.png</a></li><li><a href="http://ping.chinaz.com/raw.githubusercontent.com">ping æ£€æµ‹ raw.githubusercontent.com åœ¨å›½å†…çš„çŠ¶æ€</a></li></ul><h2 id="ç½‘ç«™ç»Ÿè®¡æ’ä»¶"><a href="#ç½‘ç«™ç»Ÿè®¡æ’ä»¶" class="headerlink" title="ç½‘ç«™ç»Ÿè®¡æ’ä»¶"></a>ç½‘ç«™ç»Ÿè®¡æ’ä»¶</h2><ul><li>ä½¿ç”¨ <code>leancloud</code> çš„æœåŠ¡ ç»Ÿè®¡ç½‘é¡µè®¿é—®æ•° ä¸ æ–‡ç« é˜…è¯»æ•°</li><li>ç™¾åº¦ç»Ÿè®¡</li></ul><h2 id="åšå®¢ä¸»é¢˜"><a href="#åšå®¢ä¸»é¢˜" class="headerlink" title="åšå®¢ä¸»é¢˜"></a>åšå®¢ä¸»é¢˜</h2><p>ä¸»é¢˜ä½¿ç”¨äº† <a href="https://github.com/fluid-dev/hexo-theme-fluid">fluid</a></p><p>è‡ªå·±åšçš„ä¿®æ”¹ï¼š</p><ul><li>Post.ejs ä¸­æ·»åŠ  AddToAny æ’ä»¶æ¥æ”¯æŒæ–‡ç« åˆ†äº«</li><li>Post.ejs ä¸­ä¿®æ”¹ Custom çš„ä½ç½®åˆ°æ–‡ç« åº•éƒ¨</li></ul><h2 id="æµ‹è¯•æ’å…¥è§†é¢‘"><a href="#æµ‹è¯•æ’å…¥è§†é¢‘" class="headerlink" title="æµ‹è¯•æ’å…¥è§†é¢‘"></a>æµ‹è¯•æ’å…¥è§†é¢‘</h2><blockquote><p><code>javascript</code> çš„è¯ç”Ÿä¸æ­»äº¡</p></blockquote><iframewidth="100%"height="480px"src="//player.bilibili.com/player.html?aid=1623152&bvid=BV1Gx411P7GJ&cid=2467718&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe><blockquote><p>Do not just seek happiness for yourself. Seek happiness for all. Through kindness. Through mercy.</p><footer><strong>David Levithan</strong><cite>Wide Awake</cite></footer></blockquote><h2 id="hexo-æ’ä»¶"><a href="#hexo-æ’ä»¶" class="headerlink" title="hexo æ’ä»¶"></a>hexo æ’ä»¶</h2><ul><li>hexo-abbrlink ç”Ÿæˆå”¯ä¸€æ°¸ä¹…çš„æ–‡ç« é“¾æ¥<ul><li>hexo æ–‡ç« é“¾æ¥é»˜è®¤çš„ç”Ÿæˆè§„åˆ™æ˜¯ï¼š:year/:month/:day/:titleï¼Œæ˜¯æŒ‰ç…§å¹´ã€æœˆã€æ—¥ã€æ ‡é¢˜æ¥ç”Ÿæˆçš„ã€‚</li><li>è¿™ä¸ªæ’ä»¶å¯ä»¥ç”Ÿæˆä¸å˜çš„æ–‡ç« é“¾æ¥ï¼Œä¸ä¼šéšç€æ–‡ç« æ ‡é¢˜å˜åŠ¨ï¼ŒåŸç†æ˜¯åœ¨æ–‡ç« çš„ md æ–‡ä»¶ä¸­æ–°å¢ä¸€ä¸ª abbrlink å­—æ®µ<h2 id="hexo-å¸¸ç”¨å‘½ä»¤"><a href="#hexo-å¸¸ç”¨å‘½ä»¤" class="headerlink" title="hexo å¸¸ç”¨å‘½ä»¤"></a>hexo å¸¸ç”¨å‘½ä»¤</h2></li></ul></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash">hexo n <span class="hljs-string">&quot;æˆ‘çš„åšå®¢&quot;</span> == hexo new <span class="hljs-string">&quot;æˆ‘çš„åšå®¢&quot;</span> <span class="hljs-comment">#æ–°å»ºæ–‡ç« </span><br>hexo new draft &lt;title&gt; <span class="hljs-comment"># æ–°å»ºè‰ç¨¿</span><br>hexo p == hexo publish<br>hexo g == hexo generate<span class="hljs-comment">#ç”Ÿæˆ</span><br>hexo s == hexo server <span class="hljs-comment">#å¯åŠ¨æœåŠ¡é¢„è§ˆ</span><br>hexo d == hexo deploy<span class="hljs-comment">#éƒ¨ç½²</span><br>hexo server <span class="hljs-comment">#Hexo ä¼šç›‘è§†æ–‡ä»¶å˜åŠ¨å¹¶è‡ªåŠ¨æ›´æ–°ï¼Œæ‚¨æ— é¡»é‡å¯æœåŠ¡å™¨ã€‚</span><br>hexo server -s <span class="hljs-comment">#é™æ€æ¨¡å¼</span><br>hexo s --draft <span class="hljs-comment"># ç¼–è¯‘è‰ç¨¿</span><br>hexo server -p 5000 <span class="hljs-comment">#æ›´æ”¹ç«¯å£</span><br>hexo server -i 192.168.1.1 <span class="hljs-comment">#è‡ªå®šä¹‰ IP</span><br>hexo clean <span class="hljs-comment">#æ¸…é™¤ç¼“å­˜ ç½‘é¡µæ­£å¸¸æƒ…å†µä¸‹å¯ä»¥å¿½ç•¥æ­¤æ¡å‘½ä»¤</span><br>hexo g <span class="hljs-comment">#ç”Ÿæˆé™æ€ç½‘é¡µ</span><br>hexo d <span class="hljs-comment">#å¼€å§‹éƒ¨ç½²</span><br><br></code></pre></td></tr></table></figure><h2 id="åšå®¢çš„æ‰˜ç®¡"><a href="#åšå®¢çš„æ‰˜ç®¡" class="headerlink" title="åšå®¢çš„æ‰˜ç®¡"></a>åšå®¢çš„æ‰˜ç®¡</h2><p>hexo åšå®¢æºç æœ¬èº«å­˜å‚¨åœ¨ github ä¸Šçš„ä¸€ä¸ªç§æœ‰ä»“åº“ <code>https://github.com/frmachao/hexo-blog</code>,åŸå§‹çš„markdown æ–‡ç« ä¸è‰ç¨¿ hexo åšå®¢ä¸»é¢˜é…ç½®ç­‰ç­‰éƒ½åœ¨è¿™é‡Œ</p><p>å½“ç¼–è¾‘å®Œæ–‡ç« åé€šè¿‡ <a href="https://github.com/hexojs/hexo-deployer-git">hexo-deployer-git</a> è¿™ä¸ªæ’ä»¶ å°†hexo ç¼–è¯‘å‡ºæ¥çš„ HTML é¡µé¢æ¨é€åˆ°å¼€å¯ <code>Github Pages</code>é™æ€é¡µé¢æœåŠ¡çš„å…¬å¼€ä»“åº“ä¸­ <code>https://github.com/frmachao/frmachao.github.io</code></p><p>åæ¥è§‰å¾—æ‰‹åŠ¨åœ¨æœ¬åœ°æ‰§è¡Œç¼–è¯‘ + æ¨é€åˆ°é™æ€é¡µé¢æœåŠ¡ä»“åº“éº»çƒ¦ï¼Œäºæ˜¯åˆ©ç”¨ GitHub Actions è‡ªåŠ¨éƒ¨ç½² Hexo åšå®¢<br>å‚è€ƒ ï¼š <a href="https://hexo.fluid-dev.com/posts/actions-deploy/">åˆ©ç”¨ GitHub Actions è‡ªåŠ¨éƒ¨ç½² Hexo åšå®¢</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">- .github<br>  - workflows<br>    - hexo_deploy.yml <br></code></pre></td></tr></table></figure><p>è¿™æ˜¯æˆ‘çš„ hexo è‡ªåŠ¨éƒ¨ç½²é…ç½®</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span>                      <span class="hljs-comment"># Actions æ˜¾ç¤ºçš„åå­—ï¼Œéšæ„è®¾ç½®</span><br><br><span class="hljs-attr">on:</span><br>  <span class="hljs-attr">push:</span><br>    <span class="hljs-attr">branches:</span><br>      <span class="hljs-bullet">-</span> <span class="hljs-string">master</span>                     <span class="hljs-comment"># ç›‘å¬åˆ° push äº‹ä»¶åè§¦å‘</span><br><br><span class="hljs-attr">jobs:</span><br>  <span class="hljs-attr">build:</span><br><br>    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-latest</span><br><br>    <span class="hljs-attr">steps:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Checkout</span>              <span class="hljs-comment"># æ‹‰å–å½“å‰æ‰§è¡Œ Actions ä»“åº“çš„æŒ‡å®šåˆ†æ”¯</span><br>      <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span><br>      <span class="hljs-attr">with:</span><br>        <span class="hljs-attr">ref:</span> <span class="hljs-string">master</span><br>    <span class="hljs-comment">#- name: Update Submodule      # å¦‚æœä»“åº“æœ‰ submoduleï¼Œåœ¨è¿™é‡Œæ›´æ–°ï¼Œæ²¡æœ‰åˆ™åˆ æ‰æ­¤æ­¥éª¤</span><br>    <span class="hljs-comment">#  run: |</span><br>    <span class="hljs-comment">#    git submodule init</span><br>        <span class="hljs-comment"># git submodule update --remote</span><br><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Setup</span> <span class="hljs-string">Node</span>            <span class="hljs-comment"># å®‰è£… Node ç¯å¢ƒ</span><br>      <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/setup-node@v1</span><br>      <span class="hljs-attr">with:</span><br>        <span class="hljs-attr">node-version:</span> <span class="hljs-string">&quot;10.x&quot;</span><br><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Hexo</span> <span class="hljs-string">Generate</span>         <span class="hljs-comment"># å®‰è£… Hexo ä¾èµ–å¹¶ä¸”ç”Ÿæˆé™æ€æ–‡ä»¶</span><br>      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span><br>        <span class="hljs-string">rm</span> <span class="hljs-string">-f</span> <span class="hljs-string">.yarnclean</span><br>        <span class="hljs-string">yarn</span> <span class="hljs-string">--frozen-lockfile</span> <span class="hljs-string">--ignore-engines</span> <span class="hljs-string">--ignore-optional</span> <span class="hljs-string">--non-interactive</span> <span class="hljs-string">--silent</span> <span class="hljs-string">--ignore-scripts</span> <span class="hljs-string">--production=false</span><br>        <span class="hljs-string">rm</span> <span class="hljs-string">-rf</span> <span class="hljs-string">./public</span><br>        <span class="hljs-string">yarn</span> <span class="hljs-string">run</span> <span class="hljs-string">hexo</span> <span class="hljs-string">clean</span><br>        <span class="hljs-string">yarn</span> <span class="hljs-string">run</span> <span class="hljs-string">hexo</span> <span class="hljs-string">generate</span><br><br>    <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Hexo</span> <span class="hljs-string">Deploy</span>           <span class="hljs-comment"># éƒ¨ç½²æ­¥éª¤ï¼Œè¿™é‡Œä»¥ hexo deploy ä¸ºä¾‹</span><br>      <span class="hljs-attr">env:</span><br>        <span class="hljs-attr">SSH_PRIVATE:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.SSH_PRIVATE</span> <span class="hljs-string">&#125;&#125;</span><br>        <span class="hljs-attr">GIT_NAME:</span> <span class="hljs-string">frmachao</span><br>        <span class="hljs-attr">GIT_EMAIL:</span> <span class="hljs-string">frmachao@126.com</span><br>      <span class="hljs-attr">run:</span> <span class="hljs-string">|</span><br>        <span class="hljs-string">mkdir</span> <span class="hljs-string">-p</span> <span class="hljs-string">~/.ssh/</span><br>        <span class="hljs-string">echo</span> <span class="hljs-string">&quot;$SSH_PRIVATE&quot;</span> <span class="hljs-string">|</span> <span class="hljs-string">tr</span> <span class="hljs-string">-d</span> <span class="hljs-string">&#x27;\r&#x27;</span> <span class="hljs-string">&gt;</span> <span class="hljs-string">~/.ssh/id_rsa</span><br>        <span class="hljs-string">chmod</span> <span class="hljs-number">600</span> <span class="hljs-string">~/.ssh/id_rsa</span><br>        <span class="hljs-string">ssh-keyscan</span> <span class="hljs-string">github.com</span> <span class="hljs-string">&gt;&gt;</span> <span class="hljs-string">~/.ssh/known_hosts</span><br>        <span class="hljs-string">git</span> <span class="hljs-string">config</span> <span class="hljs-string">--global</span> <span class="hljs-string">user.name</span> <span class="hljs-string">&quot;$GIT_NAME&quot;</span><br>        <span class="hljs-string">git</span> <span class="hljs-string">config</span> <span class="hljs-string">--global</span> <span class="hljs-string">user.email</span> <span class="hljs-string">&quot;$GIT_EMAIL&quot;</span><br>        <span class="hljs-string">yarn</span> <span class="hljs-string">run</span> <span class="hljs-string">hexo</span> <span class="hljs-string">deploy</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ç¬”è®°æœ¬</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
      <tag>æ•™ç¨‹</tag>
      
      <tag>è®°å½•</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
